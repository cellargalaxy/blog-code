__NUXT_JSONP__("/archive/2020", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_,$,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,as,at,au,av,aw,ax,ay,az,aA,aB,aC,aD,aE,aF,aG,aH,aI,aJ,aK,aL,aM,aN,aO,aP,aQ,aR,aS,aT,aU,aV,aW,aX,aY,aZ,a_,a$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b_,b$,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy,cz,cA,cB,cC,cD,cE,cF,cG,cH,cI,cJ,cK,cL,cM,cN,cO,cP,cQ,cR,cS,cT,cU,cV,cW,cX,cY,cZ,c_,c$,da,db,dc,dd,de,df,dg,dh,di,dj,dk,dl,dm,dn,do0,dp,dq,dr,ds,dt,du,dv,dw,dx,dy,dz,dA,dB,dC,dD,dE,dF,dG,dH,dI,dJ,dK,dL,dM,dN,dO,dP,dQ,dR,dS,dT,dU,dV,dW,dX,dY,dZ,d_,d$,ea,eb,ec,ed,ee,ef,eg,eh,ei,ej,ek,el,em,en,eo,ep,eq,er,es,et,eu,ev,ew,ex,ey,ez,eA,eB,eC,eD,eE,eF,eG,eH,eI,eJ,eK,eL,eM,eN,eO,eP,eQ,eR,eS,eT,eU,eV,eW,eX,eY,eZ,e_,e$,fa,fb,fc,fd,fe,ff,fg,fh,fi,fj,fk,fl,fm,fn,fo,fp,fq,fr,fs,ft,fu,fv,fw,fx,fy,fz,fA,fB,fC,fD,fE,fF,fG,fH,fI,fJ,fK,fL,fM,fN,fO,fP,fQ,fR,fS,fT,fU,fV,fW,fX,fY,fZ,f_,f$,ga,gb,gc,gd,ge,gf,gg,gh,gi,gj,gk,gl,gm,gn,go,gp,gq,gr,gs,gt,gu,gv,gw,gx,gy,gz,gA,gB,gC,gD,gE,gF,gG,gH,gI,gJ,gK,gL,gM,gN,gO,gP,gQ,gR,gS,gT,gU,gV,gW,gX,gY,gZ,g_,g$,ha,hb,hc,hd,he,hf,hg,hh,hi,hj,hk,hl,hm,hn,ho,hp,hq,hr,hs,ht,hu,hv,hw,hx,hy,hz,hA,hB,hC,hD,hE,hF,hG,hH,hI,hJ,hK,hL,hM,hN,hO,hP,hQ,hR,hS,hT,hU,hV,hW,hX,hY,hZ,h_,h$,ia,ib,ic,id,ie,if0,ig,ih,ii,ij,ik,il,im,in0,io,ip,iq,ir,is,it,iu,iv,iw,ix,iy,iz,iA,iB,iC,iD,iE,iF,iG,iH,iI,iJ,iK,iL,iM,iN,iO,iP,iQ,iR,iS,iT,iU,iV,iW,iX,iY,iZ,i_,i$,ja,jb,jc,jd,je,jf,jg,jh,ji,jj,jk,jl,jm,jn,jo,jp,jq,jr,js,jt,ju,jv,jw,jx,jy,jz,jA,jB,jC,jD,jE,jF,jG,jH,jI,jJ,jK,jL,jM,jN,jO,jP,jQ,jR,jS,jT,jU,jV,jW,jX,jY,jZ,j_,j$,ka,kb,kc,kd,ke,kf,kg,kh,ki,kj,kk,kl,km,kn,ko,kp,kq,kr,ks,kt,ku,kv,kw,kx,ky,kz,kA,kB,kC,kD,kE,kF,kG,kH,kI,kJ,kK,kL,kM,kN,kO,kP,kQ,kR,kS,kT,kU,kV,kW,kX,kY,kZ,k_,k$,la,lb,lc,ld,le,lf,lg,lh,li,lj,lk,ll,lm,ln,lo,lp,lq,lr,ls,lt,lu,lv,lw,lx,ly,lz,lA,lB,lC,lD,lE,lF,lG,lH,lI,lJ,lK,lL,lM,lN,lO,lP,lQ,lR,lS,lT,lU,lV,lW,lX,lY,lZ,l_,l$,ma,mb,mc,md,me,mf,mg,mh,mi,mj,mk,ml,mm,mn,mo,mp,mq,mr,ms,mt,mu,mv,mw,mx,my,mz,mA,mB,mC,mD,mE,mF,mG,mH,mI,mJ,mK,mL,mM,mN,mO,mP,mQ,mR,mS,mT,mU,mV,mW,mX,mY,mZ,m_,m$,na,nb,nc,nd,ne,nf,ng,nh,ni,nj,nk,nl,nm,nn,no,np,nq,nr,ns,nt,nu,nv,nw,nx,ny,nz,nA,nB,nC,nD,nE,nF,nG,nH,nI,nJ,nK,nL,nM,nN,nO,nP,nQ,nR,nS,nT,nU,nV,nW,nX,nY,nZ,n_,n$,oa,ob,oc,od,oe,of,og,oh,oi,oj,ok,ol,om,on,oo,op,oq,or,os,ot,ou,ov,ow,ox,oy,oz,oA,oB,oC,oD,oE,oF,oG,oH,oI,oJ,oK,oL,oM,oN,oO,oP,oQ,oR,oS,oT,oU,oV,oW,oX,oY,oZ,o_,o$,pa,pb,pc,pd,pe,pf,pg,ph,pi,pj,pk,pl,pm,pn,po,pp,pq,pr,ps,pt,pu,pv,pw,px,py,pz,pA,pB,pC,pD,pE,pF,pG,pH,pI,pJ,pK,pL,pM,pN,pO,pP,pQ,pR,pS,pT,pU,pV,pW,pX,pY,pZ,p_,p$,qa,qb,qc,qd,qe,qf,qg,qh,qi,qj,qk,ql,qm,qn,qo,qp,qq,qr,qs,qt,qu,qv,qw,qx,qy,qz,qA,qB,qC,qD,qE,qF,qG,qH,qI,qJ,qK,qL,qM,qN,qO,qP,qQ,qR,qS,qT,qU,qV,qW,qX,qY,qZ,q_,q$,ra,rb,rc,rd,re,rf,rg,rh,ri,rj,rk,rl,rm,rn,ro,rp,rq,rr,rs,rt,ru,rv,rw,rx,ry,rz,rA,rB,rC,rD,rE,rF,rG,rH,rI,rJ,rK,rL,rM,rN,rO,rP,rQ,rR,rS){return {data:[{siteConfig:{siteName:"无名の窝",siteHost:"https:\u002F\u002Fcellargalaxy.github.io",basePath:"\u002Fblog-code\u002F",navs:[{text:eD,url:"\u002Fblog-code\u002Fpage\u002F1\u002F"},{text:"归档",url:"\u002Fblog-code\u002Farchive\u002F0\u002F"},{text:"画画",url:"\u002Fblog-code\u002Fhtml\u002Fhua.html"},{text:"开源",url:"\u002Fblog-code\u002Fhttps:\u002Fgithub.com\u002Fcellargalaxy\u002Fblog-vue"}],pageSize:10,urlReplace:{"^/file/blog/code":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode"},backgroundImage:{duration:gC,fade:1000,images:[{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F01\u002F25\u002FcofTzDQXitjeVZ6.jpg",description:gD,type:bA},{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F01\u002F25\u002FsfaRJ2lVeM3NDbE.jpg",description:gD,type:bA},{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F01\u002F26\u002FKybiTdftam5Su7x.jpg",description:"青春猪头-双葉理央",type:bA},{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F09\u002F08\u002FxdX73nfs24qgOYk.jpg",description:"京吹-明日香,久美子",type:bA},{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F02\u002F14\u002FMAiruNcEFW2HYtg.jpg",description:"终将成为你-七海灯子,小糸侑",type:bA},{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F02\u002F05\u002FEojdAxTDJsFpbPw.jpg",description:"玉子市场-北白川玉子",type:bA},{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F01\u002F31\u002FAXxwJDRS9fmN2uU.jpg",description:"fate_hf-弓道馆",type:bA},{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F02\u002F01\u002FaHhVObpJus6dnM4.jpg",description:"fate_hf-樱花树",type:bA}]}},homeConfig:{brandInterval:gC,brands:[{imageUrl:"https:\u002F\u002Fi.loli.net\u002F2020\u002F01\u002F21\u002FmMEAnwY5XPC2pFb.jpg",title:"日常",texts:["我们所度过的每个平凡的日常，也许就是连续不断发生的奇迹。","日々、私たちが過ごしている日常は、実は奇跡の連続なのかもしれない。"]},{imageUrl:"https:\u002F\u002Fi.loli.net\u002F2020\u002F04\u002F19\u002FH1MmXb9xPcYEhT2.jpg",title:"昨日之歌",texts:["时间梭梭箭如飞，人道漫漫步蹒跚","人間そんな変わるもんじゃないのに、月日ばっかどんどん過ぎて"]}],navs:[{text:"Github",url:"https:\u002F\u002Fgithub.com\u002Fcellargalaxy\u002F"}]},pageFootConfig:{lines:[[{text:"Copyright © 2017-? ."},{text:"备案？不存在的"},{text:"Powered by Nuxt.js & Github"}]]},buildTime:new Date(1652943852388),startPage:2018,endPage:2022,currentPage:2020,files:[{slug:gE,description:eE,createdAt:gF,updatedAt:gF,toc:[],body:{type:S,children:[{type:b,tag:i,props:{},children:[{type:a,value:eE}]},{type:a,value:e},{type:a,value:e},{type:b,tag:w,props:{id:gG},children:[{type:b,tag:j,props:{href:"#%E9%A6%96%E9%A1%B5",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:gG}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"本来首页是参考~~（抄袭）~~"},{type:b,tag:j,props:{href:eF,rel:[A,B,C],target:D},children:[{type:a,value:eG}]},{type:a,value:"的首页。\n但后来看到"},{type:b,tag:j,props:{href:gH,rel:[A,B,C],target:D},children:[{type:a,value:gI}]},{type:a,value:"的首页页头是一个幻灯片，中间大而醒目的文案，能够承载多个主题级别的元素。\n就觉得放在首页里非常合适，也与我原本的设计类似。所以现在首页用于展示重要的，较长时间不修改的素材。"}]},{type:a,value:e},{type:b,tag:w,props:{id:gJ},children:[{type:b,tag:j,props:{href:"#%E5%AF%BC%E8%88%AA",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:gJ}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"导航其实只是进行了优化，设计还是参考"},{type:b,tag:j,props:{href:eF,rel:[A,B,C],target:D},children:[{type:a,value:eG}]},{type:a,value:"的。但我发现了个有趣的现象。\n导航默认状态下隐藏，鼠标点击时显示，这里可以用到"},{type:b,tag:y,props:{},children:[{type:a,value:eH}]},{type:a,value:eI},{type:b,tag:y,props:{},children:[{type:a,value:eJ}]},{type:a,value:gK},{type:b,tag:y,props:{},children:[{type:a,value:eH}]},{type:a,value:"是如想象中的控制是否显示，但是加上后"},{type:b,tag:y,props:{},children:[{type:a,value:eJ}]},{type:a,value:"却有式文本渐变出现的功能。"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[eK,P]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:a,value:gL}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:cp},{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:a,value:gM}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aS]},children:[{type:a,value:"@mouseenter"}]},{type:b,tag:c,props:{className:[d,aY]},children:[{type:b,tag:c,props:{className:[d,f,be]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:az}]},{type:a,value:"show=true"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:az}]}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aS]},children:[{type:a,value:"@mouseleave"}]},{type:b,tag:c,props:{className:[d,aY]},children:[{type:b,tag:c,props:{className:[d,f,be]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:az}]},{type:a,value:"show=false"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:az}]}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:aJ},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"\u003C!--这里的v-if自然是控制是否显示，但是v-show却有式文本渐变出现的功能--\u003E"}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:a,value:gN}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aS]},children:[{type:a,value:bS}]},{type:b,tag:c,props:{className:[d,aY]},children:[{type:b,tag:c,props:{className:[d,f,be]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:az}]},{type:a,value:"nav-collapse"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:az}]}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aS]},children:[{type:a,value:"is-nav"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aS]},children:[{type:a,value:eH}]},{type:b,tag:c,props:{className:[d,aY]},children:[{type:b,tag:c,props:{className:[d,f,be]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:az}]},{type:a,value:cN},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:az}]}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aS]},children:[{type:a,value:eJ}]},{type:b,tag:c,props:{className:[d,aY]},children:[{type:b,tag:c,props:{className:[d,f,be]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:az}]},{type:a,value:cN},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:az}]}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:gO},{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:a,value:gP}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aS]},children:[{type:a,value:"align"}]},{type:b,tag:c,props:{className:[d,aY]},children:[{type:b,tag:c,props:{className:[d,f,be]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:az}]},{type:a,value:"center"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:az}]}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:a,value:gQ}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aS]},children:[{type:a,value:"v-for"}]},{type:b,tag:c,props:{className:[d,aY]},children:[{type:b,tag:c,props:{className:[d,f,be]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:az}]},{type:a,value:"(nav,i) in config.navs?config.navs:[]"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:az}]}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aS]},children:[{type:a,value:":key"}]},{type:b,tag:c,props:{className:[d,aY]},children:[{type:b,tag:c,props:{className:[d,f,be]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:az}]},{type:a,value:gR},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:az}]}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aS]},children:[{type:a,value:":href"}]},{type:b,tag:c,props:{className:[d,aY]},children:[{type:b,tag:c,props:{className:[d,f,be]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:az}]},{type:a,value:"nav.url"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:az}]}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:"\n          "},{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:a,value:gS}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:"{{nav.text}}"},{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aZ}]},{type:a,value:gS}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aZ}]},{type:a,value:gQ}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:gO},{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aZ}]},{type:a,value:gP}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aZ}]},{type:a,value:gN}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:"\n\n  "},{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aZ}]},{type:a,value:gM}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aZ}]},{type:a,value:gL}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:eD},children:[{type:b,tag:j,props:{href:"#%E6%96%87%E7%AB%A0",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:eD}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"文章显示上添加了几个优化"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"代码块的行数"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"表格的样式优化"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"图片点击放大"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"添加图表支持"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"添加数学公式支持"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:gT},children:[{type:b,tag:j,props:{href:"#%E5%85%B6%E4%BB%96%E7%BB%84%E4%BB%B6",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:gT}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"返回顶部用上了element的ui，但放弃了以前在返回顶部上还可以有其他跳转链接的功能"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"支持背景图片轮播"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:gU},children:[{type:b,tag:j,props:{href:"#%E8%A3%85%E4%BF%AE%E6%97%B6%E5%8F%82%E8%80%83%E7%9A%84%E7%BD%91%E7%AB%99",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:gU}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:au,props:{alt:ab,"data-src":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20200130\u002FFireShot%20Capture%20002%20-%20%E6%A8%B1%E8%8A%B1%E5%BA%84%E7%9A%84%E7%99%BD%E7%8C%AB%20-%20%E3%81%AD%E3%81%93%E3%83%BB%E3%81%97%E3%82%8D%E3%83%BB%E3%81%BE%E3%81%97%E3%82%8D%20-%202heng.xin.png.1.png"},children:[]}]},{type:a,value:e},{type:b,tag:bB,props:{},children:[{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:eF,rel:[A,B,C],target:D},children:[{type:a,value:eG}]},{type:a,value:x},{type:b,tag:j,props:{href:"https:\u002F\u002Fcndrew.cn\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"Uncle_drew"}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:au,props:{alt:ab,"data-src":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20200130\u002FFireShot%20Capture%20004%20-%20%E5%B9%BB%E4%B9%8B%E5%AD%97%E5%B9%95%E7%BB%84%20-%20Mabors-Sub%20-%20www.mabors.com.png.1.png"},children:[]}]},{type:a,value:e},{type:b,tag:bB,props:{},children:[{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fwww.mabors.com\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"幻之字幕组"}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:au,props:{alt:ab,"data-src":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20200130\u002FFireShot%20Capture%20005%20-%20Senra%E3%81%AE%E5%B0%8F%E7%AA%9D%20-%20%E5%88%9D%E9%97%BB%E5%A4%A9%E7%B1%81%E4%B9%8B%E9%9F%B3%EF%BC%8C%E6%9C%AA%E4%BD%BF%E5%BF%83%E4%B9%8B%E5%B0%86%E6%9D%A5%E3%80%82%20-%20www.senra.me.png.1.png"},children:[]}]},{type:a,value:e},{type:b,tag:bB,props:{},children:[{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"http:\u002F\u002Fwww.senra.me\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"senra"}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:au,props:{alt:ab,"data-src":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20200130\u002FFireShot%20Capture%20006%20-%20%E5%B8%B8%E4%B9%9F%20-%20%E5%83%8F%E5%88%9D%E9%9B%AA%E4%B8%80%E6%A0%B7%E8%87%AA%E7%94%B1%E6%B4%92%E8%90%BD%20-%20fech.in.png.1.png"},children:[]}]},{type:a,value:e},{type:b,tag:bB,props:{},children:[{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"http:\u002F\u002Ffech.in\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"常也"}]},{type:a,value:x},{type:b,tag:j,props:{href:"https:\u002F\u002Fapa70.com\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"Apa琦的小博客"}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:au,props:{alt:ab,"data-src":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20200130\u002FFireShot%20Capture%20007%20-%20%E9%97%AA%E7%83%81%E4%B9%8B%E7%8B%90%20-%20blinkfox.github.io.png.1.png"},children:[]}]},{type:a,value:e},{type:b,tag:bB,props:{},children:[{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:gH,rel:[A,B,C],target:D},children:[{type:a,value:gI}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:au,props:{alt:ab,"data-src":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20200130\u002FFireShot%20Capture%20008%20-%20%E6%AD%A3%E5%9C%A8%E5%AD%A6%E4%B9%A0%E7%9A%84Mr.Xu%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD%20-%20www.cnblogs.com.png.1.png"},children:[]}]},{type:a,value:e},{type:b,tag:bB,props:{},children:[{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fwww.cnblogs.com\u002FXuChengNotes\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"正在学习的Mr.Xu"}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:au,props:{alt:ab,"data-src":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20200130\u002FFireShot%20Capture%20009%20-%20Hi,%20DIYgod%20-%20diygod.me.png.1.png"},children:[]}]},{type:a,value:e},{type:b,tag:bB,props:{},children:[{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fdiygod.me\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"Hi,DIYgod"}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:j,props:{href:gV,rel:[A,B,C],target:D},children:[{type:a,value:gV}]}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:j,props:{href:gW,rel:[A,B,C],target:D},children:[{type:a,value:gW}]}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:j,props:{href:gX,rel:[A,B,C],target:D},children:[{type:a,value:gX}]}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:j,props:{href:gY,rel:[A,B,C],target:D},children:[{type:a,value:gY}]}]},{type:a,value:e}]}]},excerpt:{type:S,children:[{type:b,tag:i,props:{},children:[{type:a,value:eE}]}]},dir:gZ,path:"\u002F随笔\u002F20200130\u002F博客2.0装修",extension:ap,title:gE,url:"\u002Fblog-code\u002Fview\u002F$E9$9A$8F$E7$AC$94\u002F20200130\u002F$E5$8D$9A$E5$AE$A22.0$E8$A3$85$E4$BF$AE\u002F",createAt:new Date(1580342400000),updateAt:new Date(1580342400000),attributes:[{name:aq,value:g_},{name:ar,value:g_},{name:as,value:gZ,url:"\u002Fblog-code\u002Fpage\u002F$E9$9A$8F$E7$AC$94\u002F20200130\u002F1\u002F"}]},{slug:g$,description:"前记\n之前刚入手n1的时候就是想倒腾Armbian做小pc的，但是当时出于几个原因就放弃了。\n一是当时以为，只要有断电强关机，系统就会崩掉。\n实际上并不会，当时崩了以为只是以为我自己搞崩的，然后无法重启只能强行断电，然后以为断电搞崩了。。。\n二是我没成功安装中文输入法。\n三是内存只有2G，浏览器打开三四个非视频页面还行的，再多就卡爆\n四是视频播放不支持硬解，看网页视频或者播放本地视频只能到720，不然就是看ppt加卡爆。\n但是生命不息，折腾不止，心想给n1刷个Armbian桌面版能做个垃圾小pc，再装上docker能做个下载机和垃圾nas，最后再在docker装个openwrt来个旁路由，想想都觉得自己血赚。。。\n注意\n下面的操作步骤最好按顺序，不然有可能会莫名其妙的崩掉。已经下面会有几次reboot命令，请不要偷懒，最后才来reboot，否则也可能会莫名其妙的崩掉。",createdAt:ha,updatedAt:ha,toc:[],body:{type:S,children:[{type:b,tag:w,props:{id:cO},children:[{type:b,tag:j,props:{href:hb,ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:cO}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:hc}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:hd}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:he}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:hf}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:hg}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:hh}]},{type:a,value:e},{type:b,tag:w,props:{id:cP},children:[{type:b,tag:j,props:{href:hi,ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:cP}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:cq,props:{},children:[{type:b,tag:ac,props:{},children:[{type:a,value:hj}]}]}]},{type:a,value:e},{type:a,value:e},{type:b,tag:w,props:{id:hk},children:[{type:b,tag:j,props:{href:"#%E5%87%86%E5%A4%87",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:hk}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"必须"}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:bT,props:{to:"\u002Ffile\u002Fblog\u002Fcode\u002F20200221\u002F%E6%96%90%E8%AE%AFT1%E3%80%81N1%E5%AE%98%E6%96%B9%E7%B3%BB%E7%BB%9F%E9%99%8D%E7%BA%A7%E5%B7%A5%E5%85%B7.zip"},children:[{type:a,value:"斐讯T1、N1官方系统降级工具.zip"}]}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:bT,props:{to:"\u002Ffile\u002Fblog\u002Fcode\u002F20200221\u002Fusbit.zip"},children:[{type:a,value:"usbit.zip"}]}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:bT,props:{to:"\u002Ffile\u002Fblog\u002Fcode\u002F20200221\u002Fmeson-gxl-s905d-phicomm-n1-xiangsm.7z"},children:[{type:a,value:"meson-gxl-s905d-phicomm-n1-xiangsm.7z"}]}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:bT,props:{to:"\u002Ffile\u002Fblog\u002Fcode\u002F20200221\u002FArmbian_5.77_Aml-s905_Ubuntu_bionic_default_5.0.2_20190401.img.xz"},children:[{type:a,value:"Armbian_5.77_Aml-s905_Ubuntu_bionic_default_5.0.2_20190401.img.xz"}]}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:bT,props:{to:"\u002Ffile\u002Fblog\u002Fcode\u002F20200221\u002FArmbian_5.77_Aml-s905_Ubuntu_bionic_default_5.0.2_desktop_20190401.img.xz"},children:[{type:a,value:"Armbian_5.77_Aml-s905_Ubuntu_bionic_default_5.0.2_desktop_20190401.img.xz"}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"可选\u002F备份"}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:bT,props:{to:"\u002Ffile\u002Fblog\u002Fcode\u002F20200221\u002FBACKUP-s9xxx-emmc.img.gz"},children:[{type:a,value:"BACKUP-s9xxx-emmc.img.gz，原系统备份"}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:hl},children:[{type:b,tag:j,props:{href:"#%E9%99%8D%E7%BA%A7",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:hl}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:cq,props:{},children:[{type:b,tag:ac,props:{},children:[{type:a,value:"先断网，避免降级之后n1又自动升级。我没试过联网状态下操作会咋样，反正大家都这么说，那就保险起见照做呗。"}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"降级参照webpad大佬的恩山教程即可："},{type:b,tag:j,props:{href:"https:\u002F\u002Fwww.right.com.cn\u002Fforum\u002Fthread-340279-1-1.html%E3%80%82",rel:[A,B,C],target:D},children:[{type:a,value:"https:\u002F\u002Fwww.right.com.cn\u002Fforum\u002Fthread-340279-1-1.html。"}]},{type:a,value:"\n斐讯T1、N1官方系统降级工具.zip里面也有操作的截图。\n对于n1来说就是接上电源、网线、显示器和鼠标，用鼠标点几下版本号，下面就会出现一个【打开adb】的弹框。然后记录下n1所获取到的ip即可。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"我一开始n1通电开机我是没有断网的，查着有线，不知道是不是这个原因，n1显示的ip竟然是202.x.x.x。断网重启n1之后依然如此，路由器没没有显示n1所获取的ip。\n不过我没考究过这个202.x.x.x的ip是不是当时没断网我路由器的出口ip，反正断网之后我让让n1连wifi，就获取到了192的ip了。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"然后回到电脑里，执行斐讯T1、N1官方系统降级工具.zip里面的onekey文件夹下面的run.bat选择n1降级，按提示天ip就好。\n成功降级之后，n1所显示的版本号是不会改变的，怕的就降级多几遍呗。"}]},{type:a,value:e},{type:b,tag:w,props:{id:"armbian镜像与dtb选择"},children:[{type:b,tag:j,props:{href:"#armbian%E9%95%9C%E5%83%8F%E4%B8%8Edtb%E9%80%89%E6%8B%A9",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"Armbian镜像与dtb选择"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"参考："},{type:b,tag:j,props:{href:"https:\u002F\u002Fwww.right.com.cn\u002Fforum\u002Fthread-510423-1-1.html%E3%80%82",rel:[A,B,C],target:D},children:[{type:a,value:"https:\u002F\u002Fwww.right.com.cn\u002Fforum\u002Fthread-510423-1-1.html。"}]},{type:a,value:"\n经过无数恩山大佬的倒腾，貌似目前网上最主流的稳定版本是Armbian5.77。\ndtb使用xiangsm的meson-gxl-s905d-phicomm-n1-xiangsm.dtb。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"听网上说，官方作者由于侵权，把之前旧的镜像全删了，我找了好久才找到了5.7.7ubuntu的server版和桌面版。\n更多镜像询问谷歌或者到这里翻翻："},{type:b,tag:j,props:{href:hm,rel:[A,B,C],target:D},children:[{type:a,value:hm}]}]},{type:a,value:e},{type:b,tag:w,props:{id:"制作armbian启动盘"},children:[{type:b,tag:j,props:{href:"#%E5%88%B6%E4%BD%9Carmbian%E5%90%AF%E5%8A%A8%E7%9B%98",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"制作Armbian启动盘"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"网上很多人都用usbit.zip制作驱动盘，小巧不用安装。\n写入完成镜像之后，需要把meson-gxl-s905d-phicomm-n1-xiangsm.dtb文件复制到dtb文件夹下，然后修改uEnv.ini文件。"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,bt]},children:[{type:b,tag:y,props:{},children:[{type:a,value:"dtb_name=\u002Fdtb\u002Fmeson-gxl-s905d-phicomm-n1-xiangsm.dtb\n"}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:cq,props:{},children:[{type:b,tag:ac,props:{},children:[{type:a,value:"跟多人都说千万不要在安卓系统开机的情况下插入U盘，否则U盘中的文件权限会被安卓系统篡改。我没试过，反正照做就是。"}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:hn},children:[{type:b,tag:j,props:{href:"#n1%E5%88%87%E6%8D%A2%E4%B8%BA%E5%90%AF%E5%8A%A8%E7%9B%98%E6%A8%A1%E5%BC%8F",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:hn}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"在斐讯T1、N1官方系统降级工具里，onekey\u002Fdata文件夹下有个adb.exe。执行"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:a,value:"adb connect 斐讯IP\nadb shell "},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:cr}]},{type:a,value:eL}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"n1就会重启，要抓紧时间在重启的时候把U盘插到靠近HDMI的USB口，然后就会在U盘里启动。\n如果错失了重启插入U盘的机会，n1会进入貌似安卓拯救状态的界面，就需要再次执行上面的adb重新来过了。\n（不是很懂，但可能跟BIOS找不到启动盘报错差不多意思吧）"}]},{type:a,value:e},{type:b,tag:w,props:{id:ho},children:[{type:b,tag:j,props:{href:"#%E5%8E%9F%E7%B3%BB%E7%BB%9F%E5%A4%87%E4%BB%BD%E4%B8%8E%E8%BF%98%E5%8E%9F",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:ho}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"如无意外机会从U盘里启动成功，最好先备份一下原系统，搞崩了，或者需要刷其他东西能恢复。\n备份完成，在pc里通过scp把备份的镜像复制出来备份（原来Windows也自带scp命令）。\n要恢复原系统，再弄个启动盘，在启动盘里刷原系统即可。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"ddbr可以备份的不单止安卓系统，也可以备份和恢复armbian，所以如果弄好了一个自己满意的系统状态，可以ddbr一下备份。以后把系统搞崩了，用个u盘装个"},{type:b,tag:cq,props:{},children:[{type:b,tag:ac,props:{},children:[{type:a,value:"全新的"}]}]},{type:a,value:"armbian（因为我发现，直接把自己ddbr下来的进行压到U盘里，虽然能正常启动和使用，但是没有ddbr和nand–sata-install命令）。然后把之前备份好的镜像scp到U盘里恢复。"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"#备份输入命令顺序"}]},{type:a,value:hp},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:R}]},{type:a,value:" b -"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:R}]},{type:a,value:hq},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:R}]},{type:a,value:hr},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"#会备份到\u002Fddbr文件夹下"}]},{type:a,value:"\nll \u002Fddbr\n"},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"#恢复输入命令顺序"}]},{type:a,value:hp},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:R}]},{type:a,value:" r -"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:R}]},{type:a,value:hq},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:R}]},{type:a,value:hr}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:"把armbian刷进emmc"},children:[{type:b,tag:j,props:{href:"#%E6%8A%8Aarmbian%E5%88%B7%E8%BF%9Bemmc",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"把Armbian刷进emmc"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"命令执行完成后重启即可"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:" nand–sata-install\n"}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:hs},children:[{type:b,tag:j,props:{href:"#%E7%BD%91%E7%BB%9C%E9%97%AE%E9%A2%98",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:hs}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"这个网络问题我没有明显感觉，但是有教程说到，这里备份一下做法。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"armbian启动的时候没有等待网卡分配到IP，会导致一些监听网络的程序无法正常工作，需要大家修改一下网卡的模式为auto，即可强制开机等待网络分配（当然太久分配不到也会超时进入系统）"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:cQ}]},{type:a,value:cR},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bl}]},{type:a,value:cR},{type:b,tag:c,props:{className:[d,aw,E]},children:[{type:a,value:ht}]},{type:a,value:" \u002Fetc\u002Fnetwork\u002Finterfaces.d\u002F*\n \n"},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:hu}]},{type:a,value:"\nauto eth0\n"},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"#allow-hotplug eth0"}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"我在路由器上给N1分配静态IP的时候发现，armbian的有线网卡每次重启后MAC地址都会变（这个我没成功，可能我改错了?）"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:cQ}]},{type:a,value:cR},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bl}]},{type:a,value:cR},{type:b,tag:c,props:{className:[d,aw,E]},children:[{type:a,value:ht}]},{type:a,value:" \u002Fetc\u002Fnetwork\u002Finterfaces.d\u002F*\n\n"},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:hu}]},{type:a,value:"\nallow-hotplug eth0\nno-auto-down eth0\niface eth0 inet dhcp\nhwaddress 4e:03:88:54:39:93\n"}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:hv},children:[{type:b,tag:j,props:{href:"#%E6%9B%BF%E6%8D%A2apt%E6%BA%90",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:hv}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bl}]},{type:a,value:" \u002Fetc\u002Fapt\u002Fsources.list\n"}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"Ubuntu的"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:a,value:"deb https:\u002F\u002Fmirrors.tuna.tsinghua.edu.cn\u002Fubuntu-ports\u002F bionic main restricted universe multiverse\n"},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"#deb-src https:\u002F\u002Fmirrors.tuna.tsinghua.edu.cn\u002Fubuntu-ports\u002F bionic main restricted universe multiverse"}]},{type:a,value:"\ndeb https:\u002F\u002Fmirrors.tuna.tsinghua.edu.cn\u002Fubuntu-ports\u002F bionic-security main restricted universe multiverse\n"},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"#deb-src https:\u002F\u002Fmirrors.tuna.tsinghua.edu.cn\u002Fubuntu-ports\u002F bionic-security main restricted universe multiverse"}]},{type:a,value:"\ndeb https:\u002F\u002Fmirrors.tuna.tsinghua.edu.cn\u002Fubuntu-ports\u002F bionic-updates main restricted universe multiverse\n"},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"#deb-src https:\u002F\u002Fmirrors.tuna.tsinghua.edu.cn\u002Fubuntu-ports\u002F bionic-updates main restricted universe multiverse"}]},{type:a,value:"\ndeb https:\u002F\u002Fmirrors.tuna.tsinghua.edu.cn\u002Fubuntu-ports\u002F bionic-backports main restricted universe multiverse\n"},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"#deb-src https:\u002F\u002Fmirrors.tuna.tsinghua.edu.cn\u002Fubuntu-ports\u002F bionic-backports main restricted universe multiverse"}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"Debian的"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:a,value:"deb "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:a,value:cS}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:cT},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:a,value:" https:\u002F\u002Fmirrors.tuna.tsinghua.edu.cn\u002Fdebian\u002F stretch main contrib non-free\n"},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"#deb-src https:\u002F\u002Fmirrors.tuna.tsinghua.edu.cn\u002Fdebian\u002F stretch main contrib non-free"}]},{type:a,value:eM},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:a,value:cS}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:cT},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:a,value:" https:\u002F\u002Fmirrors.tuna.tsinghua.edu.cn\u002Fdebian\u002F stretch-updates main contrib non-free\n"},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"#deb-src https:\u002F\u002Fmirrors.tuna.tsinghua.edu.cn\u002Fdebian\u002F stretch-updates main contrib non-free"}]},{type:a,value:eM},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:a,value:cS}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:cT},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:a,value:" https:\u002F\u002Fmirrors.tuna.tsinghua.edu.cn\u002Fdebian\u002F stretch-backports main contrib non-free\n"},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"#deb-src https:\u002F\u002Fmirrors.tuna.tsinghua.edu.cn\u002Fdebian\u002F stretch-backports main contrib non-free"}]},{type:a,value:eM},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:a,value:cS}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:cT},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:a,value:" https:\u002F\u002Fmirrors.tuna.tsinghua.edu.cn\u002Fdebian-security\u002F stretch\u002Fupdates main contrib non-free\n"},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"#deb-src https:\u002F\u002Fmirrors.tuna.tsinghua.edu.cn\u002Fdebian-security\u002F stretch\u002Fupdates main contrib non-free"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"#deb [ arch=arm64,armhf ] https:\u002F\u002Fmirrors.tuna.tsinghua.edu.cn\u002Fdebian\u002F sid main contrib non-free"}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"执行下面"},{type:b,tag:y,props:{},children:[{type:a,value:"sudo apt-get upgrade"}]},{type:a,value:"的命令，可能在半途报错说啥啥啥文件\u002F文件夹只读，在这种情况下重启n1再执行就好。或者把这句命令留到最后，执行之前ddbr一下现有系统，反正不更新又不会死。这点最后会再解释。"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aN}]},{type:a,value:eL},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aN}]},{type:a,value:" upgrade\n"}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:"swap占用过高但物理内存还有空余"},children:[{type:b,tag:j,props:{href:"#swap%E5%8D%A0%E7%94%A8%E8%BF%87%E9%AB%98%E4%BD%86%E7%89%A9%E7%90%86%E5%86%85%E5%AD%98%E8%BF%98%E6%9C%89%E7%A9%BA%E4%BD%99",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"swap占用过高，但物理内存还有空余"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"临时调整"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:" sysctl vm.swappiness"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:ba}]},{type:a,value:"\nvm.swappiness "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:ba}]},{type:a,value:aA},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:cQ}]},{type:a,value:" \u002Fproc\u002Fsys\u002Fvm\u002Fswappiness\n"},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:ba}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"永久调整"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bl}]},{type:a,value:" \u002Fetc\u002Fsysctl.conf\nvm.swappiness"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:ba}]},{type:a,value:aA},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"#激活设置："}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:" sysctl -p\n"}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:hw},children:[{type:b,tag:j,props:{href:"#%E8%AE%BE%E7%BD%AE%E6%97%B6%E5%8C%BA%E4%B8%BA%E5%8C%97%E4%BA%AC%E6%97%B6%E9%97%B4",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:hw}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"ln"}]},{type:a,value:" -sf \u002Fusr\u002Fshare\u002Fzoneinfo\u002FAsia\u002FShanghai \u002Fetc\u002Flocaltime "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:hx}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aw,E]},children:[{type:a,value:cU}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"Asia\u002FShanghai\""}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:R}]},{type:a,value:" \u002Fetc\u002Ftimezone\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"date"}]},{type:a,value:" -R\n"}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:"删除默认-dns"},children:[{type:b,tag:j,props:{href:"#%E5%88%A0%E9%99%A4%E9%BB%98%E8%AE%A4-dns",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"删除默认 DNS"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:hy}]},{type:a,value:" \u002Fetc\u002Fresolvconf\u002Fresolv.conf.d\u002Fhead "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:hx}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"touch"}]},{type:a,value:" \u002Fetc\u002Fresolvconf\u002Fresolv.conf.d\u002Fhead\n"}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:hz},children:[{type:b,tag:j,props:{href:"#%E6%94%AF%E6%8C%81%E4%B8%AD%E6%96%87%E6%98%BE%E7%A4%BA",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:hz}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"安装中文包和字体"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aN}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aE}]},{type:a,value:" language-pack-zh-hans\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aN}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aE}]},{type:a,value:" fonts-droid-fallback ttf-wqy-zenhei ttf-wqy-microhei fonts-arphic-ukai fonts-arphic-uming\n"}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"修改语言"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bl}]},{type:a,value:" \u002Fetc\u002Fdefault\u002Flocale\n"},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:hA}]}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:cV}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:hB}]}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:hC}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:hD}]}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:aH}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:hE}]}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:aH}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:hF}]}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:aH}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:hG}]}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:aH}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:hH}]}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:aH}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:hI}]}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:aH}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:hJ}]}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:aH}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:hK}]}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:aH}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:hL}]}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:aH}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:hM}]}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:cV}]},{type:a,value:aA},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bl}]},{type:a,value:" \u002Fetc\u002Fenvironment\n"},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:hA}]}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:cV}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:hB}]}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:hC}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:hD}]}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:aH}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:hE}]}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:aH}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:hF}]}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:aH}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:hG}]}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:aH}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:hH}]}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:aH}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:hI}]}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:aH}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:hJ}]}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:aH}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:hK}]}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:aH}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:hL}]}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:aH}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:hM}]}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:cV}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"最后"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:" locale-gen\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:cr}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:hN},children:[{type:b,tag:j,props:{href:"#%E5%AE%89%E8%A3%85%E8%B0%B7%E6%AD%8C%E6%8B%BC%E9%9F%B3%E8%BE%93%E5%85%A5%E6%B3%95",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:hN}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:hO}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bf}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aE}]},{type:a,value:" fcitx fcitx-tools fcitx-config* fcitx-frontend* fcitx-module* fcitx-ui-* presage\n\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bf}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aE}]},{type:a,value:" fcitx-pinyin            "},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 拼音"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bf}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aE}]},{type:a,value:" fcitx-sunpinyin         "},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# sun拼音"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bf}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aE}]},{type:a,value:" fcitx-googlepinyin      "},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# google拼音"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bf}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aE}]},{type:a,value:" fcitx-table-wubi-large  "},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 五笔"}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"设置fcitx"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:" im-config -s fcitx -z default\n"}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"重启"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:cr}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"重启之后右上角应该会有个小键盘，虽然在fcitx里，我依然是没显示任何的输入法可以+，但是按ctrl+space可以切换输入法了。"}]},{type:a,value:e},{type:b,tag:w,props:{id:hP},children:[{type:b,tag:j,props:{href:"#%E5%AE%89%E8%A3%85docker",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:hP}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"使用官方的脚本，如果安装他教程的命令一个个执行，最后还是找不到docker-ce。"},{type:b,tag:j,props:{href:hQ,rel:[A,B,C],target:D},children:[{type:a,value:hQ}]}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:hR}]},{type:a,value:hS},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:hT}]},{type:a,value:hU}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:hV},children:[{type:b,tag:j,props:{href:"#%E5%AE%89%E8%A3%85openwrt%E5%81%9A%E6%97%81%E8%B7%AF%E7%94%B1",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:hV}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"首先在armbian里开启一个叫网卡混杂模式，功能应该是让openwrt自己有一个网卡，单独向路由器获取一个ip"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"ip"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"link"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aw,E]},children:[{type:a,value:bC}]},{type:a,value:" eth0 promisc on\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:" modprobe pppoe\n"}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"然后在docker里创建一个网卡"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:" network create -d macvlan --subnet"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:hW}]},{type:a,value:".123.0\u002F24 --gateway"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:hW}]},{type:a,value:".123.1 -o "},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:a,value:"parent"}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:"eth0 macnet\n"}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"之后安装openwrt，有两个版本。一个是"},{type:b,tag:y,props:{},children:[{type:a,value:"kanshudj\u002Fn1-openwrtgateway:r9.10.1"}]},{type:a,value:"，另一个是"},{type:b,tag:y,props:{},children:[{type:a,value:"unifreq\u002Fopenwrt-aarch64:r9.10.24"}]},{type:a,value:"。unifreq的略大，我只用来科学上网，所以就挑了kanshudj的"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:bg},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:hX},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:bU},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:hY},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:hZ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\nkanshudj\u002Fn1-openwrtgateway:r9.10.1 \u002Fsbin\u002Finit\n\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:bg},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:hX},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:bU},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:hY},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:hZ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\nunifreq\u002Fopenwrt-aarch64:r9.10.24 \u002Fsbin\u002Finit\n"}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"安装完成之后，进入openwrt容器里的命令行环境，修改网卡配置。然后重启openwrt"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:h_}]},{type:a,value:" \u002Fetc\u002Fconfig\u002Fnetwork\n\nconfig interface "},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'loopback'"}]},{type:a,value:eN},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'lo'"}]},{type:a,value:eO},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:h$}]},{type:a,value:ia},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'127.0.0.1'"}]},{type:a,value:ib},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'255.0.0.0'"}]},{type:a,value:"\n\nconfig globals "},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'globals'"}]},{type:a,value:"\n        option ula_prefix "},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'fd2f:ea21:0e02::\u002F48'"}]},{type:a,value:ic},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'lan'"}]},{type:a,value:"\n        option "},{type:b,tag:c,props:{className:[d,aw,E]},children:[{type:a,value:cW}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'bridge'"}]},{type:a,value:eN},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'eth0'"}]},{type:a,value:eO},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:h$}]},{type:a,value:ia},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'192.168.123.2'"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"#openwrt的静态ip"}]},{type:a,value:ib},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'255.255.255.0'"}]},{type:a,value:"\n        option gateway "},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:id}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"#路由器ip"}]},{type:a,value:"\n        option dns "},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:id}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"#DNS，按自己喜欢改"}]},{type:a,value:ic},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'vpn0'"}]},{type:a,value:eN},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'tun0'"}]},{type:a,value:eO},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'none'"}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"我好久没用过openwrt了，以至于差点找不到怎么配透明代理。配透明代理在【服务】-【影梭加速 Plus+】-【服务节点】里添加SS\u002FSSR\u002FV2RAY。默认的透明代理端口是"},{type:b,tag:y,props:{},children:[{type:a,value:"1234"}]},{type:a,value:"，最可续的是没找到如何自定义配置文件。当上面的【访问Google-访问正常】后，例如在电脑的【控制面板\u002F网络和 Internet\u002F网络连接】里，把网关设置为openwrt的ip，按道理就翻出去了。需要注意一点是，我试过把n1的armbian的网关也设置为openwrt的ip，然后发现就翻不出去了，可能有什么冲突。"}]},{type:a,value:e},{type:b,tag:w,props:{id:ie},children:[{type:b,tag:j,props:{href:"#%E5%AE%89%E8%A3%85%E7%81%AB%E7%8B%90%E6%B5%8F%E8%A7%88%E5%99%A8",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:ie}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aN}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aE}]},{type:a,value:" firefox\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aN}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aE}]},{type:a,value:" firefox-locale-zh-hans\n"}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:"docker日志限制"},children:[{type:b,tag:j,props:{href:"#docker%E6%97%A5%E5%BF%97%E9%99%90%E5%88%B6",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"Docker日志限制"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"一下配置只对新创建的容器生效，现有容器请remove再建"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bl}]},{type:a,value:" \u002Fetc\u002Fdocker\u002Fdaemon.json\n\n"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:cp},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:if0}]},{type:b,tag:c,props:{className:[d,aw,E]},children:[{type:a,value:ao}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:ig}]},{type:a,value:eP},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:ih}]},{type:b,tag:c,props:{className:[d,aw,E]},children:[{type:a,value:ao}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:ii}]},{type:b,tag:c,props:{className:[d,aw,E]},children:[{type:a,value:ao}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:ij}]},{type:a,value:ik},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:il}]},{type:b,tag:c,props:{className:[d,aw,E]},children:[{type:a,value:ao}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:im}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:aA},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:in0},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:io},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"清理日志脚本"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bl}]},{type:a,value:" clean_docker_log.sh\n\n"},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"#!\u002Fbin\u002Fsh"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,aw,E]},children:[{type:a,value:cU}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"======== start clean docker containers logs ========\""}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:a,value:"logs"}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,Q]},children:[{type:a,value:bD}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"find"}]},{type:a,value:" \u002Fvar\u002Flib\u002Fdocker\u002Fcontainers\u002F -name *-json.log"},{type:b,tag:c,props:{className:[d,Q]},children:[{type:a,value:m}]}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:eQ}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,"for-or-select",Q]},children:[{type:a,value:"log"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bE}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,Q]},children:[{type:a,value:"$logs"}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:"do"}]},{type:a,value:ip},{type:b,tag:c,props:{className:[d,aw,E]},children:[{type:a,value:cU}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"clean logs : "},{type:b,tag:c,props:{className:[d,Q]},children:[{type:a,value:iq}]},{type:a,value:az}]},{type:a,value:ip},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:cQ}]},{type:a,value:" \u002Fdev\u002Fnull "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:R}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,Q]},children:[{type:a,value:iq}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:"done"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,aw,E]},children:[{type:a,value:cU}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"======== end clean docker containers logs ========\""}]},{type:a,value:aA},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:ir}]},{type:a,value:" +x clean_docker_log.sh\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:" .\u002Fclean_docker_log.sh\n"}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:is},children:[{type:b,tag:j,props:{href:"#%E6%B8%85%E7%90%86",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:is}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"du"}]},{type:a,value:" -sh \u002Fvar\u002Fcache\u002Fapt\u002Farchives\n\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aN}]},{type:a,value:" clean\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aN}]},{type:a,value:" autoclean\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aN}]},{type:a,value:" autoremove\n"}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:"开机挂载u盘"},children:[{type:b,tag:j,props:{href:"#%E5%BC%80%E6%9C%BA%E6%8C%82%E8%BD%BDu%E7%9B%98",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"开机挂载U盘"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:" blkid\n\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bl}]},{type:a,value:" \u002Fetc\u002Ffstab\n"},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:a,value:eR}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:"B07C12B77C1277F4 \u002Fmedia\u002Fuser\u002Fupan ntfs defaults "},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:aI}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:it},children:[{type:b,tag:j,props:{href:"#%E4%B8%80%E4%BA%9Bdocker%E9%95%9C%E5%83%8F",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:it}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:" volume create caddy_data \n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:bg},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n--name caddy "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:cX},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:cY},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-v \u002Fcaddy\u002FCaddyfile:\u002Fetc\u002FCaddyfile "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-v caddy_data:\u002Froot\u002F.caddy "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n--net"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:"host "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\njessestuart\u002Fcaddy\n\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:iu},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:bg},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n--name portainer "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:cX},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:cY},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aG},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:iv}]},{type:a,value:":8000 "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aG},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:iw}]},{type:a,value:":9000 "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-v \u002Fvar\u002Frun\u002Fdocker.sock:\u002Fvar\u002Frun\u002Fdocker.sock "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-v portainer_data:\u002Fdata "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\nportainer\u002Fportainer:latest\n\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:bg},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n--name v2ray "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:cX},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:cY},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-v \u002Fdoc\u002Fv2ray:\u002Fetc\u002Fv2ray "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aG},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:"10808"}]},{type:a,value:":10808 "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aG},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:"10809"}]},{type:a,value:":10809 "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\nv2fly\u002Fv2fly-core:v4.22.1\n\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:bg},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n--name samba "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:cX},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:cY},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aG},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:"137"}]},{type:a,value:":137\u002Fudp "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aG},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:"138"}]},{type:a,value:":138\u002Fudp "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aG},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:"139"}]},{type:a,value:":139 "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aG},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:ix}]},{type:a,value:":445 "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aG},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:ix}]},{type:a,value:":445\u002Fudp "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n--hostname "},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'aml'"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-v \u002Fmedia\u002Fuser\u002Fupan:\u002Fshare\u002Ffolder "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\nelswork\u002Fsamba -u "},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"user:password\""}]},{type:a,value:" -s "},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"upan:\u002Fshare\u002Ffolder:rw:user\""}]},{type:a,value:aA},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:" volume create filebrowser_data\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:bg},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n--name filebrowser "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:bU},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:eS},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:a,value:"WEB_PORT"}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:iy}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aG},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:iy}]},{type:a,value:":9900 "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-v filebrowser_data:\u002Fconfig "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-v \u002Fmedia\u002Fuser\u002Fupan:\u002Fmyfiles "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n--mount "},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:a,value:cW}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:"tmpfs,destination"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:"\u002Ftmp "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n80x86\u002Ffilebrowser:latest\n\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:iz}]},{type:a,value:" clone https:\u002F\u002Fgithub.com\u002FAuska\u002Fdocker-transmission.git\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:" build -t transmission "},{type:b,tag:c,props:{className:[d,aw,E]},children:[{type:a,value:u}]},{type:a,value:aA},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:" volume create transmission_data_config\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:" volume create transmission_data_watch\n\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:bg},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n--name transmission "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:bU},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-v transmission_data_config:\u002Fconfig "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-v \u002Fmedia\u002Fuser\u002Fupan\u002Ftransmission:\u002Fdownloads "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-v transmission_data_watch:\u002Fwatch "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aG},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:"9091"}]},{type:a,value:":9091 "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aG},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:iA}]},{type:a,value:":51413 "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aG},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:iA}]},{type:a,value:":51413\u002Fudp "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\ntransmission:latest\n\n"},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 这个镜像好像做了什么防止反代的东西，需要docker的内外部端口一致"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 所以只能先用8080，在web修改端口后，remove掉容器再run一个"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:" volume create qbittorrent_config\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:" volume create qbittorrent_cache\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:" volume create qbittorrent_local\n\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:bg},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:iB},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:bU},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aG},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:cZ}]},{type:a,value:iC},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aG},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:cZ}]},{type:a,value:iD},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aG},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:iE}]},{type:a,value:":8080 "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-v qbittorrent_config:\u002Fdata\u002F.config "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-v qbittorrent_cache:\u002Fdata\u002F.cache "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-v qbittorrent_local:\u002Fdata\u002F.local "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-v \u002Fmedia\u002Fuser\u002Fupan\u002Fbt:\u002Fdata\u002Fdownloads "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\ngists\u002Fqbittorrent\n\n\n"},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 下面这个qbittorrent不知道为啥没速度"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:" volume create qbittorrent_data\n\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:bg},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:iB},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:bU},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:eS},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:a,value:"TZ"}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:"Asia\u002FShanghai "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:eS},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:a,value:"WEBUI_PORT"}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:iF}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aG},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:cZ}]},{type:a,value:iC},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aG},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:cZ}]},{type:a,value:iD},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aG},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:iF}]},{type:a,value:":9092 "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-v qbittorrent_data:\u002Fconfig "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-v \u002Fmedia\u002Fuser\u002Fupan\u002Fqbittorrent:\u002Fdownloads "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\nlinuxserver\u002Fqbittorrent\n"}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:iG},children:[{type:b,tag:j,props:{href:"#%E7%8E%B0%E6%9C%89%E9%97%AE%E9%A2%98",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:iG}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"狗逼谷歌不知道为什么在2019年年底禁止了linux的部分浏览器登录谷歌账号，所以chromium登录不来谷歌。虽然火狐可以登录，但无法同步书签也就废了一半了。"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:eT,props:{},children:[{type:a,value:"使用docker pull拉的镜像好像很多都无法启动，可能拉的是非arm的编译版本。"}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:eT,props:{},children:[{type:a,value:"portainer是可以直接pull的，v2ray需要自己写个Dockerfile来构建，才会下载arm版本，filebrowser研究了一轮依然无解。\n希望openwrt没有这样的问题。"}]},{type:a,value:"\n3. 有些镜像只编译好了AMD版本，没ARM，有些是可以通过指定版本号来指定ARM的，具体看吧\n4. 我在倒腾的时候，会遇到搞着搞着，armbian原本的那九百多M的swap不见了的情况，有可能是下面两条命令或者之一导致的。没找到恢复的方案"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,Z]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 残余的配置文件"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:" dpkg --list "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"grep"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"^rc\""}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:c_}]},{type:a,value:" -d "},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\" \""}]},{type:a,value:" -f "},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:bh}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"xargs"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:" dpkg --purge\n\n"},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 删除过时的软件包"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"aptitude"}]},{type:a,value:" purge ~o\n"}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:aK}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fluotianyi.vc\u002F1306.html",rel:[A,B,C],target:D},children:[{type:a,value:"斐讯N1探索手记#1 – 降级并刷入armbian系统"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fwww.dragoncave.me\u002F2019\u002F07\u002Farmbian-on-n1.html",rel:[A,B,C],target:D},children:[{type:a,value:"斐讯N1折腾记 - Armbian 5.77 刷入与优化"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fyuerblog.cc\u002F2019\u002F10\u002F23\u002F%E6%96%90%E8%AE%AFn1-%E5%AE%8C%E7%BE%8E%E5%88%B7%E6%9C%BAarmbian%E6%95%99%E7%A8%8B\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"斐讯N1 – 完美刷机Armbian教程"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fleeyr.com\u002F323.html",rel:[A,B,C],target:D},children:[{type:a,value:"N1 备份 + 刷机 + 安装 Armbian"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fblog.csdn.net\u002Fweixin_39792252\u002Farticle\u002Fdetails\u002F80415550",rel:[A,B,C],target:D},children:[{type:a,value:"Ubuntu的中文乱码问题 [完美解决]"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fblog.csdn.net\u002Fzhangchao19890805\u002Farticle\u002Fdetails\u002F52743380",rel:[A,B,C],target:D},children:[{type:a,value:"Ubuntu 在命令下，安装中文环境的方法。"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fibcl.us\u002FPhicommT1-Armbian_20190825\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"某科学的 T1 盒子刷 Armbian 调教笔记"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fblog.csdn.net\u002Fqq_21397217\u002Farticle\u002Fdetails\u002F52447263",rel:[A,B,C],target:D},children:[{type:a,value:"Ubuntu安装Fcitx以及Fcitx输入中文不显示候选词框的解决办法"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fblog.csdn.net\u002FWangJiankun_ls\u002Farticle\u002Fdetails\u002F65628963",rel:[A,B,C],target:D},children:[{type:a,value:"ubuntu 16.04 安装谷歌拼音输入法"}]}]}]},excerpt:{type:S,children:[{type:b,tag:w,props:{id:cO},children:[{type:b,tag:j,props:{ariaHidden:q,href:hb,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:cO}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:hc}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:hd}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:he}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:hf}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:hg}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:hh}]},{type:a,value:e},{type:b,tag:w,props:{id:cP},children:[{type:b,tag:j,props:{ariaHidden:q,href:hi,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:cP}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:cq,props:{},children:[{type:b,tag:ac,props:{},children:[{type:a,value:hj}]}]}]}]},dir:iH,path:"\u002F折腾\u002F20200221\u002Fn1安装armbian做小pc",extension:ap,title:g$,url:"\u002Fblog-code\u002Fview\u002F$E6$8A$98$E8$85$BE\u002F20200221\u002Fn1$E5$AE$89$E8$A3$85armbian$E5$81$9A$E5$B0$8Fpc\u002F",createAt:new Date(1582243200000),updateAt:new Date(1582243200000),attributes:[{name:aq,value:iI},{name:ar,value:iI},{name:as,value:iH,url:"\u002Fblog-code\u002Fpage\u002F$E6$8A$98$E8$85$BE\u002F20200221\u002F1\u002F"}]},{slug:iJ,description:ab,createdAt:iK,updatedAt:iK,toc:[],body:{type:S,children:[{type:a,value:e},{type:b,tag:w,props:{id:iL},children:[{type:b,tag:j,props:{href:"#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%8A%A0%E8%BD%BD%E4%BC%98%E5%85%88%E7%BA%A7",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:iL}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"SpringBoot对于所加载的多个配置文件，会进行合并共存。如果配置文件之间有冲突，规则是冲突部分高优先级的配置覆盖低优先级的配置。而加载的地方有多个，常见的地方，优先级从高到低有（"},{type:b,tag:j,props:{href:"https:\u002F\u002Fdocs.spring.io\u002Fspring-boot\u002Fdocs\u002F1.5.9.RELEASE\u002Freference\u002Fhtmlsingle\u002F#boot-features-external-config",rel:[A,B,C],target:D},children:[{type:a,value:"spring官网文档"}]},{type:a,value:"）："}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"命令行参数"},{type:b,tag:y,props:{},children:[{type:a,value:"java -jar app.jar --server.port=8087 --配置=值"}]}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"jar包外部的application-{profile}.properties\u002Fyml配置文件"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"jar包内部的application-{profile}.properties\u002Fyml配置文件"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"jar包外部的application.properties\u002Fyml配置文件"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"jar包内部的application.properties\u002Fyml配置文件"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"@Configuration注解类上的@PropertySource"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"通过SpringApplication.setDefaultProperties指定的默认属性"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"因此，最常见的四个路径："},{type:b,tag:y,props:{},children:[{type:a,value:"file:.\u002Fconfig\u002F"}]},{type:a,value:R},{type:b,tag:y,props:{},children:[{type:a,value:"file:.\u002F"}]},{type:a,value:R},{type:b,tag:y,props:{},children:[{type:a,value:"classpath:\u002Fconfig\u002F"}]},{type:a,value:R},{type:b,tag:y,props:{},children:[{type:a,value:"classpath:\u002F"}]},{type:a,value:"，有profile高于没profile，properties高于yaml。配置文件路径的优先级高于配置文件类型。也就是说，如果有两个配置文件："},{type:b,tag:y,props:{},children:[{type:a,value:"classpath:\u002Fconfig\u002Fapplication.yml"}]},{type:a,value:eI},{type:b,tag:y,props:{},children:[{type:a,value:"classpath:\u002Fapplication.properties"}]},{type:a,value:"。此时yaml优先级高于properties。"}]},{type:a,value:e},{type:b,tag:w,props:{id:iM},children:[{type:b,tag:j,props:{href:"#%E9%85%8D%E7%BD%AE%E7%9A%84%E4%BD%BF%E7%94%A8%E4%B8%8E%E8%A3%85%E9%85%8D",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:iM}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"要使用配置文件的配置，可以使用@ConfigurationProperties和@Value这两个注解加载配置"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"配置文件"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,"language-properties"]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,bm,aS]},children:[{type:a,value:"user.username"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,eU,aY]},children:[{type:a,value:"admin"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,bm,aS]},children:[{type:a,value:"user.password"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,eU,aY]},children:[{type:a,value:"123456"}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"使用@ConfigurationProperties"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,aT]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,at,f]},children:[{type:a,value:c$}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,at,f]},children:[{type:a,value:da}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:db},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:iN}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ax}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bq}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:eV}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aO}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:a,value:eW},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aO}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:a,value:eX},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:eY},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:eZ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"使用@Value"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,aT]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,at,f]},children:[{type:a,value:c$}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ax}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bq}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:eV}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,at,f]},children:[{type:a,value:iO}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"user.username\""}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aO}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:a,value:eW},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,at,f]},children:[{type:a,value:iO}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"user.password\""}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aO}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:a,value:eX},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:eY},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:eZ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:iP},children:[{type:b,tag:j,props:{href:"#%E5%8A%A0%E8%BD%BD%E6%8C%87%E5%AE%9A%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:iP}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"要加载指定的配置文件，需要使用@PropertySource注解，使用："}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,aT]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,at,f]},children:[{type:a,value:"@PropertySource"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:"value "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"classpath:user.properties\""}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"classpath:admin.properties\""}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,at,f]},children:[{type:a,value:c$}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,at,f]},children:[{type:a,value:da}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:db},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:iN}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ax}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bq}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:eV}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aO}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:a,value:eW},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aO}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:a,value:eX},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:eY},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:eZ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"@PropertySource注解："}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,aT]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ax}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,at,f]},children:[{type:a,value:"@interface"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:dc}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"\u002F\u002F指定一个配置文件"}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:e_}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:dd}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:e$}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"\u002F\u002F指定多个配置文件，如果多个配置文件直接配置冲突，从左往右，右边优先级高"}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:eU}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"\u002F\u002F如果配置文件没找着，是否忽略"}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aa}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"ignoreResourceNotFound"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:dd}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:bN}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"\u002F\u002F配置文件编码"}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:iQ}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:dd}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:e$}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"\u002F\u002F配置文件的解析工厂"}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:"Class"}]},{type:b,tag:c,props:{className:[d,aL]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bF}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:"extends"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:de}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"factory"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:dd}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:de}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bq}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"其中比较有趣的是配置文件的解析工厂，默认是PropertySourceFactory，是个接口，其唯一的实现是DefaultPropertySourceFactory："}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,aT]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ax}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bq}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:"DefaultPropertySourceFactory"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:iR}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:de}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,at,f]},children:[{type:a,value:iS}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ax}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:dc}]},{type:b,tag:c,props:{className:[d,aL]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bF}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:iT}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,at,f]},children:[{type:a,value:iU}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:a,value:df},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:iV}]},{type:a,value:dg},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:iW}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:iX}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:dh},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:"!="}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:a_}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bF}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aU}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:iY}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:e_},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:dg},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ao}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aU}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:iY}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:"resource"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"可以看到使用的是ResourcePropertySource进行解析，可以解析properties和xml，所以@PropertySource不支持yaml。所以如果要支持yaml，需要自己实现PropertySourceFactory，在@PropertySource里指定。"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,aT]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ax}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bq}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:"MyYamlPropertySourceFactory"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:iR}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:de}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,at,f]},children:[{type:a,value:iS}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ax}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:dc}]},{type:b,tag:c,props:{className:[d,aL]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bF}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:iT}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,at,f]},children:[{type:a,value:iU}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:a,value:df},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:iV}]},{type:a,value:dg},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:iW}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:iX}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aU}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:"YamlPropertySourceLoader"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"load"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:e_},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:dg},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"get"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:aI}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"除此以外，还可以通过PropertyPlaceholderConfigurer支持加载yaml文件。PropertyPlaceholderConfigurer的作用是给代码中${}占位符赋值，可以给PropertyPlaceholderConfigurer设置yaml解析。"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,aT]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,at,f]},children:[{type:a,value:bV}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ax}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:cs}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:fa}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:br}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:fa}]},{type:a,value:" propertySourcesPlaceholderConfigurer "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aU}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:fa}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:iZ}]},{type:a,value:" yaml "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aU}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:iZ}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:"\n    yaml"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"setResources"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aU}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:"ClassPathResource"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"simple.yml\""}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:"\n    propertySourcesPlaceholderConfigurer"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"setProperties"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:"yaml"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"getObject"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:" propertySourcesPlaceholderConfigurer"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:"通过contextrefresher重新加载或者魔改配置"},children:[{type:b,tag:j,props:{href:"#%E9%80%9A%E8%BF%87contextrefresher%E9%87%8D%E6%96%B0%E5%8A%A0%E8%BD%BD%E6%88%96%E8%80%85%E9%AD%94%E6%94%B9%E9%85%8D%E7%BD%AE",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"通过ContextRefresher重新加载或者魔改配置"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"Spring Cloud Config支持热更配置，其核心在于调用ContextRefresher对象的refresh方法。这部分原理还不是很了解，据参考文章里说，Spring Cloud Config通过创建一个临时的Spring Boot Application加载配置文件。重新加载或者魔改配置的核心在于下面："}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,aT]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:"ConfigurableApplicationContext"}]},{type:a,value:" application "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:"ContextRefresher"}]},{type:a,value:" contextRefresher "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:dc}]},{type:b,tag:c,props:{className:[d,aL]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bF}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:" propertySource "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:"\n\napplication"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"getEnvironment"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"getPropertySources"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"addFirst"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:"propertySource"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:"\ncontextRefresher"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"refresh"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"ConfigurableApplicationContext就不多说了，ContextRefresher我现在是通过application.getBean()获取的。一开始我好像试过通过@Autowired注入ContextRefresher，但不记得是因为不行还是什么其他原因，现在变成了application.getBean()获取。PropertySource就是PropertySourceFactory接口返回的对象。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"其中有一点奇怪的，这个PropertySource需要放在队列最前面。通过debug发现，spring不知道为啥会将这个队列倒过来用，即实际上他是最后一个生效的，会覆盖前面的配置。后面的配置覆盖前面的配置，有点像@PropertySource。"}]},{type:a,value:e},{type:b,tag:w,props:{id:i_},children:[{type:b,tag:j,props:{href:"#%E5%8A%A8%E6%80%81%E5%88%B7%E6%96%B0bean",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:i_}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"Spring Cloud Config使用ContextRefresher实现热更，除了能热更@Configuration的配置以外，还能热更任何bean，包括数据库或者redis的。要实现数据库或者redis的热更，需要手动些方法，通过@Bean注解注册bean，然后加上@RefreshScope注解，表明这个bean是需要热更的。"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,aT]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,at,f]},children:[{type:a,value:i$}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,at,f]},children:[{type:a,value:c$}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ax}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bq}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:"BeanConfig"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,at,f]},children:[{type:a,value:ct}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,at,f]},children:[{type:a,value:da}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:db},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"spring.redis\""}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,at,f]},children:[{type:a,value:bV}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ax}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:fb}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"redisProperties"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aU}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:fb}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:aJ},{type:b,tag:c,props:{className:[d,at,f]},children:[{type:a,value:ct}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,at,f]},children:[{type:a,value:bV}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ax}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ja}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:jb}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:fb}]},{type:a,value:di},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:fc},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bW}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"配置redis的database: {}\""}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:di},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:jc}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:fc},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bW}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"配置redis的host: {}\""}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:di},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:jd}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:fc},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bW}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"配置redis的port: {}\""}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:di},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:je}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:"\n        \n        "},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:jf}]},{type:a,value:" poolConfig "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aU}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:jf}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:cu},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"setMaxIdle"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:br},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:dj}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"getMaxIdle"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:cu},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"setMinIdle"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:br},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:dj}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"getMinIdle"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:cu},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"setMaxTotal"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:br},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:dj}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"getMaxActive"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:cu},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"setMaxWaitMillis"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:br},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:dj}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"getMaxWait"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:cu},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"setTestOnBorrow"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:q}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:fd},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:jg}]},{type:a,value:" jedisConnectionFactory "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aU}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:jg}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:bX},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"setDatabase"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:br},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:jc}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:bX},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"setHostName"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:br},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:jd}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:bX},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"setPort"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:br},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:je}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:bX},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"setPassword"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:br},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"getPassword"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:bX},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"setTimeout"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:br},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"getTimeout"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:bX},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"setPoolConfig"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:"poolConfig"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:" jedisConnectionFactory"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:aJ},{type:b,tag:c,props:{className:[d,at,f]},children:[{type:a,value:ct}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,at,f]},children:[{type:a,value:bV}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ax}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:bO}]},{type:b,tag:c,props:{className:[d,aL]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:jh}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ja}]},{type:a,value:" redisConnectionFactory"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ji}]},{type:a,value:" stringRedisSerializer "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aU}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ji}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:fd},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:bO}]},{type:b,tag:c,props:{className:[d,aL]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:" redisTemplate "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aU}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:bO}]},{type:b,tag:c,props:{className:[d,aL]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:cv},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"setConnectionFactory"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:jb},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:fe},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"setKeySerializer"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:cw},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:cv},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"setValueSerializer"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:cw},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:fe},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"setHashKeySerializer"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:cw},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:cv},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"setHashValueSerializer"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:cw},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:fe},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"setEnableDefaultSerializer"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:q}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:cv},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"setDefaultSerializer"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:cw},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:fd},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:bu},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:"\n    \n    "},{type:b,tag:c,props:{className:[d,at,f]},children:[{type:a,value:ct}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,at,f]},children:[{type:a,value:da}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:db},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"spring.datasource\""}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,at,f]},children:[{type:a,value:bV}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ax}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:jj}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:jk}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:"DataSourceBuilder"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"create"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"build"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:aJ},{type:b,tag:c,props:{className:[d,at,f]},children:[{type:a,value:ct}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,at,f]},children:[{type:a,value:bV}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ax}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:jl}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"jdbcTemplate"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:jj}]},{type:a,value:" dataSource"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aU}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:jl}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:jk},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:jm}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fwww.scienjus.com\u002Fspring-boot-properties-priority\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"Spring Boot 的配置文件优先级"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fblog.csdn.net\u002FJ080624\u002Farticle\u002Fdetails\u002F80508606",rel:[A,B,C],target:D},children:[{type:a,value:"SpringBoot - 配置文件加载位置与优先级"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fblog.csdn.net\u002FIT_faquir\u002Farticle\u002Fdetails\u002F80869578",rel:[A,B,C],target:D},children:[{type:a,value:"SpringBoot配置加载，各配置文件优先级对比"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fblog.csdn.net\u002Flipei1220\u002Farticle\u002Fdetails\u002F94593836",rel:[A,B,C],target:D},children:[{type:a,value:"深入理解spring注解@PropertySource的实现原理"}]}]}]},excerpt:{type:S,children:[]},dir:jn,path:"\u002F框架\u002F20200319\u002FSpringBoot的配置文件",extension:ap,title:iJ,url:"\u002Fblog-code\u002Fview\u002F$E6$A1$86$E6$9E$B6\u002F20200319\u002FSpringBoot$E7$9A$84$E9$85$8D$E7$BD$AE$E6$96$87$E4$BB$B6\u002F",createAt:new Date(1584576000000),updateAt:new Date(1584576000000),attributes:[{name:aq,value:jo},{name:ar,value:jo},{name:as,value:jn,url:"\u002Fblog-code\u002Fpage\u002F$E6$A1$86$E6$9E$B6\u002F20200319\u002F1\u002F"}]},{slug:jp,description:"选型\n\nDisqus，需要翻墙，不过我不觉得是什么问题。\n来必力，韩国的评论系统，自带中文，无需翻墙。感觉比Disqus要友好。\nValine，开源的前端评论框架，数据保存在leancloud里。leancloud貌似是国内服务，注册需要手机，告辞。\nutterances、gitalk、gitment、vssue等issue系，利用github的issue实现的评论系统。数据难以备份和迁移，对于每一页的博文都要手动去初始化，略有麻烦。然后看到手记4：谈谈Gitment中泄露secret的前因后果与解决方法一文，说了一句卧槽，告辞。\ncommento，开源的评论系统，服务端可以自己部署，不过依赖于PostgreSQL数据库，太小题大做了，管理麻烦，下一个。\nStatiman，开源的评论系统，服务端可以自己部署，将评论保存在yaml或者json文件，然后保存到github库上。很方便对数据进行备份迁移，看来一下部署教程有点复杂，自己部署服务数据还不在自己手上，作罢。\nIsso，也是个开源的评论系统，服务端好像是用php写的，占几十m内存，数据库用sqlite，docker部署，备份管理简单。\n\n最后我还是选择了Isso。由于Disqus被墙，也不是很好看，所以本来我是想用来必力的了。但是基于能不注册就不注册，数据能在自己手里就在自己手里的原则，最后还是选择了自己搭建，也就几十M内存，还过得去。",createdAt:jq,updatedAt:jq,toc:[],body:{type:S,children:[{type:b,tag:w,props:{id:dk},children:[{type:b,tag:j,props:{href:jr,ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:dk}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:js}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:jt}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:ju}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:jv},{type:b,tag:j,props:{href:ff,rel:[A,B,C],target:D},children:[{type:a,value:fg}]},{type:a,value:jw}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:jx}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:jy}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:jz}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:jA}]},{type:a,value:e},{type:a,value:e},{type:b,tag:w,props:{id:"isso的配置文件"},children:[{type:b,tag:j,props:{href:"#isso%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"Isso的配置文件"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"Isso的配置文件默认叫"},{type:b,tag:y,props:{},children:[{type:a,value:"isso.conf"}]},{type:a,value:"，这是我的配置"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,bt]},children:[{type:b,tag:y,props:{},children:[{type:a,value:"[general]\n# SQLite3数据库位置\ndbpath = \u002Fdb\u002Fcomments.db\n\nname = isso\n\n# 您的网站。如果Isso无法连接到至少一个站点，则您将启动过程中收到警告，注释很可能无法正常运行。\n# 我建议第一个值是用作回退的非SSL网站\nhost = \n    http:\u002F\u002Flocalhost\u002F\n    https:\u002F\u002Fdomain.com\u002F\n\n# 时间范围，允许用户编辑\u002F删除自己的评论。\nmax-age = 15m\n\n[admin]\nenabled = true\n\n# 管理员访问密码\npassword = password\n\n[server]\n# 监听的地址\nlisten = http:\u002F\u002F0.0.0.0:8080\u002F\n# 管理页面的url前缀\npublic-endpoint=\u002F\u002Fdomain.com\u002Fisso\n\n[moderation]\n# 开启评论审核\nenabled = true\n# 30日未审核的评论字段删除\npurge-after = 30d\n\n[guard]\n# 启用基本的垃圾邮件防护功能，例如每个IP地址的速率限制\n\n# 启用防护，在生产中建议使用。对于调试目的没有用。\nenabled = true\n\n# 每分钟最多只能有N条新评论。\nratelimit = 10\n\n# 直接对线程进行多少注释 ,防止简单而 while true; do curl ...; done.\ndirect-reply = 1\n\n# 允许评论者在仍然可以编辑评论时回复自己的评论。 编辑时间段结束后，评论者仍然可以回复自己的评论。 不要忘记配置客户端。\nreply-to-self = false\n\n# 强制评论者在“作者”字段中输入值。 不对提供的值执行验证。 不要忘记相应地配置客户端。\nrequire-author = true\n\n# 要求评论者输入电子邮件地址（注意：未对提供的地址进行验证）。 不要忘记配置客户端。\nrequire-email = false\n"}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:"安装isso"},children:[{type:b,tag:j,props:{href:"#%E5%AE%89%E8%A3%85isso",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"安装Isso"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"Isso可以使用docker安装，就很方便了，我是用的是"},{type:b,tag:j,props:{href:"https:\u002F\u002Fhub.docker.com\u002Fr\u002Fwonderfall\u002Fisso\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"wonderfall\u002Fisso"}]},{type:a,value:"。不过我试过在windows安装，windows下会报错，貌似不支持。"},{type:b,tag:y,props:{},children:[{type:a,value:"\u002Fdb"}]},{type:a,value:"目录下保存着sqlite文件，配置文件在"},{type:b,tag:y,props:{},children:[{type:a,value:"\u002Fconfig"}]},{type:a,value:"下。"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,cx]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:" volume create isso_data\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:" run -d --name isso --restart"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:jB},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:iE}]},{type:a,value:":8080 -v isso_data:\u002Fdb -v \u002Fconfig:\u002Fconfig wonderfall\u002Fisso\n"}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:jC},children:[{type:b,tag:j,props:{href:"#caddy%E5%8F%8D%E4%BB%A3",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:jC}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"其中transparent会传递请求来源的ip等头信息，会影响评论频率的限制。然后就可以进"},{type:b,tag:j,props:{href:"https:\u002F\u002Fdomain.com\u002Fisso\u002Fadmin%E7%AE%A1%E7%90%86%E5%90%8E%E5%8F%B0%E9%87%8C%E3%80%82",rel:[A,B,C],target:D},children:[{type:a,value:"https:\u002F\u002Fdomain.com\u002Fisso\u002Fadmin管理后台里。"}]}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,bt]},children:[{type:b,tag:y,props:{},children:[{type:a,value:"domain.com {\n  gzip\n  proxy \u002F http:\u002F\u002F127.0.0.1\u002F\n  proxy \u002Fisso http:\u002F\u002F127.0.0.1:8080 {\n    without \u002Fisso\n    transparent\n  }\n}\n"}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:jD},children:[{type:b,tag:j,props:{href:"#%E5%9D%91",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:jD}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"如果你在本地用"},{type:b,tag:j,props:{href:"http:\u002F\u002Flocalhost\u002F%E6%B5%8B%E8%AF%95%EF%BC%8C%E6%88%96%E8%80%85%E7%9B%B4%E6%8E%A5%E8%BF%9Bhttp:\u002F\u002Fdomain.com:8080\u002Fadmin%EF%BC%8C%E5%BA%94%E8%AF%A5%E4%BC%9A%E4%B8%80%E5%88%87%E6%AD%A3%E5%B8%B8%EF%BC%8C%E4%BD%86%E6%98%AF%E8%BF%9Bhttps:\u002F\u002Fdomain.com\u002Fisso\u002Fadmin%EF%BC%8C%E6%88%96%E8%80%85%E5%9C%A8%E5%8D%9A%E6%96%87%E9%A1%B5%E9%9D%A2%E6%A3%80%E6%9F%A5%E8%AF%84%E8%AE%BA%E7%BB%84%E4%BB%B6%E6%98%AF%E5%90%A6%E5%8A%A0%E8%BD%BD%E6%88%90%E5%8A%9F%EF%BC%8C%E5%B0%B1%E4%BC%9A%E5%8F%91%E7%8E%B0%E5%A4%B1%E8%B4%A5%E3%80%82isso%E9%BB%98%E8%AE%A4http%E5%8D%8F%E8%AE%AE%EF%BC%8Cjs%E5%92%8Ccss%E4%BC%9A%E5%8A%A0%E8%BD%BD%E4%B8%8D%E5%87%BA%E6%9D%A5%EF%BC%8C%E5%92%8C%E5%AF%BC%E8%87%B4405",rel:[A,B,C],target:D},children:[{type:a,value:"http:\u002F\u002Flocalhost\u002F测试，或者直接进http:\u002F\u002Fdomain.com:8080\u002Fadmin，应该会一切正常，但是进https:\u002F\u002Fdomain.com\u002Fisso\u002Fadmin，或者在博文页面检查评论组件是否加载成功，就会发现失败。isso默认http协议，js和css会加载不出来，和导致405"}]},{type:a,value:" Method Not Allowed。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"解决方案有两个，第一个是在caddy里加一个响应头"},{type:b,tag:y,props:{},children:[{type:a,value:"Content-Security-Policy: upgrade-insecure-requests"}]},{type:a,value:"。浏览器收到这个响应头后会把页面中所有的http请求自动升级为https请求，如果https资源不存在也不会fallback直接报错。方案二是在isso的配置文件里指定public-endpoint，这样子isso就会在url前以public-endpoint的值为开头，推荐这种方法。"}]},{type:a,value:e},{type:b,tag:w,props:{id:jE},children:[{type:b,tag:j,props:{href:"#%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BB%A3%E7%A0%81",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:jE}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"在需要放置评论组件的地方插入这个html，id=\"isso-thread\"是必须的，貌似被写死了。"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,eK]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:a,value:jF}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aS]},children:[{type:a,value:bS}]},{type:b,tag:c,props:{className:[d,aY]},children:[{type:b,tag:c,props:{className:[d,f,be]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:az}]},{type:a,value:"isso-thread"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:az}]}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aZ}]},{type:a,value:jF}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"然后加载一个js。其中js的url一开始我以为是从cdn里加载的，搞了好久之后我查发现可以直接从isso服务端里加载！！！而"},{type:b,tag:y,props:{},children:[{type:a,value:jG}]},{type:a,value:"是isso的api的地址。所以在caddy的isso路径下进行反代的话，其实就是下面这样。"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,eK]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:a,value:cy}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aS]},children:[{type:a,value:jG}]},{type:b,tag:c,props:{className:[d,aY]},children:[{type:b,tag:c,props:{className:[d,f,be]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:az}]},{type:a,value:"\u002Fisso\u002F"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:az}]}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aS]},children:[{type:a,value:"src"}]},{type:b,tag:c,props:{className:[d,aY]},children:[{type:b,tag:c,props:{className:[d,f,be]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:az}]},{type:a,value:"\u002Fisso\u002Fjs\u002Fembed.min.js"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:az}]}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:b,tag:c,props:{className:[d,cy]},children:[]},{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aZ}]},{type:a,value:cy}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"其余的详看官网"},{type:b,tag:j,props:{href:jH,rel:[A,B,C],target:D},children:[{type:a,value:jH}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:aK}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fchanghungtao.github.io\u002F%E6%8A%80%E6%9C%AF\u002F2019\u002F02\u002F25\u002F%E4%BD%BF%E7%94%A8Statiman%E7%BB%99%E5%8D%9A%E5%AE%A2%E6%8F%90%E4%BE%9B%E8%AF%84%E8%AE%BA%E5%8A%9F%E8%83%BD.html",rel:[A,B,C],target:D},children:[{type:a,value:"使用Statiman给博客提供评论功能（一）"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fliriansu.com\u002Fposts\u002F2019-11-19-build-a-staic-blog\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"搭建一个不需要自己开服务器的纯静态博客"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fkaffa.im\u002Fadd-comments-system-to-my-blog.html",rel:[A,B,C],target:D},children:[{type:a,value:"为博客添加评论系统"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:ff,rel:[A,B,C],target:D},children:[{type:a,value:fg}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fwww.fengkx.top\u002Fpost\u002Fcomment-system\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"评论系统折腾录"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fweiweitop.fun\u002F2019\u002F08\u002F10\u002F%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%AF%94%E8%BE%83%E5%8F%8A%E9%80%89%E6%8B%A9\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"静态博客评论系统的比较及选择"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"http:\u002F\u002Fsappharuhi.xyz\u002F2018\u002F05\u002F06\u002F%E5%87%A0%E7%A7%8D%E7%AC%AC%E4%B8%89%E6%96%B9%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%AE%80%E5%8D%95%E4%B8%BB%E8%A7%82%E8%AF%84%E6%B5%8B\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"几种第三方评论系统的简单主观评测"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"http:\u002F\u002Feinverne.github.io\u002Fpost\u002F2018\u002F05\u002Fblog-comment-system.html",rel:[A,B,C],target:D},children:[{type:a,value:"静态博客评论系统选择对比"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fblog.tangxiaozhu.com\u002F15458303913069.html",rel:[A,B,C],target:D},children:[{type:a,value:"静态博客第三方评论系统的探索"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fkaitohh.com\u002Fisso-configuration\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"使用开源评论系统 isso"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fyouendless.com\u002Fpost\u002Fisso\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"开源评论系统isso"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fkaix.in\u002F0001\u002Fself-hosted-isso-commento",rel:[A,B,C],target:D},children:[{type:a,value:"自建评论系统 Isso Commento"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fnetworm.me\u002F2019\u002F08\u002F04\u002Fcommento-install\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"Commento 安装配置"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fwww.practicemp.com\u002F2018\u002F09\u002Fisso.html",rel:[A,B,C],target:D},children:[{type:a,value:"使用 Isso 搭建评论系统"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fwww.omega.im\u002F251\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"Ubuntu 18.04 搭建Isso评论系统 教程"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fdark-wind.github.io\u002Fruby\u002Fblog-comment-with-staticman\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"为博客添加staticman评论组件"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Ferl.im\u002Fblog\u002Fthe-jekyll-comment-system",rel:[A,B,C],target:D},children:[{type:a,value:"Jekyll 评论系统折腾记"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fzhangnew.com\u002Fisso-open-source-comment-system.html",rel:[A,B,C],target:D},children:[{type:a,value:"开源评论系统 Isso 全攻略"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Froriri.one\u002F2019\u002F10\u002F06\u002Fisso-https\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"开源评论框 isso 后台无法通过 HTTPS 访问的解决方法"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fjesselau.com\u002Finstall-isso-nginx-hugo\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"Nginx下安装isso开源评论系统用于Hugo以及幻景关"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fwww.hscbook.com\u002Farticle\u002Fisso-comment\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"一劳永逸，搭建ISSO开源评论系统全攻略教程"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"http:\u002F\u002Fyangyingming.com\u002Farticle\u002F426\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"ISSO 评论系统部署攻略"}]}]}]},excerpt:{type:S,children:[{type:b,tag:w,props:{id:dk},children:[{type:b,tag:j,props:{href:jr,ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:dk}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:js}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:jt}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:ju}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:jv},{type:b,tag:j,props:{href:ff,rel:[A,B,C],target:D},children:[{type:a,value:fg}]},{type:a,value:jw}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:jx}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:jy}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:jz}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:jA}]}]},dir:jI,path:"\u002F折腾\u002F20200402\u002F博客评论系统",extension:ap,title:jp,url:"\u002Fblog-code\u002Fview\u002F$E6$8A$98$E8$85$BE\u002F20200402\u002F$E5$8D$9A$E5$AE$A2$E8$AF$84$E8$AE$BA$E7$B3$BB$E7$BB$9F\u002F",createAt:new Date(1585785600000),updateAt:new Date(1585785600000),attributes:[{name:aq,value:jJ},{name:ar,value:jJ},{name:as,value:jI,url:"\u002Fblog-code\u002Fpage\u002F$E6$8A$98$E8$85$BE\u002F20200402\u002F1\u002F"}]},{slug:jK,description:fh,createdAt:jL,updatedAt:jL,toc:[{id:jM,depth:_,text:jN}],body:{type:S,children:[{type:b,tag:i,props:{},children:[{type:a,value:fh}]},{type:a,value:e},{type:a,value:e},{type:b,tag:w,props:{id:jO},children:[{type:b,tag:j,props:{href:"#%E5%9C%BA%E6%99%AF%E4%B8%8E%E9%97%AE%E9%A2%98",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:jO}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"有个定时任务，每到整点执行当前小时的任务。也就14点执行14点任务，15点执行15点任务，到了15点，哪怕14点任务还没执行也不用再执行了。原则，重复执行比不执行好。以前多节点执行任务也是使用了redis锁，逻辑是以小时为key，获取了锁的节点把key的超时时间设置为两个小时，避免其他节点能在拿到锁。但据说出现过问题，一两月下来突然有一两个任务执行失败了，至于什么问题由于历史久远已经无从查起。"}]},{type:a,value:e},{type:b,tag:w,props:{id:jP},children:[{type:b,tag:j,props:{href:"#%E7%8E%B0%E6%9C%89%E7%9A%84redis%E9%94%81%E9%80%BB%E8%BE%91",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:jP}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,aT]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ax}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bq}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:"AutoPushRedisImpl"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,at,f]},children:[{type:a,value:"@Autowired"}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aO}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:bO}]},{type:a,value:bu},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:aJ},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ax}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aa}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:jQ}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:a,value:bb},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:jR}]},{type:a,value:jS},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:"TimeUnit"}]},{type:a,value:jT},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bc}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:jh},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:jU}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"setIfAbsent"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:bm},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:e$}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aB}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:"System"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"currentTimeMillis"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:"\n            redisTemplate"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"expire"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:bm},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:jS},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:jT},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:aM},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:q}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:bN}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:aJ},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ax}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aa}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:jV}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:a,value:bb},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:cv},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"delete"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:bm},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:q}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"先从理论上说，这种实现会有两个问题。一是加锁的时间没有带上持锁人的信息，解锁的时候容易导致把别人的锁解了。二是如果setIfAbsent执行成功之后突然挂了，没能执行expire，那锁就永远都不会过期了。结合这个场景进行分析。第一点，锁是不用主动解的，实际上unLock方法就没被调用。设置了两小时过期时间，两小时之后就不会执行这个任务了，也不会有实例抢这个锁（当然前提是全部实例的时间都是对的）。而第二点，setIfAbsent执行成功后就报错了，锁永远不过时，其他节点无法执行这个任务，而这个节点又没执行这个任务，确实会导致描述里的问题。我本来觉得第二点虽然理论上可能会发生，但实际概率估计很小。不过现在想来服务器都在海外，网络波动应该是不可避免的才对。setIfAbsent的请求到redis，设置成功了，突然网络波动连接断开，setIfAbsent报错，也很合理。"}]},{type:a,value:e},{type:b,tag:w,props:{id:jW},children:[{type:b,tag:j,props:{href:"#%E6%94%B9%E8%BF%9B%E6%80%9D%E8%B7%AF",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:jW}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"自然是修复redis锁的逻辑bug"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"增加一个任务执行失败后的有限重试机制"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"上面猜测setIfAbsent报错导致任务执行失败，但不止setIfAbsent的报错会导致任务执行失败。因此需要在任务由于任何原因执行失败之后，其他节点都能够重试这个任务。为了实现第二点，我的思路是，例如任务执行大约需要一分钟，那么节点获取锁之后给key设置十分钟的过期时间，足够执行任务。当任务执行完成，把key的过期时间设置为两小时，避免任务被重复执行。当任务执行抛异常被捕抓到，主动释放锁，或者当任务执行被强制中断，没能主动释放锁，但由于锁十分钟之后也会自动过期。所以没把key的过期时间修改两小时的任务都视为未能完成的任务，最后会因为锁的释放被重新执行。然后在redis记录任务执行的次数，当执行次数已经超过最大值，哪怕获取到锁也不再执行任务。这里由于是获取到锁才给执行次数加一，所以不要考虑并发问题。"}]},{type:a,value:e},{type:b,tag:w,props:{id:jX},children:[{type:b,tag:j,props:{href:"#redis%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:jX}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"依赖，这里jedis的版本由spring-boot-starter-redis决定。"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,"language-xml"]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:a,value:dl}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:a,value:dm}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:"redis.clients"},{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aZ}]},{type:a,value:dm}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:a,value:dn}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:jY},{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aZ}]},{type:a,value:dn}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aZ}]},{type:a,value:dl}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:a,value:dl}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:a,value:dm}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:"org.springframework.boot"},{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aZ}]},{type:a,value:dm}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:a,value:dn}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:"spring-boot-starter-redis"},{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aZ}]},{type:a,value:dn}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,U]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aZ}]},{type:a,value:dl}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"获取锁使用了Jedis的set方法，使得key不存在时才设置值以及给key设置过期时间是一个原子操作。在jedis新一点版本的set方法略有不同，NX和EX操作封装了个参数对象，大同小异。"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,aT]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aD}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aD]},children:[{type:b,tag:c,props:{className:[d,bY]},children:[{type:a,value:"lombok"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:"extern"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:"slf4j"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:"Slf4j"}]}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aD}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aD]},children:[{type:b,tag:c,props:{className:[d,bY]},children:[{type:a,value:jZ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:j_},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:do0},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:bZ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:j$},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:dp}]}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aD}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aD]},children:[{type:b,tag:c,props:{className:[d,bY]},children:[{type:a,value:jZ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:j_},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:do0},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:bZ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:j$},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:bO}]}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aD}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aD]},children:[{type:b,tag:c,props:{className:[d,bY]},children:[{type:a,value:bZ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:"clients"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:jY},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:bP}]}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:aA},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aD}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aD]},children:[{type:b,tag:c,props:{className:[d,bY]},children:[{type:a,value:ka},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:kb},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:cz}]}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aD}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aD]},children:[{type:b,tag:c,props:{className:[d,bY]},children:[{type:a,value:ka},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:kb},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:eR}]}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:aA},{type:b,tag:c,props:{className:[d,at,f]},children:[{type:a,value:i$}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ax}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bq}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:kc}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,cA,H]},children:[{type:a,value:"\u002F**\n     * key不存在时才设置值\n     *\u002F"}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aO}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:cs}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bn}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:a,value:" SET_IF_NOT_EXIST "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"NX\""}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:aJ},{type:b,tag:c,props:{className:[d,cA,H]},children:[{type:a,value:"\u002F**\n     * 过期时间单位标识，EX：秒\n     *\u002F"}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aO}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:cs}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bn}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:a,value:" SET_WITH_EXPIRE_TIME "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"EX\""}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aO}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:cs}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bn}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:a,value:" OK "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"OK\""}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aO}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:cs}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bn}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:"Long"}]},{type:a,value:" SUCCESS "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:"1L"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aO}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bn}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:bO}]},{type:b,tag:c,props:{className:[d,aL]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:bu},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aO}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bn}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:a,value:kd},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:aJ},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ax}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:kc}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:bO}]},{type:a,value:bu},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:fi}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:"redisTemplate "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:bu},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:fi}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:"instanceId "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:" UUID"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"randomUUID"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"toString"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:aJ},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ax}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aa}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:jQ}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:a,value:bb},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bo}]},{type:a,value:fj},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bc}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:ke},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:kf}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:aI}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:cB},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:kg}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:kh}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:aM},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:bN}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:bu},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:fk}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:dp}]},{type:b,tag:c,props:{className:[d,aL]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:fl}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:fm},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:fn}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:aM},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:bP}]},{type:a,value:fo},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:bP}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:fp},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:fq}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:aM},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:a,value:dq},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:fr},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bC}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:bm},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:kd},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:" SET_IF_NOT_EXIST"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:" SET_WITH_EXPIRE_TIME"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:fj},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:aM},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aa}]},{type:a,value:fs},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:" OK"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:ft}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:fu},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:cB},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bW}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"获取redis锁结果, key: {}, success: {}\""}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:bb},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:b_},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:aM},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:b_},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:aJ},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ax}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aa}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"renewLock"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:a,value:bb},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bo}]},{type:a,value:fj},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bc}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:ke},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:kf}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:aI}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:cB},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:kg}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:kh}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:aM},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:bN}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:bu},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:fk}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:dp}]},{type:b,tag:c,props:{className:[d,aL]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:fl}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:fm},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:fn}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:aM},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:bP}]},{type:a,value:fo},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:bP}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:fp},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:fq}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:aM},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:a,value:ki},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"if redis.call('get',KEYS[1]) ~= ARGV[1] then return 0 else return redis.call('expire',KEYS[1],ARGV[2]) end\""}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:aM},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:b$}]},{type:a,value:dq},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:fr},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:kj}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:cy},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:cz}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:dr}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:bm},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:cz}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:dr}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:kk},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"valueOf"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:"secondsToExpire"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:aM},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aa}]},{type:a,value:fs},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:kl},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:ft}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:fu},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:cB},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bW}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"更新redis锁结果, key: {}, success: {}\""}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:bb},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:b_},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:aM},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:b_},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:aJ},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ax}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aa}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:jV}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:a,value:bb},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:bu},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:fk}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:dp}]},{type:b,tag:c,props:{className:[d,aL]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:fl}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:fm},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:fn}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:aM},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:bP}]},{type:a,value:fo},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:bP}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:fp},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:fq}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:aM},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:a,value:ki},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"if redis.call('get',KEYS[1]) ~= ARGV[1] then return 1 else return redis.call('del',KEYS[1]) end\""}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:aM},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:b$}]},{type:a,value:dq},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:fr},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:kj}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:cy},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:cz}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:dr}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:bm},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:cz}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:dr}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:kk},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:aM},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aa}]},{type:a,value:fs},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:kl},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:ft}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:fu},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:cB},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bW}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"释放redis锁结果, key: {}, success: {}\""}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:bb},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:b_},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:aM},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:b_},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"这里再掰一下释放锁的lua脚本的逻辑。在网上我看到的释放锁的lua脚本都是这样的逻辑：只有key存在并且为当前节点所有时，才会去执行释放锁，否则一律失败。但假若一种情况，一个节点获取到锁，过期时间一分钟，但任务执行了五分钟，这时候key已经过期，实际上锁已经被这个节点释放了，但当走释放锁的逻辑却是失败的，有用什么意义呢。如果之后会以释放锁来分支做一些逻辑，那是做还是不做呢，这个实例是确确实实获取过锁，才走到这里的。"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,fv]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:km}]},{type:a,value:"我的脚本\n"},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bc}]},{type:a,value:ca},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bd}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:kn}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:cC},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ko}]},{type:a,value:kp},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:a,value:cb},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bG}]},{type:a,value:ds},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:a,value:cb},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:fw}]},{type:a,value:ds},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:ca},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bd}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:kq}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:cC},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:cb},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bH}]},{type:a,value:aA},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:km}]},{type:a,value:"importnew的脚本\n"},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bc}]},{type:a,value:ca},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bd}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:kn}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:cC},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:kr}]},{type:a,value:kp},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:a,value:cb},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bG}]},{type:a,value:ds},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:ca},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bd}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:kq}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:cC},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:cb},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:fw}]},{type:a,value:ds},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:aI}]},{type:a,value:cb},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bH}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:"分布式redis锁"},children:[{type:b,tag:j,props:{href:"#%E5%88%86%E5%B8%83%E5%BC%8Fredis%E9%94%81",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"分布式Redis锁"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"上面的redis锁是基于单个主节点的，如果主节点宕机进行了选举，新的主节点不一定能把锁的key同步，就可能会导致有两个实例获取到锁。"}]},{type:a,value:e},{type:b,tag:$,props:{id:jM},children:[{type:b,tag:j,props:{href:"#redlock",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:jN}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"所以在redis集群里，有N个（例如5个）独立的主节点，可以使用Redlock（红锁）算法。"}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"获取当前时间戳作为开始时间戳"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"依次向全部主节点加锁。每次加锁请求都需要设置超时时间，并且超时时间应该远远短于锁的有效时间"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"如果获取到了过半数主节点的锁，并且当前时间减去开始时间戳小于锁有效时间，即锁还没过期，则获取锁成功。这样子锁的实际有效时间就是距离锁过期剩下的时间了"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"如果没能获取过半锁，或者遍历完全部主节点后锁已经过期了，则向全部主节点解锁，稍等一段随机时间再重试"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:"redlock的问题"},children:[{type:b,tag:j,props:{href:"#redlock%E7%9A%84%E9%97%AE%E9%A2%98",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"Redlock的问题"}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"宕机问题：实例1拿到ABC三个锁，之后C宕机选举了，新C的锁丢了，实例2拿到了CDE三个锁，那就有两个实例拿到锁了"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"停顿问题：实例1拿到了锁，之后经历了很长的GC，长到锁过期了，之后实例2拿到了锁，但实例1从GC醒来的时候还以为只有自己有锁"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"时间问题：实例1拿到了ABC三个锁，C的时间出了问题导致锁提前过期，实例2拿到了CDE的锁"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:ks},children:[{type:b,tag:j,props:{href:"#redis%E8%AE%A1%E6%95%B0%E5%99%A8",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:ks}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"redis计数器就很简单了，直接redisTemplate就能调用，返回的是加一之后的值。"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,aT]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:jR}]},{type:a,value:" increase "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:bu},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:jU}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"increment"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:bm},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:" delta"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fblog.csdn.net\u002FMuscleheng\u002Farticle\u002Fdetails\u002F103052584",rel:[A,B,C],target:D},children:[{type:a,value:"SpringBoot Redis实现分布式锁"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fmy.oschina.net\u002Fdengfuwei\u002Fblog\u002F1600681",rel:[A,B,C],target:D},children:[{type:a,value:"spring boot redis分布式锁"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fcloud.tencent.com\u002Fdeveloper\u002Farticle\u002F1353616",rel:[A,B,C],target:D},children:[{type:a,value:"Redis分布式锁的正确实现方式（Java版）"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fbenjaminwhx.com\u002F2018\u002F08\u002F26\u002FRedis%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E7%9A%84%E6%AD%A3%E7%A1%AE%E5%AE%9E%E7%8E%B0%E5%A7%BF%E5%8A%BF\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"Redis分布式锁的正确实现姿势"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fcrossoverjie.top\u002F2018\u002F03\u002F29\u002Fdistributed-lock\u002Fdistributed-lock-redis\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"基于 Redis 的分布式锁"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fjuejin.im\u002Fpost\u002F5e6727e16fb9a07cc845b9ba",rel:[A,B,C],target:D},children:[{type:a,value:"基于Redis实现分布式锁之前，这些坑你一定得知道"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fblog.wangqi.love\u002Farticles\u002Fdistributed\u002FRedlock%E7%AE%97%E6%B3%95.html",rel:[A,B,C],target:D},children:[{type:a,value:"Redlock算法"}]}]}]},excerpt:{type:S,children:[{type:b,tag:i,props:{},children:[{type:a,value:fh}]}]},dir:kt,path:"\u002F中间件\u002F20200416\u002Fredis锁与redis计数器",extension:ap,title:jK,url:"\u002Fblog-code\u002Fview\u002F$E4$B8$AD$E9$97$B4$E4$BB$B6\u002F20200416\u002Fredis$E9$94$81$E4$B8$8Eredis$E8$AE$A1$E6$95$B0$E5$99$A8\u002F",createAt:new Date(1586995200000),updateAt:new Date(1586995200000),attributes:[{name:aq,value:ku},{name:ar,value:ku},{name:as,value:kt,url:"\u002Fblog-code\u002Fpage\u002F$E4$B8$AD$E9$97$B4$E4$BB$B6\u002F20200416\u002F1\u002F"}]},{slug:kv,description:fx,createdAt:kw,updatedAt:kw,toc:[],body:{type:S,children:[{type:b,tag:i,props:{},children:[{type:a,value:fx}]},{type:a,value:e},{type:a,value:e},{type:b,tag:w,props:{id:kx},children:[{type:b,tag:j,props:{ariaHidden:q,href:"#%E5%B0%86%E4%B8%80%E4%B8%AA%E8%A7%86%E9%A2%91%E8%BD%AC%E4%B8%BA%E5%A4%9A%E5%BC%A0%E5%9B%BE%E7%89%87",tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:kx}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"-vf：为图片添加水印，字体大小15，颜色灰色，时间格式hms"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"-r：每秒取五张截图"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"-q:v：生成的图片质量（好像）"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"-f：输出的图片格式，可忽略"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[cx,P]},children:[{type:b,tag:y,props:{},children:[{type:a,value:ky},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-i "},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"input.mp4\""}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-vf "},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"drawtext=fontsize=15:fontcolor=gray:text='%{pts\\:hms}'\""}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:fy},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:fz}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-q:v "},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:av}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-f image2 "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"images\u002F%05d.jpeg\""}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:kz},children:[{type:b,tag:j,props:{ariaHidden:q,href:"#%E5%B0%86%E4%B8%80%E4%B8%AA%E5%9B%BE%E7%89%87%E8%BD%AC%E4%B8%BA%E8%A7%86%E9%A2%91",tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:kz}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"这样子视频只有一帧"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[cx,P]},children:[{type:b,tag:y,props:{},children:[{type:a,value:"ffmpeg -i input.jpg output.mp4\n"}]}]}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"-r :读取输入文件的时候帧率为25帧每秒"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"-loop：循环读取input文件"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"-vcodec：视频编码为H264（我猜）"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"-s：视频的像素，好像要求高和宽都是偶数"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"-t：视频长度为10秒"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[cx,P]},children:[{type:b,tag:y,props:{},children:[{type:a,value:ky},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-i input.jpg "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:fy},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:fA}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-loop "},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-pix_fmt yuv420p "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-vcodec libx264 "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-b:v 600k "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-r:v "},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:fA}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-preset medium "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-crf "},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:"30"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-s 2728x3016 "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-vframes "},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:"250"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:fy},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:fA}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n-t "},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:ba}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\noutput.mp4\n"}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:kA},children:[{type:b,tag:j,props:{ariaHidden:q,href:"#%E8%BD%AC%E4%B8%BA%E9%9F%B3%E9%A2%91",tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:kA}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"-ac：音轨数量"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[cx,P]},children:[{type:b,tag:y,props:{},children:[{type:a,value:"ffmpeg -i video.mkv -ac "},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:av}]},{type:a,value:" audio.wav\n"}]}]}]}]},excerpt:{type:S,children:[{type:b,tag:i,props:{},children:[{type:a,value:fx}]}]},dir:kB,path:"\u002F折腾\u002F20200422\u002Fffmpeg参数备忘",extension:ap,title:kv,url:"\u002Fblog-code\u002Fview\u002F$E6$8A$98$E8$85$BE\u002F20200422\u002Fffmpeg$E5$8F$82$E6$95$B0$E5$A4$87$E5$BF$98\u002F",createAt:new Date(1587513600000),updateAt:new Date(1587513600000),attributes:[{name:aq,value:kC},{name:ar,value:kC},{name:as,value:kB,url:"\u002Fblog-code\u002Fpage\u002F$E6$8A$98$E8$85$BE\u002F20200422\u002F1\u002F"}]},{slug:kD,description:"自己用keras写了个VAE自编码器，用的是mnist数据集。参考了《Python深度学习》_2018中文版.pdf和深度学习第52讲：变分自编码器VAE原理以及keras实现里的实现\n用CPU跑真是慢死了，人生苦短，莫得N卡.\n调参调了一整天，噫吁嚱。",createdAt:kE,updatedAt:kE,toc:[],body:{type:S,children:[{type:b,tag:i,props:{},children:[{type:a,value:kF},{type:b,tag:j,props:{href:kG,rel:[A,B,C],target:D},children:[{type:a,value:kH}]},{type:a,value:kI}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:kJ}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:kK}]},{type:a,value:e},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:["language-python",P]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aD}]},{type:a,value:" keras\n"},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aD}]},{type:a,value:" matplotlib"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:"pyplot "},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:cD}]},{type:a,value:" plt\n"},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aD}]},{type:a,value:" numpy "},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:cD}]},{type:a,value:" np\n"},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aV}]},{type:a,value:kL},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aD}]},{type:a,value:fB},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:" Model\n"},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aV}]},{type:a,value:kL},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aD}]},{type:a,value:" backend "},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:cD}]},{type:a,value:" K\n"},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aV}]},{type:a,value:cE},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:"callbacks "},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aD}]},{type:a,value:" EarlyStopping\n"},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aV}]},{type:a,value:cE},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:"datasets "},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aD}]},{type:a,value:" mnist\n"},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aV}]},{type:a,value:cE},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:"engine"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:"saving "},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aD}]},{type:a,value:" load_model\n"},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aV}]},{type:a,value:cE},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:"layers "},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aD}]},{type:a,value:dt},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:kM},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:cF},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:kN},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:kO},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:" Conv2DTranspose\n"},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aV}]},{type:a,value:" scipy"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:"stats "},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aD}]},{type:a,value:" norm\n\ninput_shape "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:fC}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:fC}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:"\nbatch_size "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:du}]},{type:a,value:"\nlatent_dim "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:av}]},{type:a,value:cc},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bp}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"get_data"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ao}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:dv},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:kP},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:dw},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:kP},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:" mnist"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:"load_data"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:fD},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:cd},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:kQ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:kR}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ce}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:kS}]},{type:a,value:fE},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:cG},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:kQ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:kR}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ce}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:kS}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 数据集本来是(None,28,28)的结构的，把它整成图片的三维(None,28,28,1)"}]},{type:a,value:fD},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:cd},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:dx},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:dv},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:bv},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:aI}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aB}]},{type:a,value:kT},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:fE},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:cG},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:dx},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:dw},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:bv},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:aI}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aB}]},{type:a,value:kT},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:fD},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:kU},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:dv},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:fE},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:kU},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:dw},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:kV}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'x_train.shape'"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:cd},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:bv},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:kV}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'x_test.shape'"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:cG},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:bv},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:cd},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:" x_test\n\n\n"},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bp}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"random_data"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:do0},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ao}]},{type:a,value:"\n    indexs "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:dy},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:"arange"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:do0},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:bv},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:aI}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:"\n    np"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:"random"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:"shuffle"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:kW},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:" data"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:a,value:kW},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:a,value:cc},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bp}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"create_model"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ao}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 这里的卷积层步长为2，用来缩小下一层的图片大小"}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 我试了一下用池化替代步长，感觉没有步长效果好，但只是感觉"}]},{type:a,value:"\n    conv2D_layer1 "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:dt},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:du}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:bh}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:dz},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:dA}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:cf},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:cH}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:fF},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:av}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:av}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# max_pool_layer1 = MaxPooling2D(2, 2)"}]},{type:a,value:"\n    conv2D_layer2 "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:dt},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:fG}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:bh}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:dz},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:dA}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:cf},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:cH}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:fF},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:av}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:av}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# max_pool_layer2 = MaxPooling2D(2, 2)"}]},{type:a,value:"\n    flatten_layer "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:kM},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 将卷积层摊平后最好加个全连接层映射一下，效果会有比较明显的提升"}]},{type:a,value:"\n    dense_layer1 "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:cF},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:fG}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:cf},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:cH}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 将全连接层分别映射到正态分布的均值和方差，这里的正态分布是二维的，所以latent_dim取2"}]},{type:a,value:"\n    mean_layer "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:cF},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:fH},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:"\n    variance_layer "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:cF},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:fH},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:aJ},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 通过均值和方差，算一个小小的偏移均值的张量"}]},{type:a,value:"\n    lambda_layer "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:kN},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:kX},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:" output_shape"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:fH},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:aJ},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 将小小的偏移均值的张量这个潜空间的点映射为全连接"}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 这里的14是取28的一半，方便在Conv2DTranspose层里放大一倍"}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 调参的时候发现loss一直卡在0.26下不去，发现是这层的特征通过太少(我一开始填了1)。要起码增大到32，64效果比较好"}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 这里的np.prod(hide_shape)本来是想跟dense_layer1一致的，感觉对称或许会更好"}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 但为了减少Conv2DTranspose层，意味着hide_shape要足够大，导致dense_layer1的参数暴增"}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 现在抛开对称，dense_layer1特征少，通过均值和方差的两特征，这里映射为(14, 14, 64)这个多特征，还真是有点神奇"}]},{type:a,value:"\n    hide_shape "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:kY}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:kY}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:fG}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:"\n    dense_layer2 "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:cF},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:fI},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:"prod"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:kZ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:cf},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:cH}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:"\n    reshape_layer "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:kO},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:kZ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 用Conv2DTranspose层里放大一倍，步长我设置过为4，loss会更糟，出来的图片还是锐利的，但是明显变得大色块"}]},{type:a,value:"\n    conv2DTranspose_layer1 "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:" Conv2DTranspose"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:du}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:bh}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:dz},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:dA}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:cf},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:cH}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:fF},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:av}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:av}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 最后加个卷积层拍扁一下特征数，变为1。"}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 其中卷积核大小我试过改为2、3、4、5，效果感觉为越大越好，但其实差别不大"}]},{type:a,value:"\n    conv2D_layer4 "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:dt},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:fz}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:dz},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:dA}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:cf},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'sigmoid'"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 计算损失的层"}]},{type:a,value:"\n    vae_loss_layer "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:k_},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:k$},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:fB},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:bv},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:"input_shape"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:aP},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:fJ},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:la},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:aF},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:lb}]},{type:a,value:aP},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:lc},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:aF},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:ld}]},{type:a,value:aP},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:le},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:aF},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:aP},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:lf},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:aF},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:"\n    mean_output_tensor "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:lg},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:aF},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:"\n    variance_output_tensor "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:" variance_layer"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:aF},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:fK},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:" lambda_layer"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:a,value:fL},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:fM},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:fK},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:lh},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:aF},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:aP},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:li},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:aF},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:aP},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:lj},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:aF},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:aP},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:lk},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:aF},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:aP},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:" vae_loss_layer"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:a,value:bI},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:cg},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:fN},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:fM},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:"\n\n    vae "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:fO},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:bI},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:cg},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 模型名字貌似不能用中文，否则在h5文件里恢复模型的时候会报错"}]},{type:a,value:cI},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:dh},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'vae'"}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 这里可以使用add_loss方法替换vae_loss_layer，但是我试过，这样的话，在h5文件里恢复模型的时候会报错"}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# vae.add_loss(create_vae_loss_tensor(input_tensor, output_tensor, mean_output_tensor, variance_output_tensor))"}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 已经在损失层里计算损失了，所以loss=None"}]},{type:a,value:cI},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,aw]},children:[{type:a,value:"compile"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:"optimizer"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'adam'"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:ll},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:fP}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:cI},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:ch},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:fK},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:fJ},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:la},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:aF},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:lb}]},{type:a,value:aP},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:lc},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:aF},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:ld}]},{type:a,value:aP},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:le},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:aF},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:aP},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:lf},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:aF},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:"\n    mean_output_layer "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:lg},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:aF},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:lm},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:fO},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:bI},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:" mean_output_layer"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:dB},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:dh},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'encoder'"}]},{type:a,value:dB},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:ch},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:k$},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:fB},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:bv},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:"lambda_layer"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:"output_shape"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ao}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:aP},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:fJ},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:lh},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:aF},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:aP},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:li},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:aF},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:aP},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:lj},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:aF},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:aP},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:lk},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:aF},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:ln},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:fO},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:bI},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:cg},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:dC},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:dh},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'decoder'"}]},{type:a,value:dC},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:ch},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:aJ},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:lo},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:ci},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:lp},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bp}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"create_vae_loss_tensor"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:bI},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:cg},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:fN},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:fM},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ao}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 要把输入张量与输出张量摊平，才能使用binary_crossentropy方法来计算损失"}]},{type:a,value:"\n    input_tensor "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:bJ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:lq},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:bI},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:aP},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:bJ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:lq},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:aF},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:"\n    xent_loss_tensor "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:cE},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:"metrics"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:"binary_crossentropy"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:bI},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:cg},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# K.mean可以使用K.sum来替换，使用K.sum的话，把参数-5e-4改为-0.5就好，按道理应该不会对效果参数影响"}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 上面的xent_loss_tensor是计算输入输出直接的损失，这步应该是用来计算那个正态分布的损失"}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 这里这步计算没看懂，既然K.mean并不重要，那么K.mean里面的才是精髓"}]},{type:a,value:"\n    kl_loss_tensor "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:a$}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:"5e-4"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aQ}]},{type:a,value:bJ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:lr},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aB}]},{type:a,value:ls},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:a$}]},{type:a,value:bJ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:"square"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:fL},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:a$}]},{type:a,value:bJ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:lt},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:lu},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:" axis"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:a$}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 然后把两个损失算个平均值一下作为总损失"}]},{type:a,value:"\n    vae_loss_tensor "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:bJ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:lr},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:"xent_loss_tensor "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aB}]},{type:a,value:" kl_loss_tensor"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:" vae_loss_tensor\n\n\n"},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bq}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:"VaeLossLayer"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:"keras"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:"layers"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:"Layer"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ao}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,"triple-quoted-string",z]},children:[{type:a,value:"\"\"\"建一个自定义层用来计算损失\"\"\""}]},{type:a,value:aJ},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bp}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bd}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:"self"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:cj},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ao}]},{type:a,value:"\n        input_tensor "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:cj},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:aI}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:a,value:"\n        output_tensor "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:cj},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:a,value:"\n        mean_output_tensor "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:cj},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:av}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:a,value:"\n        variance_output_tensor "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:cj},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:bh}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:a,value:"\n        vae_loss_tensor "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:" create_vae_loss_tensor"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:bI},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:cg},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:fN},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:"\n                                                 variance_output_tensor"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 这里设置损失，至于inputs有什么用，不是很清楚"}]},{type:a,value:"\n        self"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:"add_loss"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:"vae_loss_tensor"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:cj},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:"inputs"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 这里返回的input_tensor貌似是没有被使用，但是好像说是一定需要返回一个张量，所以就(随便?)返回了input_tensor"}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:" input_tensor\n\n\n"},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bp}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:kX}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:"args"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ao}]},{type:a,value:"\n    mean_output_tensor"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:ls},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:" args\n    "},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 以mean_output_tensor的结构，整一个很小的ε张量"}]},{type:a,value:"\n    epsilon_tensor "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:bJ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:"random_normal"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:bv},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:"K"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:bv},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:fL},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:aI}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:lv},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:" mean"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:"0."}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:" stddev"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:"1."}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 将ε乘以方差加上均值，做小小的偏移均值的张量（还是说其实variance_output_tensor应该是标准差才对？）"}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:" mean_output_tensor "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aB}]},{type:a,value:bJ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:lt},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:lu},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aQ}]},{type:a,value:" epsilon_tensor\n\n\n"},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bp}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:lw}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:lx},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:cd},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:cG},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ao}]},{type:a,value:"\n    early_stopping "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:" EarlyStopping"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:fQ},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:fR}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:" patience"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:av}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:fS},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:lw},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:"\n        x"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:dv},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:"\n        y"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:fP}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:"\n        shuffle"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:"True"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:"\n        epochs"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:ba}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:"\n        batch_size"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:fT},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:"\n        validation_data"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:dw},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:fP}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:"\n        callbacks"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:a,value:"early_stopping"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:cc},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bp}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"save_h5"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:ly},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:ci},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:fS},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ao}]},{type:a,value:dB},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:fU},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:lz}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:dC},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:fU},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:lA}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:cI},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:fU},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:lB}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:cc},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bp}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"load_h5"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ao}]},{type:a,value:lm},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:fV},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:lz}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:ln},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:fV},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:lA}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# latent_dim和VaeLossLayer会在加载模型的时候用到"}]},{type:a,value:"\n    vae "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:fV},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:lB}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:" custom_objects"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'latent_dim'"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ao}]},{type:a,value:lv},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'VaeLossLayer'"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ao}]},{type:a,value:k_},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:dB},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:ch},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:dC},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:ch},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:cI},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:ch},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:lo},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:ci},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:lp},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bp}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"show_result"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:lC},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ao}]},{type:a,value:"\n    n "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:"15"}]},{type:a,value:"\n    digit_size "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:fC}]},{type:a,value:"\n    figure "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:dy},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:"zeros"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:"digit_size "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aQ}]},{type:a,value:bQ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:" digit_size "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aQ}]},{type:a,value:bQ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:"\n    grid_x "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:lD},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:lE},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:fI},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:lF},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:lG}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:lH}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:bQ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:"\n    grid_y "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:lD},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:lE},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:fI},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:lF},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:lG}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:lH}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:bQ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:aJ},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:eQ}]},{type:a,value:bR},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:" yi "},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bE}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aw]},children:[{type:a,value:lI}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:"grid_x"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ao}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:eQ}]},{type:a,value:" j"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:" xi "},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bE}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aw]},children:[{type:a,value:lI}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:"grid_y"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ao}]},{type:a,value:lJ},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:dy},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:"array"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:a,value:"xi"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:" yi"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:lJ},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:dy},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:"tile"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:lK},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:lL},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:dx},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:fT},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:av}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:"\n            x_decoded "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:ci},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:"predict"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:lK},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:lL},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:fT},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:"\n            digit "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:" x_decoded"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:aI}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:dx},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:"digit_size"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:cJ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:"\n            figure"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:a,value:lM},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aQ}]},{type:a,value:cJ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ao}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:lM},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aB}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aQ}]},{type:a,value:cJ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:" j "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aQ}]},{type:a,value:cJ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ao}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:"j "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aB}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aQ}]},{type:a,value:cJ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:" digit\n\n    plt"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:fW},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:"figsize"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:ba}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:ba}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:lN},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:"imshow"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:fW},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:" cmap"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'Greys_r'"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:lN},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:cN},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:cc},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bp}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"show_fit"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:bK},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ao}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bc}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:lO}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bE}]},{type:a,value:bL},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:lP},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:lQ}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:lR}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bE}]},{type:a,value:bL},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:bK},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ao}]},{type:a,value:"\n        acc "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:bL},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:bK},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:lO}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:a,value:"\n        val_acc "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:bL},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:bK},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:lR}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:a,value:lS},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aw]},children:[{type:a,value:fX}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aw]},children:[{type:a,value:fY}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:"acc"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aB}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:bw},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:dD},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:dE},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:" acc"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:lT}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:dF},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'Training acc'"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:bw},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:dD},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:dE},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:" val_acc"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:lU}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:dF},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'Validation acc'"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:bw},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:lV},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'Training and validation accuracy'"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:bw},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:lW},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:aJ},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bc}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:lX}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bE}]},{type:a,value:bL},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:lP},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:lQ}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:fR}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bE}]},{type:a,value:bL},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:bK},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ao}]},{type:a,value:"\n        loss "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:bL},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:bK},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:lX}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:a,value:"\n        val_loss "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:bL},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:bK},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:fR}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:a,value:lS},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aw]},children:[{type:a,value:fX}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aw]},children:[{type:a,value:fY}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:"loss"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aB}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:bw},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:fW},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:bw},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:dD},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:dE},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:ll},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:lT}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:dF},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'Training loss'"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:bw},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:dD},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:dE},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:" val_loss"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:lU}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:dF},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'Validation loss'"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:bw},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:lV},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'Training and validation loss'"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:bw},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:lW},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:"\n\n    plt"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:cN},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:cc},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# CPU每轮迭代大约一分多钟，第一轮loss会跌到0.22，第二次会跌到0.19，迭代两轮结果已经有模有样"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 迭代个10次就差不多了，三十次左右开始过拟合"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 数据集比较简单，模型行不行，迭代两轮看能不能跌倒0.20就知道了"}]},{type:a,value:"\nx_train"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:" x_test "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:" get_data"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:"\nencoder"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:ci},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:" vae "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:" create_model"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:"\nhistory "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:" fit"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:lx},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:cd},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:cG},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:"\nsave_h5"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:ly},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:ci},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:fS},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:"\nshow_result"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:lC},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:"\nshow_fit"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:bK},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:aA}]}]}]}]},excerpt:{type:S,children:[{type:b,tag:i,props:{},children:[{type:a,value:kF},{type:b,tag:j,props:{href:kG,rel:[A,B,C],target:D},children:[{type:a,value:kH}]},{type:a,value:kI}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:kJ}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:kK}]}]},dir:lY,path:"\u002F算法\u002F20200430\u002Fkeras实现mnist数据集的VEA模型",extension:ap,title:kD,url:"\u002Fblog-code\u002Fview\u002F$E7$AE$97$E6$B3$95\u002F20200430\u002Fkeras$E5$AE$9E$E7$8E$B0mnist$E6$95$B0$E6$8D$AE$E9$9B$86$E7$9A$84VEA$E6$A8$A1$E5$9E$8B\u002F",createAt:new Date(1588204800000),updateAt:new Date(1588204800000),attributes:[{name:aq,value:lZ},{name:ar,value:lZ},{name:as,value:lY,url:"\u002Fblog-code\u002Fpage\u002F$E7$AE$97$E6$B3$95\u002F20200430\u002F1\u002F"}]},{slug:l_,description:ab,createdAt:l$,updatedAt:l$,toc:[],body:{type:S,children:[{type:a,value:e},{type:b,tag:w,props:{id:ma},children:[{type:b,tag:j,props:{href:"#%E6%9B%B4%E6%96%B0%E6%BA%90",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:ma}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[Z,P]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:fZ}]},{type:a,value:" \u002Fetc\u002Fapt\u002Fsources.list \u002Fetc\u002Fapt\u002Fsources.list.back\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:h_}]},{type:a,value:" \u002Fetc\u002Fapt\u002Fsources.list\n\n"},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释"}]},{type:a,value:"\ndeb https:\u002F\u002Fmirrors.tuna.tsinghua.edu.cn\u002Fubuntu\u002F bionic main restricted universe multiverse\n"},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# deb-src https:\u002F\u002Fmirrors.tuna.tsinghua.edu.cn\u002Fubuntu\u002F bionic main restricted universe multiverse"}]},{type:a,value:"\ndeb https:\u002F\u002Fmirrors.tuna.tsinghua.edu.cn\u002Fubuntu\u002F bionic-updates main restricted universe multiverse\n"},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# deb-src https:\u002F\u002Fmirrors.tuna.tsinghua.edu.cn\u002Fubuntu\u002F bionic-updates main restricted universe multiverse"}]},{type:a,value:"\ndeb https:\u002F\u002Fmirrors.tuna.tsinghua.edu.cn\u002Fubuntu\u002F bionic-backports main restricted universe multiverse\n"},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# deb-src https:\u002F\u002Fmirrors.tuna.tsinghua.edu.cn\u002Fubuntu\u002F bionic-backports main restricted universe multiverse"}]},{type:a,value:"\ndeb https:\u002F\u002Fmirrors.tuna.tsinghua.edu.cn\u002Fubuntu\u002F bionic-security main restricted universe multiverse\n"},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# deb-src https:\u002F\u002Fmirrors.tuna.tsinghua.edu.cn\u002Fubuntu\u002F bionic-security main restricted universe multiverse"}]},{type:a,value:aA},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 预发布软件源，不建议启用"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# deb https:\u002F\u002Fmirrors.tuna.tsinghua.edu.cn\u002Fubuntu\u002F bionic-proposed main restricted universe multiverse"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# deb-src https:\u002F\u002Fmirrors.tuna.tsinghua.edu.cn\u002Fubuntu\u002F bionic-proposed main restricted universe multiverse"}]},{type:a,value:aA},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bf}]},{type:a,value:" update -y\n"}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:mb},children:[{type:b,tag:j,props:{href:"#%E6%90%9C%E7%8B%97%E8%BE%93%E5%85%A5%E6%B3%95",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:mb}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:hO}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[Z,P]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aN}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aE}]},{type:a,value:" -y fcitx-bin\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aN}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aE}]},{type:a,value:" -y fcitx-table\nim-config -n fcitx\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:cr}]},{type:a,value:aA},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:" dpkg -i 软件包名.deb\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aN}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aE}]},{type:a,value:" -f\nfcitx-config-gtk3\n"}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"候选框乱码"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[Z,P]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 删除搜狗拼音的配置文件"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:hy}]},{type:a,value:" -rf ~\u002F.config\u002FSogouPY ~\u002F.config\u002Fsogou*\n\n"},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 重启fcitx"}]},{type:a,value:"\npidof fcitx\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"kill"}]},{type:a,value:" pid\nfcitx\n"}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:dG},children:[{type:b,tag:j,props:{href:mc,ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:dG}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:md}]},{type:a,value:e},{type:b,tag:w,props:{id:"n卡驱动"},children:[{type:b,tag:j,props:{href:"#n%E5%8D%A1%E9%A9%B1%E5%8A%A8",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"N卡驱动"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:md}]},{type:a,value:e},{type:b,tag:w,props:{id:me},children:[{type:b,tag:j,props:{href:"#%E5%85%B6%E4%BB%96%E8%BD%AF%E4%BB%B6",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:me}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[Z,P]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aN}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aE}]},{type:a,value:" -y guake\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bf}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aE}]},{type:a,value:" -y mpv\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aN}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aE}]},{type:a,value:" -y "},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"htop"}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:mf},children:[{type:b,tag:j,props:{href:"#gnome-tweak",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:mf}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[Z,P]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bf}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aE}]},{type:a,value:" -y gnome-tweak-tool\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aN}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aE}]},{type:a,value:" chrome-gnome-shell\n"}]}]}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"天气："},{type:b,tag:j,props:{href:mg,rel:[A,B,C],target:D},children:[{type:a,value:mg}]}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"系统监控："},{type:b,tag:j,props:{href:mh,rel:[A,B,C],target:D},children:[{type:a,value:mh}]}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"系统监控依赖："},{type:b,tag:y,props:{},children:[{type:a,value:"sudo apt install gir1.2-gtop-2.0 gir1.2-nm-1.0 gir1.2-clutter-1.0"}]}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"截图："},{type:b,tag:j,props:{href:mi,rel:[A,B,C],target:D},children:[{type:a,value:mi}]}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"N卡监控："},{type:b,tag:j,props:{href:mj,rel:[A,B,C],target:D},children:[{type:a,value:mj}]}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"拓展更新"},{type:b,tag:j,props:{href:mk,rel:[A,B,C],target:D},children:[{type:a,value:mk}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:ml},children:[{type:b,tag:j,props:{href:"#%E5%AD%97%E4%BD%93",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:ml}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[Z,P]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 新建一个目录，将字体文件复制到该文件夹下"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"mkdir"}]},{type:a,value:" -p \u002Fusr\u002Fshare\u002Ffonts\u002Fwin\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:fZ}]},{type:a,value:" \u002Fmedia\u002Fmeltsprout\u002FC6BC4A30BC4A1B77\u002FWindows\u002FFonts\u002F*.ttf \u002Fusr\u002Fshare\u002Ffonts\u002Fwin\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:fZ}]},{type:a,value:" \u002Fmedia\u002Fmeltsprout\u002FC6BC4A30BC4A1B77\u002FWindows\u002FFonts\u002F*.ttc \u002Fusr\u002Fshare\u002Ffonts\u002Fwin\n\n"},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 在该文件夹下执行"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,aw,E]},children:[{type:a,value:mm}]},{type:a,value:mn},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:ir}]},{type:a,value:" -R "},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:"644"}]},{type:a,value:mn},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:" mkfontscale\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:" mkfontdir\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:" fc-cache -fv\n\n"},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 重启"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:cr}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:al},children:[{type:b,tag:j,props:{href:"#docker",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:al}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[Z,P]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:hR}]},{type:a,value:hS},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:hT}]},{type:a,value:hU},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:" systemctl "},{type:b,tag:c,props:{className:[d,aw,E]},children:[{type:a,value:"enable"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:" systemctl start "},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bl}]},{type:a,value:" \u002Fetc\u002Fdocker\u002Fdaemon.json\n"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:cp},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"registry-mirrors\""}]},{type:b,tag:c,props:{className:[d,aw,E]},children:[{type:a,value:ao}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"https:\u002F\u002Fhub-mirror.c.163.com\""}]},{type:a,value:",\n    "},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"\"https:\u002F\u002Fmirror.baidubce.com\""}]},{type:a,value:cp},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:a,value:eP},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:if0}]},{type:b,tag:c,props:{className:[d,aw,E]},children:[{type:a,value:ao}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:ig}]},{type:a,value:eP},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:ih}]},{type:b,tag:c,props:{className:[d,aw,E]},children:[{type:a,value:ao}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:ii}]},{type:b,tag:c,props:{className:[d,aw,E]},children:[{type:a,value:ao}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:ij}]},{type:a,value:ik},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:il}]},{type:b,tag:c,props:{className:[d,aw,E]},children:[{type:a,value:ao}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:im}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:in0},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:io},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:iu},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:" run -d --name portainer --restart"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:jB},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:iv}]},{type:a,value:":8000 -p "},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:iw}]},{type:a,value:":9000 -v \u002Fvar\u002Frun\u002Fdocker.sock:\u002Fvar\u002Frun\u002Fdocker.sock -v portainer_data:\u002Fdata portainer\u002Fportainer:latest\n"}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:mo},children:[{type:b,tag:j,props:{href:"#%E4%B8%BB%E9%A2%98",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:mo}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[Z,P]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bf}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aE}]},{type:a,value:" -y arc-theme\n\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:" add-apt-repository ppa:numix\u002Fppa\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bf}]},{type:a,value:eL},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bf}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aE}]},{type:a,value:" -y numix-icon-theme-circle\n"}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:mp},children:[{type:b,tag:j,props:{href:"#%E8%AE%BE%E7%BD%AE%E7%A1%AC%E4%BB%B6%E6%97%B6%E9%97%B4%E4%B8%BA%E6%9C%AC%E5%9C%B0%E6%97%B6%E9%97%B4",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:mp}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[Z,P]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:" hwclock --localtime --systohc\n\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aN}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aE}]},{type:a,value:" ntpdate\n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:" ntpdate "},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:aI}]},{type:a,value:".cn.pool.ntp.org\n"}]}]}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"0.cn.pool.ntp.org"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"1.cn.pool.ntp.org"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"2.cn.pool.ntp.org"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"3.cn.pool.ntp.org"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:"host"},children:[{type:b,tag:j,props:{href:"#host",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"Host"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:j,props:{href:mq,rel:[A,B,C],target:D},children:[{type:a,value:mq}]}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:j,props:{href:mr,rel:[A,B,C],target:D},children:[{type:a,value:mr}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:ms},children:[{type:b,tag:j,props:{href:"#shell",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:ms}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:dH,rel:[A,B,C],target:D},children:[{type:a,value:dH}]}]},{type:a,value:e},{type:b,tag:w,props:{id:mt},children:[{type:b,tag:j,props:{href:"#grub%E5%90%AF%E5%8A%A8",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:mt}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[Z,P]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bl}]},{type:a,value:" \u002Fetc\u002Fdefault\u002Fgrub\n\n"},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:a,value:"GRUB_DEFAULT"}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:av}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:a,value:"GRUB_TIMEOUT_STYLE"}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:"hidden\n"},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:a,value:"GRUB_TIMEOUT"}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:bh}]},{type:a,value:aA},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"update-grub"}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:mu},children:[{type:b,tag:j,props:{href:"#zsh",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:mu}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:dH,rel:[A,B,C],target:D},children:[{type:a,value:dH}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"字体乱码："},{type:b,tag:j,props:{href:mv,rel:[A,B,C],target:D},children:[{type:a,value:mv}]}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[Z,P]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:iz}]},{type:a,value:" clone https:\u002F\u002Fgithub.com\u002Fpowerline\u002Ffonts\n"},{type:b,tag:c,props:{className:[d,aw,E]},children:[{type:a,value:mm}]},{type:a,value:" ~\u002Ffonts\n.\u002Finstall.sh\n"}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"然后在配置终端，依次选择“编辑”-\u003E“配置文件首选项”，选择“自定义字体”，字体为“Ubuntu Mono derivative Powerline Regular”即可。"}]},{type:a,value:e},{type:b,tag:w,props:{id:mw},children:[{type:b,tag:j,props:{href:"#%E6%88%AA%E5%9B%BE",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:mw}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[Z,P]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bf}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:aE}]},{type:a,value:" flameshot\n\n"},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 快捷键启动截图"}]},{type:a,value:"\nflameshot gui\n"}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:"微信qq"},children:[{type:b,tag:j,props:{href:"#%E5%BE%AE%E4%BF%A1qq",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"微信QQ"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[Z,P]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"# 微信里的net=\"host\"，本来是为了能进行聊天记录备份。但发现备份会导致卡死"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:bg},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n  --name wechat "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:mx},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:my},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:f_}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n  --net"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:f_}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:mz},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n  -v ~\u002Fwechat\u002FWeChatFiles:\u002FWeChatFiles "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aW},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:mA}]}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:mB},{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:mC}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aW},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:mD}]}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:mE},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:ck},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aW},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:a,value:mF}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:ck},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aW},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:a,value:mG}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:ck},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aW},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:a,value:mH}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,Q]},children:[{type:a,value:bD}]},{type:a,value:mI},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:c_}]},{type:a,value:f$},{type:b,tag:c,props:{className:[d,Q]},children:[{type:a,value:m}]}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aW},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:a,value:mJ}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,Q]},children:[{type:a,value:bD}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bS}]},{type:a,value:mK},{type:b,tag:c,props:{className:[d,Q]},children:[{type:a,value:m}]}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aW},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:mL}]}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,Q]},children:[{type:a,value:bD}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bS}]},{type:a,value:mM},{type:b,tag:c,props:{className:[d,Q]},children:[{type:a,value:m}]}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n  bestwu\u002Fwechat\n  \n"},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:L}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:al}]},{type:a,value:bg},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n  --name qq "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:mx},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:my},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:f_}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:mz},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n  -v ~\u002Fqq\u002FTencentFiles:\u002FTencentFiles "},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aW},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:mA}]}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:mB},{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:mC}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aW},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:mD}]}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:mE},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:ck},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aW},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:a,value:mF}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:ck},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aW},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:a,value:mG}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:ck},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aW},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:a,value:mH}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,Q]},children:[{type:a,value:bD}]},{type:a,value:mI},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:c_}]},{type:a,value:f$},{type:b,tag:c,props:{className:[d,Q]},children:[{type:a,value:m}]}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aW},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:a,value:"VIDEO_GID"}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,Q]},children:[{type:a,value:bD}]},{type:a,value:"getent group video "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:c_}]},{type:a,value:f$},{type:b,tag:c,props:{className:[d,Q]},children:[{type:a,value:m}]}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aW},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:a,value:mJ}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,Q]},children:[{type:a,value:bD}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bS}]},{type:a,value:mK},{type:b,tag:c,props:{className:[d,Q]},children:[{type:a,value:m}]}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:aW},{type:b,tag:c,props:{className:[d,V,Q]},children:[{type:b,tag:c,props:{className:[d,am,an]},children:[{type:a,value:mL}]}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:b,tag:c,props:{className:[d,Q]},children:[{type:b,tag:c,props:{className:[d,Q]},children:[{type:a,value:bD}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bS}]},{type:a,value:mM},{type:b,tag:c,props:{className:[d,Q]},children:[{type:a,value:m}]}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:F}]},{type:a,value:"\n  bestwu\u002Fqq:im\n"}]}]}]}]},excerpt:{type:S,children:[]},dir:mN,path:"\u002F折腾\u002F20200503\u002F安装ubuntu18常用软件手记",extension:ap,title:l_,url:"\u002Fblog-code\u002Fview\u002F$E6$8A$98$E8$85$BE\u002F20200503\u002F$E5$AE$89$E8$A3$85ubuntu18$E5$B8$B8$E7$94$A8$E8$BD$AF$E4$BB$B6$E6$89$8B$E8$AE$B0\u002F",createAt:new Date(1588464000000),updateAt:new Date(1588464000000),attributes:[{name:aq,value:mO},{name:ar,value:mO},{name:as,value:mN,url:"\u002Fblog-code\u002Fpage\u002F$E6$8A$98$E8$85$BE\u002F20200503\u002F1\u002F"}]},{slug:mP,description:ab,createdAt:mQ,updatedAt:mQ,toc:[],body:{type:S,children:[{type:a,value:e},{type:b,tag:w,props:{id:mR},children:[{type:b,tag:j,props:{ariaHidden:q,href:"#%E6%95%B0%E6%8D%AE",tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:mR}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,bt]},children:[{type:b,tag:y,props:{},children:[{type:a,value:"person 表\npid  age name\n1     11     小明\n2     22     小红\n3     33     小白\n\naddress 表\naid pid city\n10    1    北京\n11    1    东京\n12    2    南京\n13    4    西京\n"}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:mS},children:[{type:b,tag:j,props:{ariaHidden:q,href:"#%E5%86%85%E8%BF%9E%E6%8E%A5",tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:mS}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"只有两张表都有数据才连接"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,cl]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bi}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aQ}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aV}]},{type:a,value:dI},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:"inner"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:dJ}]},{type:a,value:dK},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:dL}]},{type:a,value:dM},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:dN},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:dO},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:dP},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:dQ},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:a,value:aR},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:bj}]},{type:a,value:bM},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:ba}]},{type:a,value:aX},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:a,value:dR},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:a,value:aR},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:bj}]},{type:a,value:bM},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:bj}]},{type:a,value:aX},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:a,value:dS},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:av}]},{type:a,value:aR},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:dT}]},{type:a,value:dU},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:dV}]},{type:a,value:aX},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:av}]},{type:a,value:dW}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:mT},children:[{type:b,tag:j,props:{ariaHidden:q,href:"#%E5%B7%A6%E8%BF%9E%E6%8E%A5",tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:mT}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"左边的表的行都有，右边的没有就补null"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,cl]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bi}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aQ}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aV}]},{type:a,value:dI},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:"left"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:dJ}]},{type:a,value:dK},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:dL}]},{type:a,value:dM},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:dN},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:dO},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:dP},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:dQ},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:a,value:aR},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:bj}]},{type:a,value:bM},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:ba}]},{type:a,value:aX},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:a,value:dR},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:a,value:aR},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:bj}]},{type:a,value:bM},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:bj}]},{type:a,value:aX},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:a,value:dS},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:av}]},{type:a,value:aR},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:dT}]},{type:a,value:dU},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:dV}]},{type:a,value:aX},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:av}]},{type:a,value:dW},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:bh}]},{type:a,value:aR},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:mU}]},{type:a,value:mV},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:a_}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:a_}]},{type:a,value:aR},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:a_}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:mW},children:[{type:b,tag:j,props:{ariaHidden:q,href:"#%E5%8F%B3%E8%BF%9E%E6%8E%A5",tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:mW}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"右边的表的行都有，左边的没有就补null"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,cl]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bi}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aQ}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aV}]},{type:a,value:dI},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:"right"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:dJ}]},{type:a,value:dK},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:dL}]},{type:a,value:dM},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:dN},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:dO},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:dP},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:dQ},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:a,value:aR},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:bj}]},{type:a,value:bM},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:ba}]},{type:a,value:aX},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:a,value:dR},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:a,value:aR},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:bj}]},{type:a,value:bM},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:bj}]},{type:a,value:aX},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:a,value:dS},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:av}]},{type:a,value:aR},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:dT}]},{type:a,value:dU},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:dV}]},{type:a,value:aX},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:av}]},{type:a,value:dW},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:a_}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:a_}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:a_}]},{type:a,value:dX},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:mX}]},{type:a,value:aX},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:mY}]},{type:a,value:mZ}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:m_},children:[{type:b,tag:j,props:{ariaHidden:q,href:"#%E5%85%A8%E8%BF%9E%E6%8E%A5",tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:m_}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"左边和右边的表的行都有，没有就补null，不过貌似mysql不支持全连接，反正navicat报错"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,cl]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bi}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aQ}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aV}]},{type:a,value:dI},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:"full"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:dJ}]},{type:a,value:dK},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:dL}]},{type:a,value:dM},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:dN},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:dO},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:a,value:dP},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:dQ},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:a,value:aR},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:bj}]},{type:a,value:bM},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:ba}]},{type:a,value:aX},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:a,value:dR},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:a,value:aR},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:bj}]},{type:a,value:bM},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:bj}]},{type:a,value:aX},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:a,value:dS},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:av}]},{type:a,value:aR},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:dT}]},{type:a,value:dU},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:dV}]},{type:a,value:aX},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:av}]},{type:a,value:dW},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:bh}]},{type:a,value:aR},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:mU}]},{type:a,value:mV},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:a_}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:a_}]},{type:a,value:aR},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:a_}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:a_}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:a_}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:a_}]},{type:a,value:dX},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:mX}]},{type:a,value:aX},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:mY}]},{type:a,value:mZ}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:"null返回"},children:[{type:b,tag:j,props:{ariaHidden:q,href:"#null%E8%BF%94%E5%9B%9E",tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"NULL返回"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"如果某个sql语句返回的是Empty set，可以有两个办法当Empty set时返回NULL。一是用子sql包一下，二是使用ifnull语句。不过要注意select的只允许一列。"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,cl]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bi}]},{type:a,value:dY},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aV}]},{type:a,value:ga},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:dZ}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:bN}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:"\nEmpty "},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bC}]},{type:a,value:aA},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bi}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bi}]},{type:a,value:dY},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aV}]},{type:a,value:ga},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:dZ}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:bN}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:cD}]},{type:a,value:df},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aB}]},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:cm}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:m$},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aB}]},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:cm}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:gb}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aB}]},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:cm}]},{type:a,value:aA},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bi}]},{type:a,value:" ifnull"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bi}]},{type:a,value:dY},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aV}]},{type:a,value:ga},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:dZ}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:bN}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:a_}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:cD}]},{type:a,value:df},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aB}]},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:cm}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:m$},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aB}]},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:cm}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:gb}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aB}]},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:cm}]},{type:a,value:e}]}]}]}]},excerpt:{type:S,children:[]},dir:na,path:"\u002F中间件\u002F20200509\u002F一些SQL知识点",extension:ap,title:mP,url:"\u002Fblog-code\u002Fview\u002F$E4$B8$AD$E9$97$B4$E4$BB$B6\u002F20200509\u002F$E4$B8$80$E4$BA$9BSQL$E7$9F$A5$E8$AF$86$E7$82$B9\u002F",createAt:new Date(1588982400000),updateAt:new Date(1588982400000),attributes:[{name:aq,value:nb},{name:ar,value:nb},{name:as,value:na,url:"\u002Fblog-code\u002Fpage\u002F$E4$B8$AD$E9$97$B4$E4$BB$B6\u002F20200509\u002F1\u002F"}]},{slug:nc,description:ab,createdAt:nd,updatedAt:nd,toc:[],body:{type:S,children:[{type:a,value:e},{type:b,tag:w,props:{id:ne},children:[{type:b,tag:j,props:{ariaHidden:q,href:"#%E4%BD%8D%E8%BF%90%E7%AE%97",tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:ne}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,bt]},children:[{type:b,tag:y,props:{},children:[{type:a,value:"与运算\n&: 0&0=0, 0&1=0, 1&0=0, 1&1=1\n  0011\n& 0101\n= 0001\n\n或运算\n|: 0|0=0, 0|1=1, 1|0=1, 1|1=1\n  0011\n| 0101\n= 0111\n\n异或运算\n^: 0^0=0, 0^1=1, 1^0=1, 1^1=0\n  0011\n^ 0101\n= 0110\n\n左移运算，低位补0\n0110 \u003C\u003C 2 = 1000\n等同于乘以2的2次方\n\n右移运算，自然数高位补0，负数高位补1\n0110 \u003E\u003E 2 = 0001\n1001 \u003E\u003E 2 = 1110\n\n无符号右移运算，高位补0\n0110 \u003E\u003E 2 = 0001\n等同于除以2的2次方\n\n取反运算\n~ 0110 = 1001\n"}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:nf},children:[{type:b,tag:j,props:{ariaHidden:q,href:"#%E4%BF%AE%E6%94%B9%E4%BD%8D",tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:nf}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,bt]},children:[{type:b,tag:y,props:{},children:[{type:a,value:"下标 3210\n     0111\n   & 1101 (1\u003C\u003C3-1\u003C\u003C1)\n   = 0101\n   \n下标 3210\n     1000\n   | 0010 (1\u003C\u003C1)\n   = 1010\n"}]}]}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,aT]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ax}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bo}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"set0"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bo}]},{type:a,value:bQ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bo}]},{type:a,value:bR},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:gc},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ng}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:gR},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:d_}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:du}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:a$}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:d_}]},{type:a,value:bR},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ax}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bo}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"set1"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bo}]},{type:a,value:bQ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bo}]},{type:a,value:bR},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:gc},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:d_}]},{type:a,value:bR},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:nh},children:[{type:b,tag:j,props:{ariaHidden:q,href:"#%E8%8E%B7%E5%8F%96%E4%BD%8D%E6%83%85%E5%86%B5",tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:nh}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,bt]},children:[{type:b,tag:y,props:{},children:[{type:a,value:"下标 3210\n     1010\n   & 1000 (1\u003C\u003C3)\n   = 1000=(1\u003C\u003C3)\u003E0\n\n     0101\n   & 1000 (1\u003C\u003C3)\n   = 0000=0\n"}]}]}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,aT]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ax}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bo}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"getb"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bo}]},{type:a,value:bQ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bo}]},{type:a,value:bR},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ad}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:gc},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ng}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:d_}]},{type:a,value:bR},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:R}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:aI}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bF}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ao}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:aI}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:ae}]},{type:a,value:e}]}]}]}]},excerpt:{type:S,children:[]},dir:ni,path:"\u002F算法\u002F20200512\u002F一些位运算",extension:ap,title:nc,url:"\u002Fblog-code\u002Fview\u002F$E7$AE$97$E6$B3$95\u002F20200512\u002F$E4$B8$80$E4$BA$9B$E4$BD$8D$E8$BF$90$E7$AE$97\u002F",createAt:new Date(1589241600000),updateAt:new Date(1589241600000),attributes:[{name:aq,value:nj},{name:ar,value:nj},{name:as,value:ni,url:"\u002Fblog-code\u002Fpage\u002F$E7$AE$97$E6$B3$95\u002F20200512\u002F1\u002F"}]},{slug:nk,description:"本文主要是聊聊 Linux 中的五种 IO 模型的概括。",createdAt:nl,updatedAt:nl,toc:[],body:{type:S,children:[{type:b,tag:i,props:{},children:[{type:a,value:nm},{type:b,tag:j,props:{href:nn,rel:[A,B,C],target:D},children:[{type:a,value:no}]},{type:a,value:np}]},{type:a,value:e},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"对于32位的计算机，操作系统最多给每个进程分配4G的内存。针对linux而言，linux会把其中1G分配为内核空间，另外3G分配为用户空间。"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"阻塞：进程被迫等待内核"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"非阻塞：进程可以不等待内核"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"同步：进程向内核发起调用"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"异步：内核向进程发起调用"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"内核会先将数据写到内核空间的缓冲区里，之后内核才会将数据从内核空间拷贝到用户空间里，进程才能读取数据。所以进程有两个等待阶段。"}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"阶段一：等待数据从硬件写入内核空间（准备数据）"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"阶段二：等待数据从内核空间写入到用户空间（拷贝数据）"}]},{type:a,value:e}]},{type:a,value:"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{type:b,tag:bs,props:{},children:[{type:b,tag:bx,props:{},children:[{type:b,tag:Y,props:{},children:[{type:b,tag:aC,props:{},children:[]},{type:b,tag:aC,props:{},children:[{type:a,value:"同步"}]},{type:b,tag:aC,props:{},children:[{type:a,value:"异步"}]}]}]},{type:b,tag:by,props:{},children:[{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:cn}]},{type:b,tag:K,props:{},children:[{type:a,value:"同步阻塞IO,多路复用IO"}]},{type:b,tag:K,props:{},children:[]}]},{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:"非阻塞"}]},{type:b,tag:K,props:{},children:[{type:a,value:nq}]},{type:b,tag:K,props:{},children:[{type:a,value:nr}]}]}]}]},{type:a,value:"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{type:b,tag:bs,props:{},children:[{type:b,tag:bx,props:{},children:[{type:b,tag:Y,props:{},children:[{type:b,tag:aC,props:{},children:[]},{type:b,tag:aC,props:{},children:[{type:a,value:"阶段一"}]},{type:b,tag:aC,props:{},children:[{type:a,value:"阶段二"}]}]}]},{type:b,tag:by,props:{},children:[{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:"同步阻塞IO"}]},{type:b,tag:K,props:{},children:[{type:a,value:cn}]},{type:b,tag:K,props:{},children:[{type:a,value:cn}]}]},{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:nq}]},{type:b,tag:K,props:{},children:[{type:a,value:"非阻塞,轮询"}]},{type:b,tag:K,props:{},children:[{type:a,value:cn}]}]},{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:gd}]},{type:b,tag:K,props:{},children:[{type:a,value:cn}]},{type:b,tag:K,props:{},children:[{type:a,value:cn}]}]},{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:nr}]},{type:b,tag:K,props:{},children:[{type:a,value:ns}]},{type:b,tag:K,props:{},children:[{type:a,value:ns}]}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:"同步阻塞iobio"},children:[{type:b,tag:j,props:{href:"#%E5%90%8C%E6%AD%A5%E9%98%BB%E5%A1%9Eiobio",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:nt}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"阻塞IO，进程发起read操作被阻塞，此时内核会开始准备数据，数据准备好了，再将数据从内核空间写入到用户空间，然后read操作才返回，进程解除阻塞状态。\n显然，这样子进程的大部分时间都在阻塞等待数据的准备和拷贝。\n"},{type:b,tag:au,props:{alt:nt,"data-src":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20200513\u002F640.webp"},children:[]}]},{type:a,value:e},{type:b,tag:w,props:{id:"同步非阻塞ionio"},children:[{type:b,tag:j,props:{href:"#%E5%90%8C%E6%AD%A5%E9%9D%9E%E9%98%BB%E5%A1%9Eionio",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:nu}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"非阻塞IO，进程发起read操作，内核会立即返回，如果数据还没准备好，会返回一个error。\n进程得到error的结果后，可以去做其他事情，待会再来轮询read操作，再次查询准备结果。\n如果数据准备好了，进程又发起read操作，进程将会被阻塞，直到数据从内核空间写入到用户空间。\n非阻塞IO问题在于绝大部分的轮询调用是无效的，消耗CPU时间。\n"},{type:b,tag:au,props:{alt:nu,"data-src":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20200513\u002F641.webp"},children:[]}]},{type:a,value:e},{type:b,tag:w,props:{id:"多路复用io"},children:[{type:b,tag:j,props:{href:"#%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8io",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:gd}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"UNIX\u002FLinux提供了select、poll、epoll系统调用（epoll比poll、select效率高，做的事情是一样的）。\n进程发起select调用，进程会被select调用阻塞，然后内核会监视这个select所负责的NIO的数据准备情况。\n如果有一个数据准备好了，select就会返回。然后进程再去发起read操作，被read操作阻塞，直到数据从内核空间写入到用户空间。\n所以"},{type:b,tag:ac,props:{},children:[{type:a,value:"多路复用"}]},{type:a,value:"就是"},{type:b,tag:ac,props:{},children:[{type:a,value:"多路"}]},{type:a,value:"NIO"},{type:b,tag:ac,props:{},children:[{type:a,value:"复用"}]},{type:a,value:"一个进程进行处理，因此一个进程就能处理多个NIO，提高并发量。\n当连接数不是很高，使用多路复用性能和响应速度可能会被BIO要差。\n虽然多路复用使用的是NIO，但是由于进程在阶段一被select调用阻塞（虽然不是被IO阻塞），阶段二被read操作阻塞，所以对于进程而已，多路复用IO还是BIO。\n"},{type:b,tag:au,props:{alt:gd,"data-src":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20200513\u002F642.webp"},children:[]}]},{type:a,value:e},{type:b,tag:w,props:{id:"异步非阻塞ioaio"},children:[{type:b,tag:j,props:{href:"#%E5%BC%82%E6%AD%A5%E9%9D%9E%E9%98%BB%E5%A1%9Eioaio",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:nv}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"进程调用aio_read操作，内核空间无论是否已经准备好数据没有，内核都会立即返回，进程就可以去做别的事。\n之后内核会负责将数据缓存到内核空间，然后将数据从内核空间写入到用户空间。\n在阶段一和阶段二完成后，内核才会去通知进程。\n"},{type:b,tag:au,props:{alt:nv,"data-src":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20200513\u002F643.webp"},children:[]}]},{type:a,value:e},{type:b,tag:w,props:{id:nw},children:[{type:b,tag:j,props:{href:"#%E5%85%B3%E4%BA%8E%E5%BC%82%E6%AD%A5%E9%98%BB%E5%A1%9E",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:nw}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"像js里，有时候虽然调用时异步的，但为了避免层层的callback嵌套，希望能阻塞到完成，这时候需要异步阻塞。"}]},{type:a,value:e},{type:b,tag:w,props:{id:nx},children:[{type:b,tag:j,props:{href:"#%E6%80%BB%E7%BB%93",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:nx}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:au,props:{alt:"五种IO模型","data-src":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20200513\u002F644.webp"},children:[]}]},{type:a,value:e},{type:b,tag:w,props:{id:bi},children:[{type:b,tag:j,props:{href:"#select",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:bi}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"调用select会把相应socket的fd_set从用户空间拷贝到内核空间，阻塞直到有就绪事件或者超时返回。\n调用返回会把fd_set从内核空间拷贝回用户空间。之后遍历整个fd_set，来找就绪的socket。\nselect几乎在所以平台都支持，但是在linux上限制了单进程fd最大为1024，并且需要通过轮询遍历来查找就绪socket，效率低。"}]},{type:a,value:e},{type:b,tag:w,props:{id:ny},children:[{type:b,tag:j,props:{href:"#poll",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:ny}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"poll基本跟select一样，但是他使用链表保存fd_set，所以没有fd数量限制。\n但是依然存在来回的拷贝和遍历socket问题。"}]},{type:a,value:e},{type:b,tag:w,props:{id:nz},children:[{type:b,tag:j,props:{href:"#epoll",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:nz}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"epoll的fd限制于硬件资源，1G内存机器能打开十万连接。\n只有活跃的socket才会调用回调函数，并且通过内存映射共享内存，减少数据拷贝。\nepoll对fd的操作模式有两种，水平触发（level trigger，LT）和边缘触发（edge trigger，ET）"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"水平触发：内核会通知某个socket就绪，如果不做任何操作的话，内核还会继续通知"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"边缘触发：内核之后通知一次就绪事件，如果不做任何操作的话，内核下次就不再通知了"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:aK}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fwww.jianshu.com\u002Fp\u002Fdfd940e7fca2",rel:[A,B,C],target:D},children:[{type:a,value:"聊聊IO多路复用之select、poll、epoll详解"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fcloud.tencent.com\u002Fdeveloper\u002Farticle\u002F1005481",rel:[A,B,C],target:D},children:[{type:a,value:"大话 Select、Poll、Epoll"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fwww.jianshu.com\u002Fp\u002F430141f95ddb",rel:[A,B,C],target:D},children:[{type:a,value:"select和epoll区别"}]}]}]},excerpt:{type:S,children:[{type:b,tag:i,props:{},children:[{type:a,value:nm},{type:b,tag:j,props:{href:nn,rel:[A,B,C],target:D},children:[{type:a,value:no}]},{type:a,value:np}]}]},dir:nA,path:"\u002F操作系统\u002F20200513\u002FLinux的IO模型",extension:ap,title:nk,url:"\u002Fblog-code\u002Fview\u002F$E6$93$8D$E4$BD$9C$E7$B3$BB$E7$BB$9F\u002F20200513\u002FLinux$E7$9A$84IO$E6$A8$A1$E5$9E$8B\u002F",createAt:new Date(1589328000000),updateAt:new Date(1589328000000),attributes:[{name:aq,value:nB},{name:ar,value:nB},{name:as,value:nA,url:"\u002Fblog-code\u002Fpage\u002F$E6$93$8D$E4$BD$9C$E7$B3$BB$E7$BB$9F\u002F20200513\u002F1\u002F"}]},{slug:nC,description:ab,createdAt:nD,updatedAt:nD,toc:[{id:d$,depth:_,text:d$},{id:ea,depth:_,text:ea},{id:eb,depth:_,text:eb},{id:ec,depth:_,text:ec},{id:nE,depth:_,text:ge},{id:nF,depth:_,text:nG},{id:nH,depth:_,text:gf},{id:nI,depth:_,text:gg},{id:nJ,depth:_,text:nK},{id:nL,depth:gh,text:nM},{id:nN,depth:gh,text:nO},{id:nP,depth:gh,text:nQ}],body:{type:S,children:[{type:a,value:e},{type:b,tag:w,props:{id:nR},children:[{type:b,tag:j,props:{href:"#%E5%AF%B9%E8%B1%A1%E5%AD%98%E6%B4%BB%E5%88%A4%E6%96%AD",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:nR}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"引用计数：一个对象被引用了，计数+1，否则就-1，如果计数为0，意味着没有被引用可以回收。\n但是无法解决对象相互循环引用的问题。"},{type:b,tag:eT,props:{},children:[{type:a,value:"用快慢指针不就好了吗（笑"}]}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"可达性分析：从GC Roots开始向下搜索引用对象，如果一个对象没有被搜索到的话，为不可达对象，意味着没有被引用可以回收。\nGC Roots包括：\n"},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"方法区的常量\u002F静态对象"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"虚拟机栈的对象"}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:nS},children:[{type:b,tag:j,props:{href:"#%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E7%AE%97%E6%B3%95",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:nS}]},{type:a,value:e},{type:b,tag:$,props:{id:d$},children:[{type:b,tag:j,props:{href:"#%E6%A0%87%E8%AE%B0-%E6%B8%85%E9%99%A4%E7%AE%97%E6%B3%95",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:d$}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:nT},{type:b,tag:ac,props:{},children:[{type:a,value:"死亡"}]},{type:a,value:"的对象，标记完成后回收死亡对象的空间。\n会产生空间碎片，如果要分配大对象而又没有足够大的空间，就又会触发GC以期清除出足够大的空间。"}]},{type:a,value:e},{type:b,tag:$,props:{id:ea},children:[{type:b,tag:j,props:{href:"#%E6%A0%87%E8%AE%B0-%E6%95%B4%E7%90%86%E7%AE%97%E6%B3%95",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:ea}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:nT},{type:b,tag:ac,props:{},children:[{type:a,value:"存活"}]},{type:a,value:"的对象，然后将存活对象移到内存的一端，清理边界以外的内存。\n能整理出大片的连续空间。如果对象多是长命不动的，需要被整理的对象就会相对较少，因此适用于老年代。"}]},{type:a,value:e},{type:b,tag:$,props:{id:eb},children:[{type:b,tag:j,props:{href:"#%E5%A4%8D%E5%88%B6%E7%AE%97%E6%B3%95",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:eb}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"将内存划为大小一样的两半。新对象分配在其中一半，需要GC时，把存活对象复制到另外一半内存，清空本来的一半内存。\n虽然内存划一半能确保存活对象都能放下，但是就是浪费了一半的内存。由于需要将存活对象来回复制，所以适用于新生代。"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"升级版复制算法是将内存划分为两个幸存区和一个eden区，比例1:1:8。\n新对象在eden区分配，需要GC时，把存活对象复制到其中一个幸存区，清空eden区和另一个幸存区。\n由于幸存区未必放得下全部存活对象，因此会使用老年代的内存来担保。"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:nU},children:[{type:b,tag:j,props:{href:"#%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:nU}]},{type:a,value:e},{type:b,tag:$,props:{id:ec},children:[{type:b,tag:j,props:{href:"#%E6%A6%82%E5%BF%B5",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:ec}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"并行（Parallel）：多条垃圾收集线程并行，用户线程依然STW"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"并发（Concurrent）：用户线程与垃圾收集线程同时执行（不一定在并发，要看CPU调度，反正用户线程没被STW）"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"吞吐量：用户代码时间 \u002F（用户代码时间 + 垃圾收集时间），所以看重总体占比，而非每次垃圾收集时间长短"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"新生代GC（Minor GC）：新生代垃圾收集，比较频繁，速度较快"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"老年代GC（Major GC \u002F Full GC）：Full GC指新生代和老年代都GC，但很多时候老年代的GC是由新生代GC触发的"}]},{type:a,value:e}]},{type:a,value:nV},{type:b,tag:bs,props:{},children:[{type:b,tag:bx,props:{},children:[{type:b,tag:Y,props:{},children:[{type:b,tag:aC,props:{},children:[]},{type:b,tag:aC,props:{},children:[{type:a,value:"新生代"}]},{type:b,tag:aC,props:{},children:[{type:a,value:"老年代"}]}]}]},{type:b,tag:by,props:{},children:[{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:"串行回收"}]},{type:b,tag:K,props:{},children:[{type:a,value:"Serial"}]},{type:b,tag:K,props:{},children:[{type:a,value:"Serial Old"}]}]},{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:"并行回收"}]},{type:b,tag:K,props:{},children:[{type:a,value:"ParNew,Parallel Scavenge"}]},{type:b,tag:K,props:{},children:[{type:a,value:"Parallel Old"}]}]},{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:"并发回收"}]},{type:b,tag:K,props:{},children:[{type:a,value:"G1"}]},{type:b,tag:K,props:{},children:[{type:a,value:"CMS,G1"}]}]}]}]},{type:a,value:e},{type:b,tag:$,props:{id:nE},children:[{type:b,tag:j,props:{href:"#serial%E4%B8%8Eserial-old",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:ge}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"STW，单线程，新生代使用复制算法，老年代使用标记-整理算法。\n适用于桌面应用，内存不大，STW时间短。单核服务器，单线程效率高。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:au,props:{alt:ge,"data-src":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20200515\u002Fpic.yupoo.com-crowhawk-6b90388c-6c281cf0.png.JPEG"},children:[]}]},{type:a,value:e},{type:b,tag:$,props:{id:nF},children:[{type:b,tag:j,props:{href:"#parnew",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:nG}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"ParNew是Serial的多线程版本，新生代收集器。\n在Server模式下，是除了Serial，唯一能和CMS配合的收集器。"}]},{type:a,value:e},{type:b,tag:$,props:{id:nH},children:[{type:b,tag:j,props:{href:"#parallel-scavenge%E4%B8%8Eparallel-old",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:gf}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"STW，多线程，新生代使用复制算法，老年代使用标记-整理算法。\n关注吞吐量，适合于后台交互不多的服务。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:au,props:{alt:gf,"data-src":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20200515\u002Fpic.yupoo.com-crowhawk-9a6b1249-b1800d45.png.JPEG"},children:[]}]},{type:a,value:e},{type:b,tag:$,props:{id:nI},children:[{type:b,tag:j,props:{href:"#cms%E6%94%B6%E9%9B%86%E5%99%A8",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:gg}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"CMS（Concurrent Mark Sweep）是老年代收集器，使用标记-清除算法。\n以最短停顿时间为目标，所以适用交互比较多的Server。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"CMS收集器工作分为四个步骤："}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:nW}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:nX}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"重新标记：STW，修正在并发标记期间，用户线程继续运行所变动的对象的标记"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"并发清除：使用标记-清除算法进行清除"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:au,props:{alt:gg,"data-src":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20200515\u002Fpic.yupoo.com-crowhawk-fffcf9a2-f60599b2.png.JPEG"},children:[]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"耗时主要在并发标记和并发清除，有点低停顿，并发收集。缺点是："}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"使用标记-清除算法会导致内存碎片。"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"不过可以通过虚拟机参数配置在Full GC之前进行碎片整理，也可以设置多少次Full GC进行一次碎片整理。\n2. 并发标记期间无法标记用户线程产生的新垃圾，需要下次GC再清理。\n并且不能等到内存满了再GC，不然在GC时就没有新内存给用户线程申请了。\n如果真的在GC时没有内存了，会使用Serial Old做备案。\n3. 并发能力依赖于CPU资源，如果CPU紧张，性能会比较差。"}]},{type:a,value:e},{type:b,tag:$,props:{id:nJ},children:[{type:b,tag:j,props:{href:"#g1%E6%94%B6%E9%9B%86%E5%99%A8",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:nK}]},{type:a,value:e},{type:b,tag:gi,props:{id:nL},children:[{type:b,tag:j,props:{href:"#g1%E5%86%85%E5%AD%98%E5%88%92%E5%88%86",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:nM}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"G1将内存划分为多个等大小的区域（Region），区域最小1M，最大32M，需是2的幂次方，默认会把堆进行2048等分。\n这些区域可能是Eden，Survivor、Humongous区和未使用区域。逻辑上映射为eden区、幸存区、老年代。\n其中，Humongous用于存放大于50%区域大小的对象。如果一个H区还装不下，G1回去寻找连续的H区，为此可能会使用Full GC。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:au,props:{alt:ab,"data-src":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20200515\u002Fpic4.zhimg.com-80-v2-8f3ff3c893b1460062885e5122adf4bb_720w.jpg.JPEG"},children:[]}]},{type:a,value:e},{type:b,tag:gi,props:{id:nN},children:[{type:b,tag:j,props:{href:"#remembered-set",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:nO}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"由于G1将堆划分为多个区域，对象可能会引用多个其他区域的对象，这导致在可达性分析时需要扫描整个堆。\n为此G1在每个区域里维护了一个Remembered Set，当发现对引用进行写操作时，虚拟机会加一个写屏障，在写之前检查新写入的引用的对象，是否有引用其他区域的对象。\n如果有则记录在Remembered Set里。这样子在可达性分析时只需要在Remembered Set上分析即可，避免对全堆扫描。"}]},{type:a,value:e},{type:b,tag:gi,props:{id:nP},children:[{type:b,tag:j,props:{href:"#g1%E5%9B%9E%E6%94%B6%E6%AD%A5%E9%AA%A4",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:nQ}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:nW}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:nX}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"最终标记：STW，修正在并发标记期间，用户线程继续运行所变动的对象的标记。"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"虚拟机会将这段时间里对象的变化记录在Remembered Set Logs里，此时会把Remembered Set Logs的变化合并到Remembered Set中\n4. 筛选回收：STW(老年代使用标记-整理算法)，对各个区域的回收价值和成本进行排序，根据用户指定的停顿时间指定回收计划。\n通过控制回收的区域数量来控制停顿时间。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:au,props:{alt:ab,"data-src":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20200515\u002Fpic.yupoo.com-crowhawk-53b7a589-0bce1667.png.JPEG"},children:[]}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"G1使用复制算法和标记-整理算法，不会产生内存碎片。"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"G1依然有分代，但是通过把内存划分为多个区域的设计，使得G1能同时管理整个堆。"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"G1支持并发回收，并且通过并行回收，利用多核CPU来缩短停顿时间。"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"G1通过维护每个区域的回收空间大小与回收成本的经验值，使G1能在有限时间里达到最大的回收效率。（G1，Garbage-First名字的由来）"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"G1适用于多CPU，大内存(\u003E=4G)的服务端上。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:jm}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fmp.weixin.qq.com\u002Fs\u002FolNXcRAT3PTK-hV_ehtmtw",rel:[A,B,C],target:D},children:[{type:a,value:"jvm系列(三):GC算法 垃圾收集器"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fcrowhawk.github.io\u002F2017\u002F08\u002F15\u002Fjvm_3\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"深入理解JVM(3)——7种垃圾收集器"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fjuejin.im\u002Fpost\u002F5bade237e51d450ea401fd71",rel:[A,B,C],target:D},children:[{type:a,value:"一文了解JVM全部垃圾回收器，从Serial到ZGC"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fwww.cnblogs.com\u002Fbigben0123\u002Fp\u002F11365070.html",rel:[A,B,C],target:D},children:[{type:a,value:"7种 JVM 垃圾收集器特点、优劣势及使用场景(多图)"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F59861022",rel:[A,B,C],target:D},children:[{type:a,value:"深入剖析JVM：G1收集器+回收流程+推荐用例"}]}]}]},excerpt:{type:S,children:[]},dir:nY,path:"\u002Fjava\u002F20200515\u002F垃圾收集算法与垃圾收集器",extension:ap,title:nC,url:"\u002Fblog-code\u002Fview\u002Fjava\u002F20200515\u002F$E5$9E$83$E5$9C$BE$E6$94$B6$E9$9B$86$E7$AE$97$E6$B3$95$E4$B8$8E$E5$9E$83$E5$9C$BE$E6$94$B6$E9$9B$86$E5$99$A8\u002F",createAt:new Date(1589500800000),updateAt:new Date(1589500800000),attributes:[{name:aq,value:nZ},{name:ar,value:nZ},{name:as,value:nY,url:"\u002Fblog-code\u002Fpage\u002Fjava\u002F20200515\u002F1\u002F"}]},{slug:n_,description:gj,createdAt:n$,updatedAt:n$,toc:[],body:{type:S,children:[{type:b,tag:i,props:{},children:[{type:a,value:gj}]},{type:a,value:e},{type:a,value:e},{type:b,tag:w,props:{id:oa},children:[{type:b,tag:j,props:{ariaHidden:q,href:"#%E5%BC%BA%E5%BC%95%E7%94%A8",tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:oa}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"形如"},{type:b,tag:y,props:{},children:[{type:a,value:"Object object = new Object();"}]},{type:a,value:"就是强引用。只有强引用还存在，虚拟机就不会回收这个对象。\n就是内存不够，也另可报OutOfMemoryError异常。直到一个对象没有强引用，虚拟机才会认为这个对象是可回收的。"}]},{type:a,value:e},{type:b,tag:w,props:{id:"软引用softreference"},children:[{type:b,tag:j,props:{ariaHidden:q,href:"#%E8%BD%AF%E5%BC%95%E7%94%A8softreference",tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"软引用（SoftReference）"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"软引用对象，虚拟机是认为可回收的，但是只有虚拟机认为内存不够的时候才会回收。\n因此在报内存溢出以前，虚拟机是已经回收了全部软引用了。内存充足时虚拟机倾向于保留对象在内存里。\n因此软引用适合于做一些本地缓存。"}]},{type:a,value:e},{type:b,tag:w,props:{id:"弱引用weakreference"},children:[{type:b,tag:j,props:{ariaHidden:q,href:"#%E5%BC%B1%E5%BC%95%E7%94%A8weakreference",tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"弱引用（WeakReference）"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"弱引用对象，虚拟机认为是可回收的，并且在GC时发现有弱引用对象就会回收。"}]},{type:a,value:e},{type:b,tag:w,props:{id:ob},children:[{type:b,tag:j,props:{ariaHidden:q,href:"#%E8%99%9A%E5%BC%95%E7%94%A8",tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:ob}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"虚引用对象，虚拟机认为这个对象跟没有引用一样，会在GC时进行回收。\n不同于软引用和弱引用，虚引用通过get方法获取对象永远为null。\n虚引用的作用仅仅是在对象在执行finalize方法之后，用户程序获知并可以做某些事情的机制。\n例如可以用来监控对象的回收。"}]},{type:a,value:e},{type:b,tag:w,props:{id:"引用队列referencequeue"},children:[{type:b,tag:j,props:{ariaHidden:q,href:"#%E5%BC%95%E7%94%A8%E9%98%9F%E5%88%97referencequeue",tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"引用队列（ReferenceQueue）"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"如果给软引用、弱引用和虚引用添加一个引用队列的话，在引用对象被回收后，虚拟机会将引用加入到这个队列里，用户程序可以在这个队列里查找已经被回收的对象的引用。\n当然更加直接可以通过get方法判断对象是否已经被回收。虽然引用对象非强引用，但是引用本身是强引用，便于我们在需要时把引用设为null（如在引用数组里，如ThreadLocal）。"}]},{type:a,value:e},{type:b,tag:w,props:{id:"gc的重新标记最终标记"},children:[{type:b,tag:j,props:{ariaHidden:q,href:"#gc%E7%9A%84%E9%87%8D%E6%96%B0%E6%A0%87%E8%AE%B0%E6%9C%80%E7%BB%88%E6%A0%87%E8%AE%B0",tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"GC的重新标记\u002F最终标记"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"为什么CMS和G1在并发标记之后需要重新标记\u002F最终标记。所谓的在并发标记，用户程序还在执行会导致对象引用状态改变的其中一种情况就是。\n例如在并发标记一开始标记了一个弱引用对象需要被回收，但是之后用户程序从弱引用里取出对象变成了强引用。\n这就导致需要再进行一次STW的重新标记，检查那些被标记为需要回收的对象有没有复活。\n不过这个有个没想懂的问题，CMS在清除的时候是与用户线程并发的，这时候不也会有取出对象变强引用，但却被回收的问题吗？"}]},{type:a,value:e},{type:b,tag:w,props:{id:"threadlocal"},children:[{type:b,tag:j,props:{ariaHidden:q,href:"#threadlocal",tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"ThreadLocal"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"每个线程都有一个ThreadLocalMap对象，这个map的key是ThreadLocal，value是我们要保存的数据。"},{type:b,tag:y,props:{},children:[{type:a,value:"Thread-\u003EThreadLocalMap\u003CThreadLocal,T\u003E"}]},{type:a,value:"。\n例如get对象时，ThreadLocal里通过currentThread获取ThreadLocalMap对象，再通过"},{type:b,tag:y,props:{},children:[{type:a,value:"map.get(this)"}]},{type:a,value:"获取对象。\n但ThreadLocalMap对ThreadLocal的引用是弱引用，这样当ThreadLocal的强引用都消失时，GC就能回收ThreadLocal对象。\n剩下key是null的value，但是ThreadLocalMap对value的引用强引用，value并不会被GC回收。久而久之就会内存溢出。\n所以在其他ThreadLocal调用get、set、remove方法时，都可能会检查清理ThreadLocalMap中key为null的value。\n最后，为什么不把value也弄成弱引用呢？value只被ThreadLocalMap弱引用就被回收了呀，转个头ThreadLocal来取值发现value是null的？"}]}]},excerpt:{type:S,children:[{type:b,tag:i,props:{},children:[{type:a,value:gj}]}]},dir:oc,path:"\u002Fjava\u002F20200518\u002FJava引用类型",extension:ap,title:n_,url:"\u002Fblog-code\u002Fview\u002Fjava\u002F20200518\u002FJava$E5$BC$95$E7$94$A8$E7$B1$BB$E5$9E$8B\u002F",createAt:new Date(1589760000000),updateAt:new Date(1589760000000),attributes:[{name:aq,value:od},{name:ar,value:od},{name:as,value:oc,url:"\u002Fblog-code\u002Fpage\u002Fjava\u002F20200518\u002F1\u002F"}]},{slug:oe,description:ab,createdAt:of,updatedAt:of,toc:[{id:ed,depth:_,text:ed},{id:og,depth:_,text:oh},{id:ee,depth:_,text:ee}],body:{type:S,children:[{type:a,value:e},{type:b,tag:w,props:{id:"mq的作用"},children:[{type:b,tag:j,props:{href:"#mq%E7%9A%84%E4%BD%9C%E7%94%A8",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"MQ的作用"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"削峰：顾名思义+允许异步"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"解耦：要给多服务调接口，对接麻烦"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"异步：要调多服务接口（超时）"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:"kafka高可用性"},children:[{type:b,tag:j,props:{href:"#kafka%E9%AB%98%E5%8F%AF%E7%94%A8%E6%80%A7",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"Kafka高可用性"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"Kafka部署多个节点来支持高可用。每个主题有多个分区，分区下面又有一个leader副本和多个follow副本。\n读写都在leader副本里，follow副本往leader副本同步数据。\nkafka会将leader副本均匀分布在各个节点上，如果leader副本挂了，会在follow副本中选举一个新的leader副本。"}]},{type:a,value:e},{type:b,tag:w,props:{id:"kafka重复消费"},children:[{type:b,tag:j,props:{href:"#kafka%E9%87%8D%E5%A4%8D%E6%B6%88%E8%B4%B9",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"Kafka重复消费"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"kafka保证每个分区的的消息是顺序的，并且会给消息一个offset。\n默认消费端每隔一段时间会给kafka上报自己拉到最新的offset，那kafka重启之后就会在offset开始继续消费。\n但是否要取消自动上报offset改为自己上报offset要看业务，如果每消费一条就上报一次，效率可能太低。"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"生产一个唯一id，在消费的时候redis查一下消费过没"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"数据库弄个唯一索引"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"弄成重复消费也不要紧（幂等性）"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:"kafka丢数据与顺序性"},children:[{type:b,tag:j,props:{href:"#kafka%E4%B8%A2%E6%95%B0%E6%8D%AE%E4%B8%8E%E9%A1%BA%E5%BA%8F%E6%80%A7",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"Kafka丢数据与顺序性"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"消费端弄丢了数据：消费端拉到了数据，然后就上报了offset，然而还没消费就挂掉了。\n最好保证幂等性，消费一批后才手动提交offset。"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"Kafka弄丢了数据：leader副本接收了数据，生产端收到了确认，还没follow副本pull，leader就挂了。\n修改配置，要求数据写入所有follow副本之后，才能认为是写成功了。"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"保证消息的顺序性：每个需要顺序执行队列分到一个分区里，每个分区只用一个消费者消费"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:"kafka的消息语义"},children:[{type:b,tag:j,props:{href:"#kafka%E7%9A%84%E6%B6%88%E6%81%AF%E8%AF%AD%E4%B9%89",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"Kafka的消息语义"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"在消息投递与消费的常见语义有三种。而要完整实现某种语义，需要在生产端，Kafka端和消费端进行保证。"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"至少一次：消息不会丢，但可能重复"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"最多一次：消息可能会丢，但不会重复"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"精确一次：消息即不丢也不重复"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:$,props:{id:ed},children:[{type:b,tag:j,props:{href:"#%E7%94%9F%E4%BA%A7%E7%AB%AF",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:ed}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"至少一次：（默认）当网络问题导致没有收到提交确认，在旧版本生产端会进行重试"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"最多一次：取消生产端的重试机制"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"精确一次：在新版本的生产端，Kafka端会给每个生产端一个ID，并且通过消息ID进行去除。即便重复提交消息也只会有一条消息。"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:$,props:{id:og},children:[{type:b,tag:j,props:{href:"#kafka%E7%AB%AF",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:oh}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"至少一次：不晓得"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"最多一次：生产端不等待确认消息或者只等待主副本确认消息"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"精确一次：生产端等待主副本和全部从副本确认消息"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:$,props:{id:ee},children:[{type:b,tag:j,props:{href:"#%E6%B6%88%E8%B4%B9%E7%AB%AF",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:ee}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"至少一次：先处理消息，再提交偏移量"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"最多一次：先提交偏移量，再处理消息"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"精确一次：\n"},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"处理结果与偏移量通过事务一起存储\n"},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"在数据库里利用事务"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"在kafka里，偏移量是保存在一个主题里的，kafka支持往不同主题提交消息作为一个事务"}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"不一起存储则需要用分布式事务"}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"kafka的事务的隔离级别有两种，读未提交和读已提交，可以分别用在最多一次和至少一次上。"}]},{type:a,value:e},{type:b,tag:w,props:{id:oi},children:[{type:b,tag:j,props:{href:"#%E6%B6%88%E8%B4%B9%E7%A7%AF%E5%8E%8B",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:oi}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"修复消费慢问题"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"建一个新的主题，分区是原来十倍"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"用个临时程序把积压的数据搬到新主题里"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"起十倍消费者消费新主题数据"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"恢复原来结构"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:"sqs"},children:[{type:b,tag:j,props:{href:"#sqs",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"SQS"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"SQS没有分区的概念，提供两种队列，标准队列和先进先出队列。\n标准队列提供无上限的吞吐，但是不保证（但基本上）顺序。\n先进先出队列保证顺序，但吞吐限三千。\nSQS对消息提供了一个可见性超时，当客户端拉取消息后，在这段时间内客户端无法拉取此消息，超时后客户端可以重新拉取此消息。\n所以客户端消费完消息后需要向SQS提交删除消息。如果时间短了可能导致重复消费，时间长了需要更长时间才能重新消费失败信息。"}]},{type:a,value:e},{type:b,tag:w,props:{id:"sqs源码"},children:[{type:b,tag:j,props:{href:"#sqs%E6%BA%90%E7%A0%81",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"SQS源码"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"链接工厂-\u003E链接-\u003E会话-\u003E队列-\u003E消费者-\u003E处理回调"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"消费者-\u003EnewSingleThreadExecutor-\u003E消息拉取-\u003E\n消息+处理回调=封装成一个对象，放在回调队列里-\u003E"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"会话-\u003EnewSingleThreadExecutor-\u003E回调队列"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:aK}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"http:\u002F\u002Fcxy7.com\u002Farticles\u002F2018\u002F06\u002F12\u002F1528812656788.html",rel:[A,B,C],target:D},children:[{type:a,value:"Kafka中的消息传递保证语义"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"http:\u002F\u002Fsongkun.me\u002F2019\u002F03\u002F03\u002F2019-03-03-kafka-message-delivery-semantics-and-impl\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"Kafka 消息语义"}]}]}]},excerpt:{type:S,children:[]},dir:oj,path:"\u002F中间件\u002F20200601\u002FMQ总结",extension:ap,title:oe,url:"\u002Fblog-code\u002Fview\u002F$E4$B8$AD$E9$97$B4$E4$BB$B6\u002F20200601\u002FMQ$E6$80$BB$E7$BB$93\u002F",createAt:new Date(1590969600000),updateAt:new Date(1590969600000),attributes:[{name:aq,value:ok},{name:ar,value:ok},{name:as,value:oj,url:"\u002Fblog-code\u002Fpage\u002F$E4$B8$AD$E9$97$B4$E4$BB$B6\u002F20200601\u002F1\u002F"}]},{slug:ol,description:"ES的数据结构：index -\u003E type -\u003E document -\u003E field。\n每一个索引会被分为多个shard，每个shard保存部分数据，分别放在不同节点上。\nshard有主shard允许读写，从shard允许读，从shard会与主shard同步数据。\nES集群会选举出一个主节点，负责维护索引元数据和管理主shard和从shard。\nES写数据请求：客户端选择一个节点作为自己的协调节点，协调节点根据请求文档进行路由。\n把请求转发给主shard所在的节点，当从shard也同步完成了，协调节点才会给客户端响应。\nES读数据请求：客户端选择一个节点作为自己的协调节点，协调节点根据请求文档进行路由。\n在主shard和全部从shard节点上轮询一个节点进行请求转发，然后把结果返回给客户端。",createdAt:ef,updatedAt:ef,toc:[],body:{type:S,children:[{type:b,tag:i,props:{},children:[{type:a,value:om}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:on}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:oo}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:op}]},{type:a,value:e},{type:a,value:e},{type:b,tag:w,props:{id:"es写数据原理"},children:[{type:b,tag:j,props:{ariaHidden:q,href:"#es%E5%86%99%E6%95%B0%E6%8D%AE%E5%8E%9F%E7%90%86",tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"ES写数据原理"}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"将数据写入buffer，在buffer时是不可查询的"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"buffer快慢或者定时1秒，将buffer数据写入系统缓存里，此时数据可查询。"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"ES会定时5秒把系统缓存的数据写到translog文件里，以便重启后恢复。\n3. 当translog文件够大或者定时30分钟，ES会把buffer和translog文件里的数据写到硬盘上。"}]},{type:a,value:e},{type:b,tag:w,props:{id:"es更删数据原理"},children:[{type:b,tag:j,props:{ariaHidden:q,href:"#es%E6%9B%B4%E5%88%A0%E6%95%B0%E6%8D%AE%E5%8E%9F%E7%90%86",tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"ES更\u002F删数据原理"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"删数据会在一个"},{type:b,tag:y,props:{},children:[{type:a,value:".del"}]},{type:a,value:"文件里标明这个文档已经被删除。而更新则是先删再插入一条新的文档。"}]},{type:a,value:e},{type:b,tag:w,props:{id:oq},children:[{type:b,tag:j,props:{ariaHidden:q,href:"#%E5%80%92%E6%8E%92%E7%B4%A2%E5%BC%95",tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:oq}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"对文件提取一些词，标记这些词在哪些文档里出现过，当查询关键字的时候就能快速返回包含关键字的文档。"}]},{type:a,value:or},{type:b,tag:bs,props:{},children:[{type:b,tag:bx,props:{},children:[{type:b,tag:Y,props:{},children:[{type:b,tag:aC,props:{},children:[{type:a,value:os}]},{type:b,tag:aC,props:{},children:[{type:a,value:"doc"}]}]}]},{type:b,tag:by,props:{},children:[{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:T}]},{type:b,tag:K,props:{},children:[{type:a,value:"google 推特"}]}]},{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:av}]},{type:b,tag:K,props:{},children:[{type:a,value:"推特 facebook"}]}]},{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:bh}]},{type:b,tag:K,props:{},children:[{type:a,value:"facebook google"}]}]}]}]},{type:a,value:nV},{type:b,tag:bs,props:{},children:[{type:b,tag:bx,props:{},children:[{type:b,tag:Y,props:{},children:[{type:b,tag:aC,props:{},children:[{type:a,value:"word id"}]},{type:b,tag:aC,props:{},children:[{type:a,value:"word"}]},{type:b,tag:aC,props:{},children:[{type:a,value:os}]}]}]},{type:b,tag:by,props:{},children:[{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:T}]},{type:b,tag:K,props:{},children:[{type:a,value:"google"}]},{type:b,tag:K,props:{},children:[{type:a,value:"1,3"}]}]},{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:av}]},{type:b,tag:K,props:{},children:[{type:a,value:"推特"}]},{type:b,tag:K,props:{},children:[{type:a,value:"1,2"}]}]},{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:bh}]},{type:b,tag:K,props:{},children:[{type:a,value:"facebook"}]},{type:b,tag:K,props:{},children:[{type:a,value:"2,3"}]}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:"大数据量es"},children:[{type:b,tag:j,props:{ariaHidden:q,href:"#%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%87%8Fes",tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"大数据量ES"}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"虽然ES把数据写到了硬盘，但是操作系统会对硬盘的数据进行系统缓存到内存里。所以导致第一次查很慢，之后就很快了。"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"为了尽量能走系统缓存，应该尽量留多一点可用内存给操作系统而不是服务本身。最好可用内存为数据量的一半或以上\n2. 进行冷热数据分离\n3. ES的数据只保留查询字段，减少数据体积，非查询字段通过文档id再去其他地方查\n4. 数据预热\n5. ES的分页查询是每次都是从头查到中间的（像链表那样），不允许深页查，跳页查，可以一次性返回前N页自己分页"}]}]},excerpt:{type:S,children:[{type:b,tag:i,props:{},children:[{type:a,value:om}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:on}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:oo}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:op}]}]},dir:ot,path:"\u002F中间件\u002F20200602\u002FElasticSearch总结",extension:ap,title:ol,url:"\u002Fblog-code\u002Fview\u002F$E4$B8$AD$E9$97$B4$E4$BB$B6\u002F20200602\u002FElasticSearch$E6$80$BB$E7$BB$93\u002F",createAt:new Date(1591056000000),updateAt:new Date(1591056000000),attributes:[{name:aq,value:eg},{name:ar,value:eg},{name:as,value:ot,url:"\u002Fblog-code\u002Fpage\u002F$E4$B8$AD$E9$97$B4$E4$BB$B6\u002F20200602\u002F1\u002F"}]},{slug:ou,description:ab,createdAt:ef,updatedAt:ef,toc:[],body:{type:S,children:[{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"按我理解，简单的说，Taf是一个微服务治理与运维框架，相当于Spring Cloud+K8s的精简打包版。支持C++, Java, PHP, Nodejs, Go语言。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"在微服务治理上，taf有下面几个模块来实现，这些模块都是独立的服务"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"Web管理系统：顾名思义"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"Registry：注册中心+服务发布\u002F启停\u002F管理功能"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"Patch：用于管理用于发布的服务包"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"Config：配置中心"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"Log：远程日志管理"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"Stat：调用统计监控"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"Property：业务数据上报"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"Notify：业务异常上报"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"Node：部署在服务器上面，用于管理节点上的服务"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"部署流程"}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"在Web系统上上传服务包到Patch上"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"在Web系统上提交发布请求，Registry接受到请求后会传达给服务器上的Node"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"Node收到部署任务后会在Patch上拉取相应的服务包并拉起服务"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"服务启动后会向Node发送心跳包，再由Node上报给Registry，注册服务"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"Taf的Set概念\n简单来说就是把几个服务（当然每个服务都是高可用了的）组成一个Set。\n这几个服务直接的调用只能在Set内部，不能调到Set外面，哪怕Set内部的服务挂了。以保护Set外面以及其他Set的服务。\n不同机房不同Set，避免跨机房调用。\n能以Set为单位进行灰度或者扩容，有问题也只是一个Set内部，更加可控安全。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"想Spring Cloud基本包含了\n注册中心\n配置中心\n消息总线\n熔断器\n服务网关\n服务跟踪"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"而Taf缺少了消息总线、熔断器和服务网关这三个组件"}]}]},excerpt:{type:S,children:[]},dir:ov,path:"\u002F框架\u002F20200602\u002FTaf框架",extension:ap,title:ou,url:"\u002Fblog-code\u002Fview\u002F$E6$A1$86$E6$9E$B6\u002F20200602\u002FTaf$E6$A1$86$E6$9E$B6\u002F",createAt:new Date(1591056000000),updateAt:new Date(1591056000000),attributes:[{name:aq,value:eg},{name:ar,value:eg},{name:as,value:ov,url:"\u002Fblog-code\u002Fpage\u002F$E6$A1$86$E6$9E$B6\u002F20200602\u002F1\u002F"}]},{slug:ow,description:ab,createdAt:ox,updatedAt:ox,toc:[{id:z,depth:_,text:z},{id:eh,depth:_,text:eh},{id:cK,depth:_,text:cK},{id:bC,depth:_,text:bC},{id:oy,depth:_,text:oz},{id:oA,depth:_,text:oB},{id:oC,depth:_,text:oD},{id:ei,depth:_,text:ei},{id:ej,depth:_,text:ej}],body:{type:S,children:[{type:a,value:e},{type:b,tag:w,props:{id:oE},children:[{type:b,tag:j,props:{href:"#%E7%BC%93%E5%AD%98%E4%BD%9C%E7%94%A8",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:oE}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"高性能：查询速度快"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"高并发：支持并发高"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:"redis模型"},children:[{type:b,tag:j,props:{href:"#redis%E6%A8%A1%E5%9E%8B",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"Redis模型"}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"先注册server socket的可读事件。"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"当有客户端请求接入，IO多路复用就会把server socket放进队列里。"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"然后事件分派器会把server socket分派到应答处理器里，获得与客户端连接的socket，将socket的可读事件与命令请求处理器关联。"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"当客户端发出命令请求，socket有可读事件，事件分派器就会把socket分派到命令请求处理器。"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"执行命令完成后，会把socket的可写事件与命令回复处理器关联。"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"等到客户端可写，有可写事件，又会把socket放进队列里，分派到命令回复处理器回复命令执行结果。"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"使用纯内存，速度快"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"使用IO多路复用"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"命令执行为单线程，避免上写文切换"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"redis的单线程只是命令执行使用单线程，处理网络IO和后台删除过期key是使用多线程处理的。\nredis一开始使用单线程处理是因为IO多路复用，加上操作都是纯内存操作，处理速度快，单个线程就可以处理大量的连接。\n但是其中有很多的cpu时间是用来进行网络IO的，所以把网络IO和其他后台任务用多线程提高处理速度，命令执行依然用单线程。"}]},{type:a,value:e},{type:b,tag:w,props:{id:"redis数据类型与使用场景"},children:[{type:b,tag:j,props:{href:"#redis%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E4%B8%8E%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"Redis数据类型与使用场景"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"string\n"},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"分布式锁"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"自增计数器、秒杀、访问频率"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"分布式唯一ID：时间戳+自增值"}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"list\n"},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"消息队列：往左边加数据"},{type:b,tag:y,props:{},children:[{type:a,value:"lpush key value"}]},{type:a,value:"。往右边取数据，没有数据则阻塞到超时(如10s)"},{type:b,tag:y,props:{},children:[{type:a,value:"brpop key value 10"}]}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"列表最新消息：消息从左边插入，查左边前十个消息"},{type:b,tag:y,props:{},children:[{type:a,value:"lrange key 0 9"}]}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:cK}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"set\n"},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"抽奖活动：所有抽奖用户"},{type:b,tag:y,props:{},children:[{type:a,value:"smembers key"}]},{type:a,value:"，随机抽N个用户并删除"},{type:b,tag:y,props:{},children:[{type:a,value:"spop key N"}]},{type:a,value:"，随机抽N个用户不删除"},{type:b,tag:y,props:{},children:[{type:a,value:"srandmember key N"}]}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"点赞、签到、like功能"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"共同关注、可能认识的人：交并差集"}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"sorted set\n"},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"排行榜"}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:$,props:{id:z},children:[{type:b,tag:j,props:{href:"#string",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:z}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"redis的字符串没有使用c自带的字符串，而是重新实现了一个简单动态字符串（simple dynamic string，SDS）。\n但SDS除了扩容还会惰性缩容，缩容后会把空间腾出来，以备以后扩容，并不会重新分配内存。\n扩容规则是小于1M则比len*2大的2^n，大于1M的则len+1M。\n有点像StringBuilder，StringBuilder内部也有个"},{type:b,tag:y,props:{},children:[{type:a,value:"char[]"}]},{type:a,value:"可以扩容追加内容。"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:y,props:{},children:[{type:a,value:"buf"}]},{type:a,value:"：二进制数组，保存数据，休止符为"},{type:b,tag:y,props:{},children:[{type:a,value:"'\\0'"}]}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:y,props:{},children:[{type:a,value:fY}]},{type:a,value:"：字符串长度"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:y,props:{},children:[{type:a,value:"alloc"}]},{type:a,value:"：标头和休止符的长度"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:y,props:{},children:[{type:a,value:"flags"}]},{type:a,value:"：字节属性，是sdshdr8还是sdshdr16"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:au,props:{alt:ab,"data-src":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20200603\u002Fuser-gold-cdn.xitu.io-2019-9-12-16d245812d1e41c5.jpg.JPEG"},children:[]}]},{type:a,value:e},{type:b,tag:$,props:{id:eh},children:[{type:b,tag:j,props:{href:"#list",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:eh}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"redis的链表就是个标准的双向链表，list对象有头尾节点和节点数量"}]},{type:a,value:e},{type:b,tag:$,props:{id:cK},children:[{type:b,tag:j,props:{href:"#hash",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:cK}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"redis的hash也与java的类似，hash桶的个数是2^n，每个桶里是个链表。\n但实际hash桶的数组有两个，在ht这个数组里。\n"},{type:b,tag:y,props:{},children:[{type:a,value:ek}]},{type:a,value:eI},{type:b,tag:y,props:{},children:[{type:a,value:bz}]},{type:a,value:"是一样的，不过"},{type:b,tag:y,props:{},children:[{type:a,value:bz}]},{type:a,value:"是在rehash的时候使用。\n扩容rehash条件是负载因子("},{type:b,tag:y,props:{},children:[{type:a,value:"ht[0].used \u002F ht[0].size"}]},{type:a,value:")大于1，缩容rehash条件是负载因子小于0.1。\n扩容是创建一个大于"},{type:b,tag:y,props:{},children:[{type:a,value:"ht[0].used*2"}]},{type:a,value:oF},{type:b,tag:y,props:{},children:[{type:a,value:bz}]},{type:a,value:"。\n缩容则是创建一个大于"},{type:b,tag:y,props:{},children:[{type:a,value:"ht[0].used"}]},{type:a,value:oF},{type:b,tag:y,props:{},children:[{type:a,value:bz}]},{type:a,value:"。\n将"},{type:b,tag:y,props:{},children:[{type:a,value:ek}]},{type:a,value:"的数据rehash到"},{type:b,tag:y,props:{},children:[{type:a,value:bz}]},{type:a,value:"里，完成后将"},{type:b,tag:y,props:{},children:[{type:a,value:bz}]},{type:a,value:"改为"},{type:b,tag:y,props:{},children:[{type:a,value:ek}]},{type:a,value:"，"},{type:b,tag:y,props:{},children:[{type:a,value:bz}]},{type:a,value:"改置空。\n并且避免数据量大时rehash导致卡顿。所以会使用渐进式rehash。\n也就是会初始化一个新的"},{type:b,tag:y,props:{},children:[{type:a,value:bz}]},{type:a,value:"，在每次增删查改的时候，把"},{type:b,tag:y,props:{},children:[{type:a,value:ek}]},{type:a,value:"rehash到"},{type:b,tag:y,props:{},children:[{type:a,value:bz}]},{type:a,value:"，把rehashidx+1。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:au,props:{alt:ab,"data-src":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20200603\u002Fuser-gold-cdn.xitu.io-2019-9-6-16d04a318d3796f5.jpg.JPEG"},children:[]}]},{type:a,value:e},{type:b,tag:$,props:{id:bC},children:[{type:b,tag:j,props:{href:"#set",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:bC}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"redis的set在数据量不大的时候会时候"},{type:b,tag:y,props:{},children:[{type:a,value:"整数集合(intset)"}]},{type:a,value:"的结构，如果数据量大的话，则使用hash来保存。\nintset包含三个字段，分别是"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:y,props:{},children:[{type:a,value:"contents[]"}]},{type:a,value:"：正数数组，从小到大排序，不重复"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:y,props:{},children:[{type:a,value:"length"}]},{type:a,value:"：元素数量"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:y,props:{},children:[{type:a,value:iQ}]},{type:a,value:"：编码方式"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:$,props:{id:oy},children:[{type:b,tag:j,props:{href:"#sorted-set",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:oz}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"sorted set的底层结构是"},{type:b,tag:y,props:{},children:[{type:a,value:"跳跃表"}]},{type:a,value:"。跳跃表其实就是多层的链表，每一次链表都是有序的。\n底层链表包含着全部的节点，新增节点时，首先节点肯定是在底层链表里的。\n然后这个节点有50%的机会向上一层，所以一二三层节点的概率为0.5,0.25,0.125……。\n查找是从上层链表查起，比较大小之后逐层往下，知道找到或者在底层也找不到数据为止。\n查找、增删的时间复杂度是logN。\n由于是随机定节点所在的层，所以跳跃表只是大致均匀，不同于普通二叉树的不均匀和红黑树的严格均匀。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:au,props:{alt:ab,"data-src":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20200603\u002Fuser-gold-cdn.xitu.io-2019-9-6-16d04a318db56821.jpg.JPEG"},children:[]}]},{type:a,value:e},{type:b,tag:w,props:{id:"redis过期策略"},children:[{type:b,tag:j,props:{href:"#redis%E8%BF%87%E6%9C%9F%E7%AD%96%E7%95%A5",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"Redis过期策略"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"定期删除：每隔一段时间随机抽一些key看看过期了没，过期了清掉"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"惰性删除：当某个key被查询到，先检查这个key过期了没，过期了清掉，返回空"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"定时删除：每个key设置一个定时器，时间到了就删除此key"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"定期删除+惰性删除，但是会导致大量过期key积累，耗尽内存"}]},{type:a,value:e},{type:b,tag:w,props:{id:oG},children:[{type:b,tag:j,props:{href:"#%E7%BC%93%E5%AD%98%E6%B7%98%E6%B1%B0%E7%AD%96%E7%95%A5",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:oG}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"noeviction: 写入新数据就报错"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"allkeys-lru：删除最少使用key（最常使用，可以简单用LinkedHashMap实现）"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"allkeys-random：删除随机key"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"volatile-lru：删除有过期时间的最少使用key"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"volatile-random：删除有过期时间的随机key"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"volatile-ttl：删除最快过期的key"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:"缓存淘汰算法lrulfu"},children:[{type:b,tag:j,props:{href:"#%E7%BC%93%E5%AD%98%E6%B7%98%E6%B1%B0%E7%AE%97%E6%B3%95lrulfu",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"缓存淘汰算法（LRU、LFU）"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"LRU：如果数据在列表里，则把数据移到顶部。如果不在则弹出底部数据，插入新数据。\njava里可以用LinkedHashMap简单实现，用remove来get，之后put回去。但是没相应的api删除底部数据。\n也可以map+双向链表实现。链表用于增删数据。map用于查找，key-链表节点。\nmap可以参考ThreadLocal用弱引用，或者能通过链表节点获取key。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"redis的LRU，对象维护一个24位的时间戳作为最后活跃时间。\n当要清理数据时，会随机拿出N个对象（默认五个），删除活跃时间最久远的那个。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"但是活跃最久远不等于最不活跃，所以LFU改造了时间戳，前16位表示时间，后八位表示活跃频率。\nLFU会根据时间长短和活跃频率来权衡活跃程度。为了避免删除新键，可以对新键设置默认活跃频率。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:au,props:{alt:ab,"data-src":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20200603\u002Fupload-images.jianshu.io-upload_images-12062369-7fae1afe70569623.png.JPEG"},children:[]}]},{type:a,value:e},{type:b,tag:w,props:{id:"redis持久化"},children:[{type:b,tag:j,props:{href:"#redis%E6%8C%81%E4%B9%85%E5%8C%96",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"Redis持久化"}]},{type:a,value:e},{type:b,tag:$,props:{id:oA},children:[{type:b,tag:j,props:{href:"#rdb",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:oB}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"fork一个子进程进行RDB持久化，不用线程是避免锁竞争"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"父进程和子进程共享内存，操作系统会对内存进行分页"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"当父进程需要修改数据时，会把相应的内存页复制一份，子进程看到的内存依然是不变的"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"RDB可以设置多久之内有多少个数据发送改变就触发持久化"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"备份间隔长，丢的数据比较多"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"对性能影响小，适合做冷备份"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"重启恢复速度比AOP快"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:$,props:{id:oC},children:[{type:b,tag:j,props:{href:"#aof",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:oD}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"所以写命令会写入aof缓存，子进程根据策略追加到文件里（例如每秒）"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"当AOF文件过大，进行重写压缩的时候会生成新的文件，旧的文件照常写入"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"一般是RDB和AOF两种都同时开启，这样既能RDB的快速恢复，也有AOF的少丢数据"}]},{type:a,value:e},{type:b,tag:w,props:{id:"redis主从架构"},children:[{type:b,tag:j,props:{href:"#redis%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"Redis主从架构"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"对于缓存一般都是支持读高并发，所以使用一主多从，写在主节点，读在从节点。主节点必须开启持久化。"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"当从节点初次连接到主节点，会触发一次全量复制"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"主节点会起一个线程生产一个RDB快照，同时将接受到的写命令缓存到内存里"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"主节点会把RDB快照发给从节点，从节点会把RDB文件保存到硬盘里"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"从节点会清空自己的数据，加载RDB数据到内存里。期间以旧数据对外提供服务"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"如果因为RDB文件过大等原因，导致复制时间超时(默认60s)会认为复制失败"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"主节点会把内存里缓存的写命令发给从节点"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"主节点会在内存里维护一个backlog，以及主从节点都会保存一个replica offset"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"如果主从网络断开，恢复时会从上次的replica offset里继续复制数据"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"如果找不到对应的replica offset，则会触发一次全量复制"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:"redis哨兵集群"},children:[{type:b,tag:j,props:{href:"#redis%E5%93%A8%E5%85%B5%E9%9B%86%E7%BE%A4",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"Redis哨兵集群"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"集群监控：负责监控集群的节点是否正常\n"},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"每隔1s对节点发ping心跳检测，如果超时时间内没有回应，则为主观下线"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"询问其他哨兵节点此节点的状态，如果超半数都主观下线，则为客观下线"}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"故障转移：如果主节点挂了，会转移到从节点上\n"},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"哨兵集群选出领导者"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"剔除下线和未主从同步时间过长的从节点"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"同步偏移量最大-\u003E运行ID最小，选择新的主节点"}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"消息通知：将新主节点信息通知客户端"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"配置中心：客户端可在哨兵节点获取主节点信息"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:$,props:{id:ei},children:[{type:b,tag:j,props:{href:"#%E5%93%A8%E5%85%B5%E9%9B%86%E7%BE%A4%E9%80%89%E4%B8%BE",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:ei}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"每个发现主观下线的哨兵节点向其他哨兵节点发送命令，请求自己成为领导者"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"同意第一个请求，拒接其他请求"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"如果哨兵节点发现自己获得过半数票，则为领导者"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"如果有多个领导者，稍后再试"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"哨兵节点至少三个或以上（两个哨兵节点共同决策，如故障转移。所以最少要三个节点，保证哨兵集群的高可用）"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:$,props:{id:ej},children:[{type:b,tag:j,props:{href:"#%E5%93%A8%E5%85%B5%E9%9B%86%E7%BE%A4%E7%9A%84%E6%95%B0%E6%8D%AE%E4%B8%A2%E5%A4%B1",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:ej}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"故障转移后，从节点没完整复制数据"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"主节点脱离了正常网络但还运行着，故障转移后就有两个主节点。\n客户端可能还没来得及切换主节点，导致往旧主节点写数据。\n当旧主节点网络恢复加入集群成为从节点，就会被清空数据"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"可以配置使主节点至少跟一个从节点的数据同步少于10s，大于就拒绝写操作"}]},{type:a,value:e},{type:b,tag:w,props:{id:oH},children:[{type:b,tag:j,props:{href:"#%E9%9B%86%E7%BE%A4%E6%A8%A1%E5%BC%8F",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:oH}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"使用"},{type:b,tag:y,props:{},children:[{type:a,value:"CRC16(key) & 16384"}]},{type:a,value:"将key分派到一万六千多个槽的其中一个"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"槽的数量是固定的，集群的每一个主节点负责一部分的槽"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"客户端连接到集群的某个节点，如果key对应的槽在本节点就直接处理"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"否则会告知客户端槽所在节点的信息，让客户端再去自行请求"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"集群节点之间是网状结构，每个节点都会与其他节点保存连接，并且传播加入和离开的节点信息与槽信息"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"所以新加和删除节点，通过迁移槽和槽数据，迁移完成后刷新槽信息"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"如果某个节点ping另外的节点，在超时时间内都没有效响应，则为主观下线"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"节点会向其他节点询问，如果过半数节点都认为下线了，则为客观下线"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"从节点根据自己的同步偏移量设置参与选举时间。同步越全则选举越早"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"全部主节点给从节点投票，过半数者成为新的主节点"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:oI},children:[{type:b,tag:j,props:{href:"#%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:oI}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"由于缓存被删除\u002F过期\u002F宕机导致请求都到了数据库里"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"事前：高可用，主从哨兵或者Redis集群"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"事中：使用本地缓存、服务限流降级，避免数据库被打死"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"事后：使用RDB\u002FAOF重启恢复redis数据"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:oJ},children:[{type:b,tag:j,props:{href:"#%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:oJ}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"编造大量不正常数据，无缓存，导致都打到数据库"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"检查数据合法性"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"将这些数据也缓存到Redis里"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:oK},children:[{type:b,tag:j,props:{href:"#%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:oK}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"热点数据过期，大量请求打到数据库"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"基本不跟新，考虑将数据设置为不过期"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"用Redis锁进行更新"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"起一个定时任务主动更新"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:el},children:[{type:b,tag:j,props:{href:"#%E7%BC%93%E5%AD%98%E4%B8%8E%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E4%B8%80%E8%87%B4%E6%80%A7",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:el}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"先更新数据库再删除缓存，缓存lazy生成"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fdoocs.github.io\u002Fadvanced-java\u002F#\u002F.\u002Fdocs\u002Fhigh-concurrency\u002Fredis-consistence",rel:[A,B,C],target:D},children:[{type:a,value:"如何保证缓存与数据库双写一致性？"}]},{type:a,value:"里说的："}]},{type:a,value:e},{type:b,tag:bB,props:{},children:[{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"先更新数据库，再删除缓存。如果删除缓存失败了，那么会导致数据库中是新数据，缓存中是旧数据，数据就出现了不一致。\n解决思路：先删除缓存，再更新数据库。如果数据库更新失败了，那么数据库中是旧数据，缓存中是空的，那么数据不会不一致。\n因为读的时候缓存没有，所以去读了数据库中的旧数据，然后更新到缓存中。"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"我觉得是无稽之谈，缓存数据不是一般都有过期时间吗，过期兜底不就好了吗？\n为什么redis删数据失败，读数据还能成功？这时候是不是应该考虑一下是不是redis挂了？\n先删了缓存，还没改数据库的数据又被其他请求查回缓存里了，不也一样导致不一致吗？"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:aK}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fwww.liritian.com\u002F2020\u002F04\u002F15\u002Fredis-%e9%9b%86%e7%be%a4%e6%a8%a1%e5%bc%8f-redis-cluster\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"Redis 集群模式 Redis Cluster"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fphachon.com\u002Fredis\u002Fredis-3.html",rel:[A,B,C],target:D},children:[{type:a,value:"Redis系列（三）：Redis Cluster集群模式"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fwww.jianshu.com\u002Fp\u002F5359e7aa5bbe",rel:[A,B,C],target:D},children:[{type:a,value:"Redis为什么又引入了多线程？作者也逃不过“真香定理”？"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"http:\u002F\u002Fwww.baowenwei.com\u002Fpost\u002Ffen-bu-shi\u002Fredisshe-ji-yuan-li-zhi-di-ceng-shu-ju-jie-gou",rel:[A,B,C],target:D},children:[{type:a,value:"Redis设计原理之底层8种数据结构(一)"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fi6448038.github.io\u002F2019\u002F12\u002F01\u002Fredis-data-struct\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"图解redis五种数据结构底层实现(动图哦)"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fjuejin.im\u002Fpost\u002F5d71d3bee51d453b5f1a04f1",rel:[A,B,C],target:D},children:[{type:a,value:"深入了解Redis底层数据结构"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fjuejin.im\u002Fpost\u002F5cee9fdf6fb9a07ec42b3eca",rel:[A,B,C],target:D},children:[{type:a,value:"浅谈Redis五种数据结构的底层原理"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fjuejin.im\u002Fpost\u002F5b53ee7e5188251aaa2d2e16",rel:[A,B,C],target:D},children:[{type:a,value:"通俗易懂的Redis数据结构基础教程"}]}]}]},excerpt:{type:S,children:[]},dir:oL,path:"\u002F中间件\u002F20200603\u002FRedis总结",extension:ap,title:ow,url:"\u002Fblog-code\u002Fview\u002F$E4$B8$AD$E9$97$B4$E4$BB$B6\u002F20200603\u002FRedis$E6$80$BB$E7$BB$93\u002F",createAt:new Date(1591142400000),updateAt:new Date(1591142400000),attributes:[{name:aq,value:oM},{name:ar,value:oM},{name:as,value:oL,url:"\u002Fblog-code\u002Fpage\u002F$E4$B8$AD$E9$97$B4$E4$BB$B6\u002F20200603\u002F1\u002F"}]},{slug:oN,description:ab,createdAt:oO,updatedAt:oO,toc:[],body:{type:S,children:[{type:a,value:e},{type:b,tag:w,props:{id:oP},children:[{type:b,tag:j,props:{href:"#mysql%E6%9E%B6%E6%9E%84",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:oP}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:y,props:{},children:[{type:a,value:"连接\u002F线程处理器-\u003E[查询缓存-\u003E解析器-\u003E优化器](服务器层)-\u003E储存引擎"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"mysql有一个线程池，每个连接的查询只会在一个单独的线程里处理。\n对于select语句，在解析语句之前，会检查缓存，缓存有就直接返回。"}]},{type:a,value:e},{type:b,tag:w,props:{id:oQ},children:[{type:b,tag:j,props:{href:"#%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:oQ}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"mysql使用读写锁进行并发控制，读锁共享，写锁独占。\n并且将锁的颗粒度分为表锁和行锁，由储存引擎实现。\nInnodb会检测并回滚持有最少的行级排它锁的事务。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"在Innodb中，多版本并发控制(MVCC)只在读已提交和可重复读两个隔离级别下运行。\n原理通过增加两个隐藏列，分别表示创建的事务版本号和删除的事务版本号。\n每一个事务都有一个版本号，版本号自动递增，例如在可重复读中："}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"select：创建版本号小于当前，删除版本号为空或者大于当前"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"insert：创建版本号设置为当前"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"delete：删除版本号设置为当前"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"update：插入一条新的记录和创建版本号，设置旧的记录的删除版本号"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:"事务特性acid与隔离级别"},children:[{type:b,tag:j,props:{href:"#%E4%BA%8B%E5%8A%A1%E7%89%B9%E6%80%A7acid%E4%B8%8E%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"事务特性(ACID)与隔离级别"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"原子性(atomicity)：事务内的操作要不全部成功，要不全部失败"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"一致性(consistency)：无论事务成功与否，前后的数据都要保持一致性，不能无端的多了少了"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"隔离性(isolation)：在事务完成之前，其他事务对此不可见"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"持久性(durability)：一旦事务成功，哪怕数据库奔溃，修改的数据也不会丢失"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"读未提交：脏读"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"读已提交：不可重复读"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"可重复读（Innodb默认）\n"},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"幻读：如果事务查询"},{type:b,tag:y,props:{},children:[{type:a,value:gk}]},{type:a,value:"的数量，别的事务新增一行age=15，回头再查"},{type:b,tag:y,props:{},children:[{type:a,value:gk}]},{type:a,value:"会发现数量+1"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"Innodb会通过Next-Key Lock(间隙锁(GAP Lock)+行锁(Record Lock))来锁定"},{type:b,tag:y,props:{},children:[{type:a,value:gk}]},{type:a,value:"这个范围，阻塞新增的age=15。所以在Innodb下的可重复读并不会出现幻读"}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"串行化"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:"b树"},children:[{type:b,tag:j,props:{href:"#b%E6%A0%91",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"B+树"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:au,props:{alt:ab,"data-src":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20200609\u002Fpic4.zhimg.com-v2-7d3ce97965d423662372d63858d9a04f_r.jpg.JPEG"},children:[]},{type:a,value:"\nB+树是多叉树，每一个节点对应一块磁盘块，包含着大量的子节点的磁盘块指针。\n每一次查找读取一块磁盘块，通过二分法查找子节点，直到叶子节点，查询到具体数据的指针。\n具体数据的指针都在叶子节点里，非叶子节点不保存具体数据的指针，增加非叶子节点的子节点数量。使得B+树能更加矮，减少IO次数。"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"索引字段尽量要小，增加非叶子节点的子节点数量"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"对于联合索引，B+树会按联合索引的字段顺序构建树"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"尽量选择辨识度高（包含虽然值少但偏差大的）的字段做索引并排在联合索引的前面"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"尽量拓展现有索引，而不是新建索引"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:oR},children:[{type:b,tag:j,props:{href:"#%E6%9C%80%E5%B7%A6%E5%8C%B9%E9%85%8D%E5%8E%9F%E5%88%99",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:oR}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"联合索引的where必须从左到右连续。但=和in可以乱序，mysql会帮忙调整顺序"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"like的通配符%不出现在开头"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"范围查询(\u003E、\u003C、between、like)可以用到索引，但是范围列后面的列无法用到索引"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"查询条件中不得含有函数或表达式"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:oS},children:[{type:b,tag:j,props:{href:"#explain%E5%AD%97%E6%AE%B5%E5%90%AB%E4%B9%89",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:oS}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[cl,P]},children:[{type:b,tag:y,props:{},children:[{type:a,value:"mysql"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:R}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:"explain"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bi}]},{type:a,value:" countryCode"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:"status"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aV}]},{type:a,value:oT},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:dZ}]},{type:a,value:" updateDate "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:R}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'2020-06-09'"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aB}]},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:gl}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:dY},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:" select_type "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bs}]},{type:a,value:"        "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:cW}]},{type:a,value:dX},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:" possible_keys "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bm}]},{type:a,value:"     "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:" key_len "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:" ref  "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:oU}]},{type:a,value:aX},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:" Extra                 "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aB}]},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:gl}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:dX},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:"SIMPLE"}]},{type:a,value:"      "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:oT},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:" range "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:" updtidx       "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:" updtidx "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:fz}]},{type:a,value:"       "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,aa]},children:[{type:a,value:gb}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:"436018"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:"Using"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:oV}]},{type:a,value:" condition "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ag}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aB}]},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:gl}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:"row"}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bE}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bC}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:"0.00"}]},{type:a,value:" sec"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"id：查询序号，数字越大越先执行"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"select_type：查询类型\n"},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"SIMPLE：简单SELECT(不使用UNION或子查询)"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"PRIMARY：最外层的SELECT"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"UNION：UNION中第二个或之后的SELECT语句"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"DEPENDENT UNION：UNION中第二个或之后的SELECT语句，取决于外面的查询"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"UNION RESULT：UNION的结果"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"SUBQUERY：子查询中的第一个SELECT"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"DEPENDENT SUBQUERY：子查询中的第一个SELECT, 取决于外面的查询"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"DERIVED：衍生表(FROM子句中的子查询)"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"MATERIALIZED：物化子查询"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"UNCACHEABLE SUBQUERY：结果集无法缓存的子查询，必须重新评估外部查询的每一行"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"UNCACHEABLE UNION：UNION中第二个或之后的SELECT，属于无法缓存的子查询"}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"table：表名"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"partitions：匹配的分区"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:ac,props:{},children:[{type:a,value:cW}]},{type:a,value:"：查询方式，从好到坏\n"},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"system：只有一行数据或者是空表，且只能用于MyISAM和memory表，Innodb在这个情况通常都是all或者index"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:ac,props:{},children:[{type:a,value:"const"}]},{type:a,value:"：最多只有一行记录匹配，唯一索引等于常量值时"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:ac,props:{},children:[{type:a,value:"eq_ref"}]},{type:a,value:"：最多只有一行记录匹配，唯一索引等于非常量值时"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:ac,props:{},children:[{type:a,value:"ref"}]},{type:a,value:"：用到索引但不是唯一索引"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"fulltext：全文索引"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"ref_or_null：在ref基础上加了NULL的比较"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"index_merge：查询使用了两个或以上索引，常见and or使用了不同索引，最后取交并集"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"unique_subquery："},{type:b,tag:y,props:{},children:[{type:a,value:"where in (子查询)"}]},{type:a,value:"，子查询返回不重复值唯一值"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"index_subquery：类似于unique_subquery。适用于非唯一索引，可以返回重复值"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:ac,props:{},children:[{type:a,value:fX}]},{type:a,value:"：索引范围查询"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:ac,props:{},children:[{type:a,value:oV}]},{type:a,value:"：通过索引扫描全表。如果是索引覆盖，Extra会有Using index。否则回表的话没有Using index"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:ac,props:{},children:[{type:a,value:"all"}]},{type:a,value:"：全表扫描"}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:ac,props:{},children:[{type:a,value:"prossible_keys"}]},{type:a,value:"：可能会选择的索引"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:ac,props:{},children:[{type:a,value:bm}]},{type:a,value:"：实际选择的索引"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"key_len：索引的长度。单索引则是索引长度，联合索引则是用到多少个字段算多长"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"ref：与索引作比较的列"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:ac,props:{},children:[{type:a,value:oU}]},{type:a,value:"：要检索的行数(估算值)"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"filtered：查询条件过滤的行数的百分比"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:ac,props:{},children:[{type:a,value:"Extra"}]},{type:a,value:"：额外信息\n"},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:ac,props:{},children:[{type:a,value:"distinct"}]},{type:a,value:"：select使用了distinct关键字"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:ac,props:{},children:[{type:a,value:"Using filesort"}]},{type:a,value:"：表示不能通过索引进行排序，需另外排序"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:ac,props:{},children:[{type:a,value:"Using index"}]},{type:a,value:"：索引覆盖"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"Using temporary：使用了零时表，一般出现于排序, 分组和多表join"}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:oW},children:[{type:b,tag:j,props:{href:"#%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:oW}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"主库将修改写入binlog文件"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"从库连接到主库，会起一个IO线程把binlog复制到自己的中继日志中"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"然后再起一个SQL线程从中继日志中读取执行binlog的的命令"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"一般延迟几十或几百毫秒，如果此时主库挂了，数据就丢失了\n"},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"半同步复制：主库写入binlog之后强制数据立即同步到从库，至少有一个从库确认同步了才算写入成功"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"并行复制：起多个SQL线程来执行中继日志"}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:oX},children:[{type:b,tag:j,props:{href:"#%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:oX}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"一个表控制在两百万以内，一个库最好一千QPS，最多两千QPS。"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"水平拆分：同样的表结构拆分到多个库里"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"垂直拆分：把字段拆分到多个表里，将高频字段与低频字段拆到不同表里"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"分库分表路由："}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"每个库都是连续的数据。但对于时间分段就可能都访问最新的热数据，负载不均匀"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"用某个字段来hash，不过扩容要做数据迁移"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"分库分表过度："}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"双写-\u003E导数据(检查版本号)"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"分库分表主键："}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"主键id自增步长"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"redis自增"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:oY},children:[{type:b,tag:j,props:{href:"#%E4%BC%98%E5%8C%96",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:oY}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"表设计优化\n"},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"使用整型表示枚举字符串"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"尽量不使用null，索引里null被认为是最小值，会被放在最左边，如果有大量null会降低索引性能"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"尽量别"},{type:b,tag:y,props:{},children:[{type:a,value:"select *"}]},{type:a,value:"，尽量"},{type:b,tag:y,props:{},children:[{type:a,value:"count(*)"}]}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"货币数据使用decimal"}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"索引优化：如上"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"读写分离：如上"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"分库分表：如上"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:"innodb与myisam"},children:[{type:b,tag:j,props:{href:"#innodb%E4%B8%8Emyisam",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"InnoDB与MyISAM"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"InnoDB是聚集索引，即索引跟数据在一起。必须有主键(没有会自建一个隐藏的)，非主键-\u003E二级索引-\u003E主键-\u003E一级索引-\u003E数据。\n而MyISAM的索引则是保存数据文件的指针。"}]},{type:a,value:"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{type:b,tag:bs,props:{},children:[{type:b,tag:bx,props:{},children:[{type:b,tag:Y,props:{},children:[{type:b,tag:aC,props:{},children:[]},{type:b,tag:aC,props:{},children:[{type:a,value:"InnoDB"}]},{type:b,tag:aC,props:{},children:[{type:a,value:"MyISAM"}]}]}]},{type:b,tag:by,props:{},children:[{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:"存储结构"}]},{type:b,tag:K,props:{},children:[{type:a,value:"索引和数据都保存在一个文件里"}]},{type:b,tag:K,props:{},children:[{type:a,value:"分为表结构、索引和数据三个文件"}]}]},{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:"事务"}]},{type:b,tag:K,props:{},children:[{type:a,value:oZ}]},{type:b,tag:K,props:{},children:[{type:a,value:o_}]}]},{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:"全文索引"}]},{type:b,tag:K,props:{},children:[{type:a,value:o_}]},{type:b,tag:K,props:{},children:[{type:a,value:oZ}]}]},{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:"锁"}]},{type:b,tag:K,props:{},children:[{type:a,value:"表锁和行锁"}]},{type:b,tag:K,props:{},children:[{type:a,value:"表锁"}]}]},{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:"CURD"}]},{type:b,tag:K,props:{},children:[{type:a,value:"偏向于写"}]},{type:b,tag:K,props:{},children:[{type:a,value:"偏向于读"}]}]},{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:o$}]},{type:b,tag:K,props:{},children:[{type:a,value:"相对容易"}]},{type:b,tag:K,props:{},children:[{type:a,value:"相对困难"}]}]}]}]},{type:a,value:e},{type:b,tag:w,props:{id:"binlog"},children:[{type:b,tag:j,props:{href:"#binlog",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"Binlog"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"Binlog会记录每一个更新操作，作为一个事件。在记录模式上分为三类："}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"statement：记录所执行的SQL"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"row：记录每一行数据的变化字段的前后值"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"mixed：statement和row的混合模式"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"使用场景："}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"读写分离：主从同步"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:o$}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"数据同步：binlog-\u003EMQ-其他服务(redis、ES)。使用binlog同步组件拉取。"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"异地多活：主键冲突、数据回环问题"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:aK}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Ftech.meituan.com\u002F2014\u002F06\u002F30\u002Fmysql-index.html",rel:[A,B,C],target:D},children:[{type:a,value:"MySQL索引原理及慢查询优化"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fblog.csdn.net\u002Ftb3039450\u002Farticle\u002Fdetails\u002F66475638",rel:[A,B,C],target:D},children:[{type:a,value:"MySQL InnoDB中的行锁 Next-Key Lock消除幻读"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fwww.jianshu.com\u002Fp\u002F8fab76bbf448",rel:[A,B,C],target:D},children:[{type:a,value:"explain结果每个字段的含义说明"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"http:\u002F\u002Fjimolonely.github.io\u002F2019\u002F09\u002F24\u002Fdb\u002F011-mysql-decimal\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"mysql decimal用法与问题"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fjuejin.im\u002Fpost\u002F5d5defc2518825591523a1db",rel:[A,B,C],target:D},children:[{type:a,value:"MySQL中IS NULL、IS NOT NULL、!=不能用索引？胡扯！"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fwww.jianshu.com\u002Fp\u002Fa957b18ba40d",rel:[A,B,C],target:D},children:[{type:a,value:"MySQL存储引擎－－MyISAM与InnoDB区别"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fxushanxiang.com\u002F2019\u002F11\u002Fthe-difference-between-mysql-storage-engine-myisam-and-innodb.html",rel:[A,B,C],target:D},children:[{type:a,value:"MySQL存储引擎MyISAM和InnoDB有哪些区别？"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"http:\u002F\u002Fwww.jiangxinlingdu.com\u002Fmysql\u002F2019\u002F06\u002F07\u002Fbinlog.html",rel:[A,B,C],target:D},children:[{type:a,value:"mysql binlog应用场景与原理深度剖析"}]}]}]},excerpt:{type:S,children:[]},dir:pa,path:"\u002F中间件\u002F20200609\u002FMySQL总结",extension:ap,title:oN,url:"\u002Fblog-code\u002Fview\u002F$E4$B8$AD$E9$97$B4$E4$BB$B6\u002F20200609\u002FMySQL$E6$80$BB$E7$BB$93\u002F",createAt:new Date(1591660800000),updateAt:new Date(1591660800000),attributes:[{name:aq,value:pb},{name:ar,value:pb},{name:as,value:pa,url:"\u002Fblog-code\u002Fpage\u002F$E4$B8$AD$E9$97$B4$E4$BB$B6\u002F20200609\u002F1\u002F"}]},{slug:pc,description:"java内存模型(JMM)\nJMM模型下，每个线程都有自己的本地内存，线程对内存的操作也是先操作本地内存。\n之后才将本地内存的数据刷新到主内存里，让各个线程更新共享。",createdAt:pd,updatedAt:pd,toc:[{id:em,depth:_,text:em},{id:en,depth:_,text:en},{id:eo,depth:_,text:eo},{id:ep,depth:_,text:ep},{id:eq,depth:_,text:eq},{id:er,depth:_,text:er},{id:es,depth:_,text:es}],body:{type:S,children:[{type:b,tag:w,props:{id:pe},children:[{type:b,tag:j,props:{href:pf,ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:pg}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:ph}]},{type:a,value:e},{type:a,value:e},{type:b,tag:w,props:{id:pi},children:[{type:b,tag:j,props:{href:"#%E5%86%85%E5%AD%98%E5%B1%8F%E9%9A%9C",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:pi}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"读读屏障：确保"},{type:b,tag:ac,props:{},children:[{type:a,value:"读1"}]},{type:a,value:"读取数据后才进行"},{type:b,tag:ac,props:{},children:[{type:a,value:"读2"}]}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"写写屏障：确保"},{type:b,tag:ac,props:{},children:[{type:a,value:"写1"}]},{type:a,value:pj},{type:b,tag:ac,props:{},children:[{type:a,value:"写2"}]}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"读写屏障：确保"},{type:b,tag:ac,props:{},children:[{type:a,value:pk}]},{type:a,value:"之后才"},{type:b,tag:ac,props:{},children:[{type:a,value:pl}]}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"写读屏障：确保"},{type:b,tag:ac,props:{},children:[{type:a,value:pl}]},{type:a,value:pj},{type:b,tag:ac,props:{},children:[{type:a,value:pk}]}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:pm},children:[{type:b,tag:j,props:{href:"#volatile",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:pm}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"volatile通过写写屏障，确保volatile变量写入后能立即被其他线程可见，并且后面的写不会在volatile之前写入。\n以及双重检查锁定与延迟初始化问题。"}]},{type:a,value:e},{type:b,tag:w,props:{id:bn},children:[{type:b,tag:j,props:{href:"#final",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:bn}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"final通过写写屏障，确保final变量写入后能立即被其他线程可见。\n并且final变量的写入早于对象的赋值写入，确保拿到该对象的线程的final变量已经完成初始化。\n所以如果在构造函数里向其他线程传递"},{type:b,tag:y,props:{},children:[{type:a,value:fi}]},{type:a,value:"，可能会导致final溢出。"}]},{type:a,value:e},{type:b,tag:w,props:{id:pn},children:[{type:b,tag:j,props:{href:"#synchronized",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:pn}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"java对象的内存结构分为三部分：对象头、实例数据、对其填充。\n其中对象头又由markWord、类型指针、数组长度构成。\n其中markWord保存着锁标志位和是否偏向锁，分别表示锁的状态是无锁、偏向锁、轻量级锁、重量级锁。\n而synchronized在这三种锁的升级叫做"},{type:b,tag:ac,props:{},children:[{type:a,value:"锁膨胀"}]},{type:a,value:gK}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:au,props:{alt:ab,"data-src":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20200617\u002Fuser-gold-cdn.xitu.io-2019-3-22-169a410864053e99.jpg.JPEG"},children:[]}]},{type:a,value:e},{type:b,tag:$,props:{id:em},children:[{type:b,tag:j,props:{href:"#%E5%81%8F%E5%90%91%E9%94%81",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:em}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"当锁对象第一次被线程获取时，锁标记位为偏向锁"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"通过CAS把markWord的线程ID指向自己，以后进入锁只需要检查markWord的线程ID是不是指向自己即可"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"如果线程ID不是当前线程，则证明已经有其他线程占有这个偏向锁，等持锁线程到达安全点后挂起线程。"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"如果持锁线程未活动或者已退出同步块，则撤销偏向锁为无锁，唤醒原持锁线程继续执行。\n如果持锁线程还在同步代码块，升级为轻量级锁。对持锁线程执行轻量级锁获取锁过程，唤醒持锁线程继续执行。"}]},{type:a,value:e},{type:b,tag:$,props:{id:en},children:[{type:b,tag:j,props:{href:"#%E8%8E%B7%E5%8F%96%E8%BD%BB%E9%87%8F%E7%BA%A7%E9%94%81",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:en}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"如果对象为无锁或者轻量级锁，在线程的栈帧里创建一个锁记录的空间，用于保存锁对象的markWord"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"通过CAS把锁对象的markWord更新为栈帧里锁记录的指针，如果成功则获取锁，并且将锁记录的锁标记位修改为轻量级锁"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"如果失败，意味着markWord已经被修改过，检查markWord是否指向自己的锁记录，如果是则是重入，获取锁成功"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"如果失败则证明发生了竞争，自适应自旋CAS修改锁记录指针。"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"自适应自旋会根据以前自旋成功率来决定自旋次数，越成功自旋越多，否则可能取消自旋直接挂起。\n5. 如果自旋修改失败，升级为重量级锁。锁标记位修改为重量级锁，markWord指向"},{type:b,tag:y,props:{},children:[{type:a,value:fQ}]},{type:a,value:"对象指针，线程进入阻塞状态"}]},{type:a,value:e},{type:b,tag:$,props:{id:eo},children:[{type:b,tag:j,props:{href:"#%E9%87%8A%E6%94%BE%E8%BD%BB%E9%87%8F%E7%BA%A7%E9%94%81",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:eo}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"通过CAS把锁记录的markWord复制回锁对象，成功则释放锁成功，锁标记恢复为无锁"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"如果失败则证明已经升级为重量级锁，释放锁后唤醒阻塞线程"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:$,props:{id:ep},children:[{type:b,tag:j,props:{href:"#%E9%87%8D%E9%87%8F%E7%BA%A7%E9%94%81",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:ep}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"每个锁对象其实都是一个监视器锁"},{type:b,tag:y,props:{},children:[{type:a,value:fQ}]},{type:a,value:"对象，监视器锁会记录进入数，来实现锁重入。\n在同步代码块里，字节码是通过"},{type:b,tag:y,props:{},children:[{type:a,value:"monitorenter"}]},{type:a,value:"指令获取监视器锁的所有权，和"},{type:b,tag:y,props:{},children:[{type:a,value:"monitorexit"}]},{type:a,value:"指令释放所有权。\n在同步方法里，字节码是通过"},{type:b,tag:y,props:{},children:[{type:a,value:"ACC_SYNCHRONIZED"}]},{type:a,value:"标识，来给JVM标记要去获取监视器锁。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"而监视器锁是依赖操作系统的互斥量"},{type:b,tag:y,props:{},children:[{type:a,value:"mutex"}]},{type:a,value:"，需要将线程从用户态切换到内核态。\n获取锁失败的线程会被放到一个同步队列里面。\n如果释放锁的时候刚好有线程取锁，操作系统会将锁给这个线程，所以重量级锁是非公平锁。\n同时"},{type:b,tag:y,props:{},children:[{type:a,value:"wait()"}]},{type:a,value:"、"},{type:b,tag:y,props:{},children:[{type:a,value:"notify()"}]},{type:a,value:"方法也是依赖于监视器锁，所以调用需要在同步块里。"}]},{type:a,value:e},{type:b,tag:$,props:{id:eq},children:[{type:b,tag:j,props:{href:"#%E9%94%81%E6%B6%88%E9%99%A4",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:eq}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"JVM通过逃逸分析发现某些对象不会发生并发问题，但却加了锁，会去除这个锁。"}]},{type:a,value:e},{type:b,tag:$,props:{id:er},children:[{type:b,tag:j,props:{href:"#%E9%94%81%E4%BC%98%E5%8C%96",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:er}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"读写锁"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"锁粗化：避免反复获取锁，在锁的范围扩大，一次锁处理更多东西"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"减少锁的颗粒度"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"减少锁的持有时间"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:po},children:[{type:b,tag:j,props:{href:"#%E9%98%9F%E5%88%97%E5%90%8C%E6%AD%A5%E5%99%A8",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:po}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"队列同步器（AbstractQueuedSynchronizer）是实现各种Lock和并发工具的核心。\n队列同步器最主要是通过一个volatile的int变量来表示锁状态，和维护一个队列用于保存等待锁的线程。\n一般我们是通过继承队列同步器，去重写他的模板方法，在模板方法里通过CAS去修改锁状态。\n模板方法分为两类，独占式和共享式。"}]},{type:a,value:or},{type:b,tag:bs,props:{},children:[{type:b,tag:bx,props:{},children:[{type:b,tag:Y,props:{},children:[{type:b,tag:aC,props:{},children:[{type:a,value:"锁标记方法"}]},{type:b,tag:aC,props:{},children:[{type:a,value:pp}]}]}]},{type:b,tag:by,props:{},children:[{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:"int getState()"}]},{type:b,tag:K,props:{},children:[{type:a,value:"获取锁标记"}]}]},{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:"void setState(int)"}]},{type:b,tag:K,props:{},children:[{type:a,value:"设置锁标记"}]}]},{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:"boolean compareAndSetState(int expect,int update)"}]},{type:b,tag:K,props:{},children:[{type:a,value:"CAS锁标记"}]}]}]}]},{type:a,value:"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{type:b,tag:bs,props:{},children:[{type:b,tag:bx,props:{},children:[{type:b,tag:Y,props:{},children:[{type:b,tag:aC,props:{},children:[{type:a,value:"模板方法"}]},{type:b,tag:aC,props:{},children:[{type:a,value:pp}]}]}]},{type:b,tag:by,props:{},children:[{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:"boolean tryAcquire(int)"}]},{type:b,tag:K,props:{},children:[{type:a,value:"独占式，尝试，获取锁"}]}]},{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:"boolean tryRelease(int)"}]},{type:b,tag:K,props:{},children:[{type:a,value:"独占式，尝试，释放锁"}]}]},{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:"boolean tryAcquireShared(int)"}]},{type:b,tag:K,props:{},children:[{type:a,value:"共享式，尝试，获取锁"}]}]},{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:"boolean tryReleaseShared(int)"}]},{type:b,tag:K,props:{},children:[{type:a,value:"共享式，尝试，释放锁"}]}]},{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:"boolean isHeldExclusively()"}]},{type:b,tag:K,props:{},children:[{type:a,value:"锁是否被当前线程独占"}]}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"以重入锁为例，当调用锁方法的时候，会调用尝试获取锁方法。\n还没有加锁就通过CAS尝试加锁。如果加锁了锁，就判断持锁线程是不是当前线程，是的话就锁标记+1重入。\n而重入锁支持非公平锁和公平锁，非公平锁会先通过CAS抢锁。\n而公平锁则先判断等待队列里是否有线程在等待，有的话则不去抢锁。\n如果CAS获取锁失败的话，AQS会把线程封装到等待队列的节点里，通过CAS把节点加到队尾。\n线程被加到队尾之后，会有个去死循环判断："}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"前置节点是不是头结点（头结点不记数据），是的话就通过CAS拿锁，失败继续循环"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"前置节点是不是在休眠状态，是的话自己也休眠，等待唤醒，调用"},{type:b,tag:y,props:{},children:[{type:a,value:"LockSupport.park()"}]}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"如果醒来发现自己被interrupt的话，返回获取锁失败，并interrupt自己，保存interrupt状态为true"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"释放锁会调用尝试释放锁方法，如果当前线程不是持锁线程则抛异常，否则修改锁标记。\n修改成功之后回去唤醒等待队列里最前面的还在等待获取锁的线程。"}]},{type:a,value:e},{type:b,tag:w,props:{id:"juc"},children:[{type:b,tag:j,props:{href:"#juc",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"JUC"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"Semaphore（信号量）：控制并发量。通过锁标记来记录并发数。"},{type:b,tag:y,props:{},children:[{type:a,value:"acquire()"}]},{type:a,value:"方法获取锁，"},{type:b,tag:y,props:{},children:[{type:a,value:"release()"}]},{type:a,value:"方法释放锁。"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"CountDownLatch（减数门栓）：锁标记记录未完成剩余计数。线程完成后调用"},{type:b,tag:y,props:{},children:[{type:a,value:"countDown()"}]},{type:a,value:"计数-1，直到计数为0，唤醒被"},{type:b,tag:y,props:{},children:[{type:a,value:pq}]},{type:a,value:"阻塞的线程。\n例如主线程需要等待多个组件加载完成，或者一个线程指挥多个线程同时开始。\n但是CountDownLatch的计数无法重置，所以CountDownLatch对象是一次性的。"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"CyclicBarrier（循环栅栏）：锁标记记录未完成剩余计数。线程调用"},{type:b,tag:y,props:{},children:[{type:a,value:pq}]},{type:a,value:"计数-1并阻塞，直到全部线程完成，计数为0才被唤醒。\n多线程计算，并发计算完成一步之后，在计算下一步。\nCyclicBarrier有reset功能，可以多次使用。"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:$,props:{id:es},children:[{type:b,tag:j,props:{href:"#%E9%94%81%E5%8D%87%E7%BA%A7%E4%B8%8E%E9%94%81%E9%99%8D%E7%BA%A7",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:es}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"锁降级发生于读写锁，当我们检查数据后发现需要修改数据的情形。\n因此我们需要先获取读锁检查数据，再使用写锁修改数据。\n但如果是先释放读锁再去获取写锁，则可能会有其他线程在这个空缺时间里拿到写锁修改了数据。\n所以是获取读锁-\u003E检查数据-\u003E获取写锁-\u003E释放读锁-\u003E修改数据-\u003E释放写锁。\n这里的在持有读锁状态下获取写锁，然后释放读锁保留写锁，即读锁-\u003E写锁，就叫做锁升级。\n反之，如果是持有写锁状态下去获取读锁，然后释放写锁保留读锁，即写锁-\u003E读锁，则叫做锁降级。\n无论是锁升级还是锁降级，目的都是确保读写的数据的一致性，有点像一个事务。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:aK}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"《深入理解Java虚拟机_JVM高级特性与最佳实践_第3版_周志明》"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fjuejin.im\u002Fpost\u002F5c936018f265da60ec281bcb",rel:[A,B,C],target:D},children:[{type:a,value:"深入分析synchronized原理和锁膨胀过程(二)"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Ftech.meituan.com\u002F2018\u002F11\u002F15\u002Fjava-lock.html",rel:[A,B,C],target:D},children:[{type:a,value:"不可不说的Java“锁”事"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"http:\u002F\u002Flitroi.com\u002Fpublic\u002FarticleDetail?artId=20181015154804936010000",rel:[A,B,C],target:D},children:[{type:a,value:"并发之AQS原理(三)+如何保证并发"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fjuejin.im\u002Fpost\u002F5c739c5cf265da2dd8689b46",rel:[A,B,C],target:D},children:[{type:a,value:"AQS原理学习笔记"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fgithub.com\u002FSnailclimb\u002FJavaGuide\u002Fblob\u002Fmaster\u002Fdocs\u002Fjava\u002FMultithread\u002FAQS.md",rel:[A,B,C],target:D},children:[{type:a,value:"AQS.md"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Ftech.meituan.com\u002F2019\u002F12\u002F05\u002Faqs-theory-and-apply.html",rel:[A,B,C],target:D},children:[{type:a,value:"从ReentrantLock的实现看AQS的原理及应用"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fcode.cellargalaxy.top\u002Farticle\u002Fjava\u002F20180204\u002Fjava%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E7%9A%84%E8%89%BA%E6%9C%AF%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"java并发编程的艺术学习笔记"}]}]}]},excerpt:{type:S,children:[{type:b,tag:w,props:{id:pe},children:[{type:b,tag:j,props:{ariaHidden:q,href:pf,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:pg}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:ph}]}]},dir:pr,path:"\u002Fjava\u002F20200617\u002FJava并发",extension:ap,title:pc,url:"\u002Fblog-code\u002Fview\u002Fjava\u002F20200617\u002FJava$E5$B9$B6$E5$8F$91\u002F",createAt:new Date(1592352000000),updateAt:new Date(1592352000000),attributes:[{name:aq,value:ps},{name:ar,value:ps},{name:as,value:pr,url:"\u002Fblog-code\u002Fpage\u002Fjava\u002F20200617\u002F1\u002F"}]},{slug:pt,description:"服务接入\nAPI网关最重要的功能就是提供服务的统一接入。\n通常是外部服务统一经过API网关请求到内部不同的服务。\n这样内部服务不会直接暴露在外部，保护了内部服务的安全。\n外部服务也只需要面向API网关进行对接即可，不用跟内部各种异构的服务打交道。",createdAt:et,updatedAt:et,toc:[],body:{type:S,children:[{type:b,tag:w,props:{id:eu},children:[{type:b,tag:j,props:{href:pu,ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:eu}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:pv}]},{type:a,value:e},{type:a,value:e},{type:b,tag:w,props:{id:pw},children:[{type:b,tag:j,props:{href:"#%E5%BC%82%E6%AD%A5%E8%AF%B7%E6%B1%82",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:pw}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"API网关流量往往很大，为了能达到更大的吞吐量，需要使用IO多路复用。\n一般有Tomcat+NIO和Netty+NIO两种实现。Netty需要自己处理HTTP，但是Netty性能比Tomcat高。"}]},{type:a,value:e},{type:b,tag:w,props:{id:px},children:[{type:b,tag:j,props:{href:"#%E9%93%BE%E5%BC%8F%E5%A4%84%E7%90%86",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:px}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"API网关除了提供统一的接入以外，还能对请求做一些统一的处理。\n使用责任链模式，在反代的处理链设置前置过滤器、路由过滤器、后置过滤器和异常过滤器。\n可以灵活对请求进行自定义处理。"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"请求鉴权：服务鉴权一般与业务逻辑无关，统一在API网关里进行鉴权以保护内部服务"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"请求监控：对请求的数量，时间等信息进行上报监控"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"请求缓存：对于一些幕等的请求，可以缓存在网关里，减少内部服务的压力"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"协议转换：如果内部服务的rpc调用使用的是非http协议，那么就要将rpc转换为http"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"流量控制"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"熔断降级"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:py},children:[{type:b,tag:j,props:{href:"#%E4%B8%9A%E5%8A%A1%E9%9A%94%E7%A6%BB",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:py}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"信号量隔离：信号量隔离只是限制了总的并发数，如果有服务超时了，依然会把全部并发数给占用了，影响其他正常的服务"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"线程池隔离：不同业务之间使用不同的线程池来进行隔离。即时某个业务出现问题，也只会占满自己的线程池，而不会影响到其他业务"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"集群隔离：不同的集群提供不同的服务，通过集群本身进行隔离"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:pz},children:[{type:b,tag:j,props:{href:"#%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:pz}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"对上面API网关的功能进行配置和监控。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:aK}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fgithub.com\u002FSnailclimb\u002FJavaGuide\u002Fblob\u002Fmaster\u002Fdocs\u002Fsystem-design\u002Fmicro-service\u002FAPI%E7%BD%91%E5%85%B3.md",rel:[A,B,C],target:D},children:[{type:a,value:"API网关.md"}]}]}]},excerpt:{type:S,children:[{type:b,tag:w,props:{id:eu},children:[{type:b,tag:j,props:{ariaHidden:q,href:pu,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:eu}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:pv}]}]},dir:ev,path:"\u002F分布式\u002F20200703\u002FAPI网关总结",extension:ap,title:pt,url:"\u002Fblog-code\u002Fview\u002F$E5$88$86$E5$B8$83$E5$BC$8F\u002F20200703\u002FAPI$E7$BD$91$E5$85$B3$E6$80$BB$E7$BB$93\u002F",createAt:new Date(1593734400000),updateAt:new Date(1593734400000),attributes:[{name:aq,value:ew},{name:ar,value:ew},{name:as,value:ev,url:pA}]},{slug:pB,description:ab,createdAt:et,updatedAt:et,toc:[],body:{type:S,children:[{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"下面所说到的并发数，除了考虑请求接受的速度以外，还需要考虑每个请求的处理时间的。\n但是为了方便讨论，这里就假设这些请求都能在较短的时间内完成，在合理的请求速度下，请求不会因为处理时间过长而堆积。"}]},{type:a,value:e},{type:b,tag:w,props:{id:pC},children:[{type:b,tag:j,props:{href:"#%E5%9B%BA%E5%AE%9A%E7%AA%97%E5%8F%A3%E8%AE%A1%E6%95%B0%E5%99%A8",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:pC}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"例如每秒钟限制20个请求，每一秒为一个窗口，计数器记录一秒钟的请求数量，超过20次则触发限流，到下一秒计数器重置。\n固定窗口计数器能控制总的请求数，但是并发数可能会是请求数的两倍。\n例如第一秒的最后面和第二秒的最前面集中了这40次的请求，那么最大并发数就可能是40。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:au,props:{alt:ab,"data-src":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20200703\u002Fstatic001.infoq.cn-resource-image-8d-15-8ded7a2b90e1482093f92fff555b3615.png.JPEG"},children:[]}]},{type:a,value:e},{type:b,tag:w,props:{id:pD},children:[{type:b,tag:j,props:{href:"#%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3%E8%AE%A1%E6%95%B0%E5%99%A8",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:pD}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"例如每秒钟限制20个请求，滑动窗口大小为一秒，将每秒划分为十个区间，并且会保存最近的十个区间的请求数量。\n当请求来的时候，会对最近十个区间进行求和。如果和大于20次，则触发限流。\n滑动窗口计数器只是固定窗口计数器的平滑版本，区间越小，平滑程度越高所需的储存空间也越大。\n但是固定窗口计数器有的问题他依然有。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:au,props:{alt:ab,"data-src":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20200703\u002Fstatic001.infoq.cn-resource-image-4d-f4-4d03e8e43a8edc3f32376d90e52b85f4.png.JPEG"},children:[]}]},{type:a,value:e},{type:b,tag:w,props:{id:pE},children:[{type:b,tag:j,props:{href:"#%E6%BC%8F%E6%A1%B6%E7%AE%97%E6%B3%95",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:pE}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"将请求都放进大小有限的队列（桶）里面，然后以固定的速度从队列里取出请求进行处理（漏桶），如果队列慢了则触发限流。\n漏桶算法虽然控制了请求数和并发数，但是当一开始没有请求，然后突然有大量请求，却依然慢吞吞的固定速度取请求。\n导致一开始有的资源空闲着，有的请求在等待，降低了吞吐。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:au,props:{alt:ab,"data-src":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20200703\u002Fstatic001.infoq.cn-resource-image-75-03-75938d1010138ce66e38c6ed0392f103.png.JPEG"},children:[]}]},{type:a,value:e},{type:b,tag:w,props:{id:pF},children:[{type:b,tag:j,props:{href:"#%E4%BB%A4%E7%89%8C%E6%A1%B6%E7%AE%97%E6%B3%95",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:pF}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"令牌以固定的速度生成，放在大小有限的桶里，桶满了则令牌丢弃。每个请求都往桶里取令牌，取不到令牌则触发限流。\n令牌算法既能控制请求数量，由令牌的生成速度决定。\n又能承受突发的大量请求，这个由桶的大小决定，并且桶的大小决定了最大并发数。\n假设一开始没有请求，然后突然大量请求，桶里满的令牌一下子就被拿完了，达到最大并发数，并且触发了限流。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:au,props:{alt:ab,"data-src":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20200703\u002Fstatic001.infoq.cn-resource-image-ec-93-eca0e5eaa35dac938c673fecf2ec9a93.png.JPEG"},children:[]}]},{type:a,value:e},{type:b,tag:w,props:{id:pG},children:[{type:b,tag:j,props:{href:"#%E4%BB%A4%E7%89%8C%E6%A1%B6%E7%AE%97%E6%B3%95%E7%9A%84%E5%AE%9E%E7%8E%B0",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:pG}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"令牌桶算法是使用比较广泛的限流算法，可以使用redis的lua脚本实现。lua大致的思路是："}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"根据key获取令牌剩余数量和上次获取令牌时间"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"如果是第一次获取令牌，默认桶满，令牌取一，更新获取时间，返回成功"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"根据令牌剩余数量、令牌增长速度、上次获取令牌时间和当前时间，计算到现在令牌应该增长到的数量"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"判断还有没有令牌可取，没有则返回失败"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"有令牌则取一，更新获取时间，返回成功"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"具体的lua脚本这里先贴《分布式服务限流实战，已经为你排好坑了》和《基于redis的分布式限流方案》。\n这两个脚本感觉可以合并一下（待续）"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"《分布式服务限流实战，已经为你排好坑了》"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,fv]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ay}]},{type:a,value:" ratelimit_info "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:ca},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"pcall"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'HMGET'"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:cL},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:pH}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:pI}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ay}]},{type:a,value:" last_time "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:" ratelimit_info"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ay}]},{type:a,value:pJ},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bk}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:"ratelimit_info"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:av}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ay}]},{type:a,value:" max_token "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bk}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:co},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ay}]},{type:a,value:" token_rate "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bk}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:co},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:av}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ay}]},{type:a,value:" current_time "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bk}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:co},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:bh}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"-- 生成每个令牌所需要的时间"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ay}]},{type:a,value:" reverse_time "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:"1000"}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ce}]},{type:a,value:"token_rate\n"},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bc}]},{type:a,value:pJ},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:kr}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:pK}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bG}]},{type:a,value:gm},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:" max_token\n  last_time "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:" current_time\n"},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:fw}]},{type:a,value:cp},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ay}]},{type:a,value:" past_time "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:" current_time"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:a$}]},{type:a,value:pL},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ay}]},{type:a,value:" reverse_token "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:gn},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"floor"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:"past_time"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ce}]},{type:a,value:pM},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:gm},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:go},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aB}]},{type:a,value:"reverse_token\n  "},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"-- 注意这里需要对last_time进行修正"}]},{type:a,value:"\n  last_time "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:" reverse_time"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aQ}]},{type:a,value:"reverse_token"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aB}]},{type:a,value:pL},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bc}]},{type:a,value:go},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:R}]},{type:a,value:"max_token "},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bG}]},{type:a,value:"\n    current_token "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:" max_token\n  "},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bH}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bH}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ay}]},{type:a,value:dq},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:aI}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bc}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:gp},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:R}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:aI}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bG}]},{type:a,value:"\n  result "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:a,value:gm},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:go},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:a$}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bH}]},{type:a,value:cM},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bd}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'HMSET'"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:cL},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:pH}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:pN},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:pI}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:gp},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"-- 感觉设不设置过期时间都可以"}]},{type:a,value:cM},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bd}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'pexpire'"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:cL},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:"math"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"ceil"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:pM},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aQ}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:"max_token"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:a$}]},{type:a,value:gp},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aB}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:"current_time"},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:a$}]},{type:a,value:pN},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:" result\n"}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"《基于redis的分布式限流方案》"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,fv]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"-- key"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ay}]},{type:a,value:" key "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:cC},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"-- 最大存储的令牌数"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ay}]},{type:a,value:" max_permits "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bk}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:cL},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:av}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"-- 每秒钟产生的令牌数"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ay}]},{type:a,value:" permits_per_second "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bk}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:cL},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:bh}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"-- 请求的令牌数"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ay}]},{type:a,value:pO},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bk}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:co},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:aA},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"-- 下次请求可以获取令牌的起始时间"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ay}]},{type:a,value:gq},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bk}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:bZ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bd}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:pP}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:bb},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:pQ}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:pR}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:aI}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:aA},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"-- 当前时间"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ay}]},{type:a,value:" time "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:ca},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bd}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'time'"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ay}]},{type:a,value:" now_micros "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bk}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:pS},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:T}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aQ}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:pT}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aB}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bk}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:pS},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:av}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:aA},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"-- 查询获取令牌是否超时"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bc}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:co},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:av}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ko}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:pK}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bG}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"-- 获取令牌的超时时间"}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ay}]},{type:a,value:" timeout_micros "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bk}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:co},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:W}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:av}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:X}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ay}]},{type:a,value:" micros_to_wait "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:gq},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:a$}]},{type:a,value:" now_micros\n    "},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bc}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:"micros_to_wait "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:R}]},{type:a,value:" timeout_micros"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bG}]},{type:a,value:ak},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:" micros_to_wait\n    "},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bH}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bH}]},{type:a,value:aA},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"-- 当前存储的令牌数"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ay}]},{type:a,value:gr},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bk}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:bZ},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bd}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:pP}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:bb},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:pU}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:pR}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:aI}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"-- 添加令牌的时间间隔"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ay}]},{type:a,value:" stable_interval_micros "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:pT}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ce}]},{type:a,value:" permits_per_second\n\n"},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"-- 补充令牌"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bc}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:pV},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:R}]},{type:a,value:pW},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bG}]},{type:a,value:G},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ay}]},{type:a,value:" new_permits "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:pV},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:a$}]},{type:a,value:pW},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:ce}]},{type:a,value:" stable_interval_micros\n    stored_permits "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:gn},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:pX}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:"max_permits"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:gr},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aB}]},{type:a,value:" new_permits"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:"\n    next_free_ticket_micros "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:pY},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bH}]},{type:a,value:aA},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"-- 消耗令牌"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ay}]},{type:a,value:pZ},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:" next_free_ticket_micros\n"},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ay}]},{type:a,value:" stored_permits_to_spend "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:gn},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:pX}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:a,value:"required_permits"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:" stored_permits"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ay}]},{type:a,value:p_},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:pO},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:a$}]},{type:a,value:p$},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:ay}]},{type:a,value:" wait_micros "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:p_},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aQ}]},{type:a,value:" stable_interval_micros\n\nredis"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:"replicate_commands"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:cM},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bd}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:qa}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:bb},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:pU}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:gr},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:a$}]},{type:a,value:p$},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:cM},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bd}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:qa}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:bb},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:pQ}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:gq},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:aB}]},{type:a,value:" wait_micros"},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:cM},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:u}]},{type:b,tag:c,props:{className:[d,l]},children:[{type:a,value:bd}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,z]},children:[{type:a,value:"'expire'"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:bb},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:ba}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:a,value:aA},{type:b,tag:c,props:{className:[d,H]},children:[{type:a,value:"-- 返回需要等待的时间长度"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:af}]},{type:a,value:pZ},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:a$}]},{type:a,value:pY}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"如果是acquire方法，执行下面，redis将返回获取请求成功后，线程需要等待的微秒数"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,bt]},children:[{type:b,tag:y,props:{},children:[{type:a,value:"eval 'lua脚本' 3 '自定义的key' '最大存储的令牌数' '每秒钟产生的令牌数' '请求的令牌数'\n"}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"如果是tryAcquire方法，执行下面，redis同样返回需要等待的微秒数，将该返回值与最大等待微秒数做比较，如果redis返回的值较大，则说明失败；反之则是成功，并根据返回值让线程等待。"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[P,bt]},children:[{type:b,tag:y,props:{},children:[{type:a,value:"eval 'lua脚本' 3 '自定义的key' '最大存储的令牌数' '每秒钟产生的令牌数' '请求的令牌数' '最大等待的微秒数'\n"}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:aK}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fwww.infoq.cn\u002Farticle\u002FQg2tX8fyw5Vt-f3HH673",rel:[A,B,C],target:D},children:[{type:a,value:"分布式服务限流实战，已经为你排好坑了"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fblog.wangqi.love\u002Farticles\u002FJava\u002F%E9%99%90%E6%B5%81%E6%8A%80%E6%9C%AF%E6%80%BB%E7%BB%93.html",rel:[A,B,C],target:D},children:[{type:a,value:"限流技术总结"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fblog.wangqi.love\u002Farticles\u002FJava\u002F%E5%9F%BA%E4%BA%8Eredis%E7%9A%84%E5%88%86%E5%B8%83%E5%BC%8F%E9%99%90%E6%B5%81%E6%96%B9%E6%A1%88.html",rel:[A,B,C],target:D},children:[{type:a,value:"基于redis的分布式限流方案"}]}]}]},excerpt:{type:S,children:[]},dir:ev,path:"\u002F分布式\u002F20200703\u002F分布式限流",extension:ap,title:pB,url:"\u002Fblog-code\u002Fview\u002F$E5$88$86$E5$B8$83$E5$BC$8F\u002F20200703\u002F$E5$88$86$E5$B8$83$E5$BC$8F$E9$99$90$E6$B5$81\u002F",createAt:new Date(1593734400000),updateAt:new Date(1593734400000),attributes:[{name:aq,value:ew},{name:ar,value:ew},{name:as,value:ev,url:pA}]},{slug:qb,description:ab,createdAt:qc,updatedAt:qc,toc:[{id:qd,depth:_,text:gs},{id:qe,depth:_,text:gt},{id:qf,depth:_,text:gu},{id:qg,depth:_,text:gv},{id:qh,depth:_,text:gw},{id:qi,depth:_,text:gx},{id:qj,depth:_,text:gy}],body:{type:S,children:[{type:a,value:e},{type:b,tag:w,props:{id:qk},children:[{type:b,tag:j,props:{href:"#%E4%BA%8B%E5%8A%A1%E4%BC%A0%E6%92%AD%E8%A1%8C%E4%B8%BA",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:qk}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"事务传播行为用于表示一个事务里嵌套了另外一个事务时，事务之间的回滚关系。\n而常用的有三个事务传播行为：REQUIRED、NESTED和REQUIRES_NEW。\n本质来说，事务的回滚和事务的传播，取决于："}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"是否有抛异常"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"异常是否有经过spring的aop"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"当异常经过多个aop时，这些aop事务的关系"}]},{type:a,value:e}]},{type:a,value:"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{type:b,tag:bs,props:{},children:[{type:b,tag:bx,props:{},children:[{type:b,tag:Y,props:{},children:[{type:b,tag:aC,props:{},children:[{type:a,value:"传播行为"}]},{type:b,tag:aC,props:{},children:[{type:a,value:"父方法开启了事务"}]},{type:b,tag:aC,props:{},children:[{type:a,value:"父方法没开启事务"}]}]}]},{type:b,tag:by,props:{},children:[{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:b,tag:ac,props:{},children:[{type:a,value:gs}]}]},{type:b,tag:K,props:{},children:[{type:a,value:gz}]},{type:b,tag:K,props:{},children:[{type:a,value:ex}]}]},{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:gw}]},{type:b,tag:K,props:{},children:[{type:a,value:gz}]},{type:b,tag:K,props:{},children:[{type:a,value:"子方法无事务"}]}]},{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:gv}]},{type:b,tag:K,props:{},children:[{type:a,value:gz}]},{type:b,tag:K,props:{},children:[{type:a,value:ql}]}]},{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:b,tag:ac,props:{},children:[{type:a,value:gt}]}]},{type:b,tag:K,props:{},children:[{type:a,value:"父子方法父子事务"}]},{type:b,tag:K,props:{},children:[{type:a,value:ex}]}]},{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:gx}]},{type:b,tag:K,props:{},children:[{type:a,value:qm}]},{type:b,tag:K,props:{},children:[{type:a,value:"只回滚父事务，不回滚子事务"}]}]},{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:b,tag:ac,props:{},children:[{type:a,value:gu}]}]},{type:b,tag:K,props:{},children:[{type:a,value:qm}]},{type:b,tag:K,props:{},children:[{type:a,value:ex}]}]},{type:b,tag:Y,props:{},children:[{type:b,tag:K,props:{},children:[{type:a,value:gy}]},{type:b,tag:K,props:{},children:[{type:a,value:ql}]},{type:b,tag:K,props:{},children:[{type:a,value:ex}]}]}]}]},{type:a,value:e},{type:b,tag:$,props:{id:qd},children:[{type:b,tag:j,props:{href:"#required",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:gs}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"如果父子方法都开启了事务，那么父方法和子方法是同一个事务。\n即无论异常经过的是父方法还是子方法的aop，父子方法都会回滚。\n如果只有子方法开启了事务，则子方法的事务各自独立，只回滚自己的。"}]},{type:a,value:e},{type:b,tag:$,props:{id:qe},children:[{type:b,tag:j,props:{href:"#nested",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:gt}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"如果父子方法都开启了事务，父方法事务为父事务，子方法事务为子事务。\n如果异常经过子事务aop，只回滚子事务。如果异常经过父事务aop，则父子事务都回滚。"}]},{type:a,value:e},{type:b,tag:$,props:{id:qf},children:[{type:b,tag:j,props:{href:"#requires_new",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:gu}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"如果父子方法都开启了事务，父子方法的事务各自独立。"}]},{type:a,value:e},{type:b,tag:$,props:{id:qg},children:[{type:b,tag:j,props:{href:"#mandatory",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:gv}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"要求父子方法都要开启事务，那么父方法和子方法是同一个事务，同REQUIRED。\n如果只有子方法开启了事务，则报错。"}]},{type:a,value:e},{type:b,tag:$,props:{id:qh},children:[{type:b,tag:j,props:{href:"#supports",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:gw}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"如果父子方法都开启了事务，同REQUIRED。如果父方法没有开启事务，则父子方法都没有事务。"}]},{type:a,value:e},{type:b,tag:$,props:{id:qi},children:[{type:b,tag:j,props:{href:"#not_supported",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:gx}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"如果父子方法都开启了事务，父方法事务为父事务，子方法事务为子事务。\n即无论异常经过的是父事务还是子事务的aop，只回滚父事务，不回滚子事务。"}]},{type:a,value:e},{type:b,tag:$,props:{id:qj},children:[{type:b,tag:j,props:{href:"#never",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:gy}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"要求父方法不能开启事务，否则报错。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:aK}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fjuejin.im\u002Fentry\u002F5a8fe57e5188255de201062b",rel:[A,B,C],target:D},children:[{type:a,value:"Spring事务传播行为详解"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"http:\u002F\u002Fhara.fun\u002Findex.php\u002Farchives\u002F2159\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"Spring 事务传播行为 - HANAII BLOG"}]}]}]},excerpt:{type:S,children:[]},dir:qn,path:"\u002F框架\u002F20200707\u002FSpring事务总结",extension:ap,title:qb,url:"\u002Fblog-code\u002Fview\u002F$E6$A1$86$E6$9E$B6\u002F20200707\u002FSpring$E4$BA$8B$E5$8A$A1$E6$80$BB$E7$BB$93\u002F",createAt:new Date(1594080000000),updateAt:new Date(1594080000000),attributes:[{name:aq,value:qo},{name:ar,value:qo},{name:as,value:qn,url:"\u002Fblog-code\u002Fpage\u002F$E6$A1$86$E6$9E$B6\u002F20200707\u002F1\u002F"}]},{slug:qp,description:ab,createdAt:ey,updatedAt:ey,toc:[],body:{type:S,children:[{type:a,value:e},{type:b,tag:w,props:{id:"uuid"},children:[{type:b,tag:j,props:{href:"#uuid",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:eR}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"本地生成速度快"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"无序"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"字符串，占用空间大"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:"数据库自增id"},children:[{type:b,tag:j,props:{href:"#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%87%AA%E5%A2%9Eid",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"数据库自增ID"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"有序递增"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"插入数据时自动生成，方便"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"性能较低"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"分库分表：多主多从\n"},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"不同的自增步长"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"号段模式：一次性拿一段号段，减少数据库操作频率"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"扩容时先修改现有数据库的步长，之后新实例在一个较大的起始值开始自增"}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:bZ},children:[{type:b,tag:j,props:{href:"#redis",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"Redis"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"性能好，满足递增"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"即便使用AOF，也有可能丢数据导致ID重复（如果是毫秒级的key来自增，redis重启恢复能到ms级？就算到ms级，缓个1ms不也行）"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:qq},children:[{type:b,tag:j,props:{href:"#%E9%9B%AA%E8%8A%B1%E7%AE%97%E6%B3%95",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:qq}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"第一个bit为0，标志正数"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"毫秒时间戳占41bit，为当前时间减去一个过去时间，41bit可用69年"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"机器ID占10bit，例如前五位机房编号，后五位机器编号"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"序列号占12bit，支持同一毫秒同一节点生成4096个ID，满了需要自旋到下一毫秒"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"时间回拨\n"},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"检查本次ID时间与上次ID时间，如果回拨"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"例如5ms以内则自旋一下"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"否则需要预留一个拓展位改为1"}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:aK}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fgithub.com\u002FSnailclimb\u002FJavaGuide\u002Fblob\u002Fmaster\u002Fdocs\u002Fsystem-design\u002Fmicro-service\u002F%E5%88%86%E5%B8%83%E5%BC%8Fid%E7%94%9F%E6%88%90%E6%96%B9%E6%A1%88%E6%80%BB%E7%BB%93.md",rel:[A,B,C],target:D},children:[{type:a,value:"分布式id生成方案总结.md"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fgithub.com\u002Fjavagrowing\u002FJGrowing\u002Fblob\u002Fmaster\u002F%E5%88%86%E5%B8%83%E5%BC%8F\u002F%E5%A6%82%E6%9E%9C%E5%86%8D%E6%9C%89%E4%BA%BA%E9%97%AE%E4%BD%A0%E5%88%86%E5%B8%83%E5%BC%8F%20ID%EF%BC%8C%E8%BF%99%E7%AF%87%E6%96%87%E7%AB%A0%E4%B8%A2%E7%BB%99%E4%BB%96.md",rel:[A,B,C],target:D},children:[{type:a,value:"如果再有人问你分布式 ID，这篇文章丢给他.md"}]}]}]},excerpt:{type:S,children:[]},dir:ez,path:"\u002F分布式\u002F20200709\u002F分布式ID",extension:ap,title:qp,url:"\u002Fblog-code\u002Fview\u002F$E5$88$86$E5$B8$83$E5$BC$8F\u002F20200709\u002F$E5$88$86$E5$B8$83$E5$BC$8FID\u002F",createAt:new Date(1594252800000),updateAt:new Date(1594252800000),attributes:[{name:aq,value:eA},{name:ar,value:eA},{name:as,value:ez,url:qr}]},{slug:qs,description:ab,createdAt:ey,updatedAt:ey,toc:[],body:{type:S,children:[{type:a,value:e},{type:b,tag:w,props:{id:"两阶段提交xa"},children:[{type:b,tag:j,props:{href:"#%E4%B8%A4%E9%98%B6%E6%AE%B5%E6%8F%90%E4%BA%A4xa",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"两阶段提交(XA)"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"两阶段提交需要一个事务管理器，来协调两个阶段。"}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"事务管理器会在每个数据库进行预提交，检查是否预提交都就绪"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"如果都就绪，则让每个数据库提交事务，否则回滚事务"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"尽量保证了数据的一致性"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"事务管理器有单例问题，宕机了整个系统不可用"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"在第二步里通知提交或者回滚都可能通知失败，导致数据不一致"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"在第二步里通知到一半，事务管理器宕机选举，新主节点不知道那些服务还没通知"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"依赖于数据库，性能低"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"不符合微服务设计的每个微服务只能处理自己的数据库"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:"tcctry-confirm-cancel"},children:[{type:b,tag:j,props:{href:"#tcctry-confirm-cancel",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"TCC(Try Confirm Cancel)"}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"Try：对各个服务的资源进行检查和冻结"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"Confirm：将冻结转为执行具体的操作"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"Cancel：在确认阶段失败了，执行已成功的操作的补偿操作"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"回滚依赖于自己实现的补偿代码"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"适合于钱等需要较强一致性的场景"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"需要分布式事务整个流程较短"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:"saga"},children:[{type:b,tag:j,props:{href:"#saga",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"Saga"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"saga的流程是依次执行提交各个服务的本地事务，如无意外都执行成功则分布式事务完成。\n如果其中有一个事务失败，则对已经执行成功的事务进行补偿操作。"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"适合于分布式事务流程比较长"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"一致性比TCC差"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"不保证事务的隔离性"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:"tcc与saga"},children:[{type:b,tag:j,props:{href:"#tcc%E4%B8%8Esaga",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"TCC与Saga"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"在TCC的第一步中，全部本地事务都是还没提交的。而Saga里依次执行本地事务是执行就提交的"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"TCC还需要先进行try操作进行冻结。而Saga是直接执行提交，所以少了一次调用"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"因为TCC需要等待全部本地事务进行冻结，所以在这个阶段资源会都被阻塞，需要较短的分布式事务。\n而Saga提交的颗粒度是本地事务，所以适合于较长的分布式事务"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"因为TCC是在一步里确认全部的本地事务，所以一致性强于Saga的逐个本地事务进行提交"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"因为TCC在try里阻塞了资源，所以分布式事务之间是隔离的。而Saga的逐个本地事务则不隔离"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:qt},children:[{type:b,tag:j,props:{href:"#%E6%9C%AC%E5%9C%B0%E6%B6%88%E6%81%AF%E8%A1%A8",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:qt}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"A服务在本地事务里除了进行业务操作，还在一个消息表里插入一条数据，然后往MQ里丢一条消息"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"A服务也会定期扫描消息表，把消息表的消息丢到MQ里"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"B服务从MQ收到消息后执行本地事务。如果成功则去除A服务里消息表对应的数据，否则通知A服务执行补偿操作"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"依赖于数据库管理事务，性能低"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:qu},children:[{type:b,tag:j,props:{href:"#%E6%9C%80%E5%A4%A7%E5%8A%AA%E5%8A%9B%E9%80%9A%E7%9F%A5",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:qu}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"适合于不支持消息事务的MQ。"}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"A服务执行本地事务，执行成功后往MQ里丢一条消息"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"有一个最大努力通知服务来专门消费MQ的消息，去调B服务来执行本地事务"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"如果B服务执行成功，则分布式事务完成，否则重试几次，重试不行就放弃"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:qv},children:[{type:b,tag:j,props:{href:"#%E5%8F%AF%E9%9D%A0%E6%B6%88%E6%81%AF%E6%9C%8D%E5%8A%A1",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:qv}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"需要使用一个MQ来实现，其功能目前只有RocketMQ支持消息事务。"}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"A服务向MQ丢一条消息，MQ只先持久化消息，不放到队列里。如果失败了则取消事务"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"丢成功以后，A服务执行本地事务。如果执行成功通知MQ把消息放到队列里，否则丢弃消息取消事务"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"其中A服务对MQ的调用如果丢失了，MQ会在消息投递后的一段时间后，回调A服务的接口，查询A服务的本地事务是执行已提交、已回滚还是执行中"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"之后B服务就会从MQ里收到消息，然后同步执行本地事务。成功的话向MQ提交，分布式事务完成，否则B服务会有个重试次数，再不行则报警"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"A服务的本地事务与MQ同步是异步的，以提高A服务的并发"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"A服务与MQ的异步消息丢失通过MQ回调来弥补"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:aK}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fjuejin.im\u002Fpost\u002F5aa3c7736fb9a028bb189bca",rel:[A,B,C],target:D},children:[{type:a,value:"常用的分布式事务解决方案"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fxiaomi-info.github.io\u002F2020\u002F01\u002F02\u002Fdistributed-transaction\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"分布式事务，这一篇就够了"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fdoocs.github.io\u002Fadvanced-java\u002F#\u002Fdocs\u002Fdistributed-system\u002Fdistributed-transaction",rel:[A,B,C],target:D},children:[{type:a,value:"分布式事务了解吗？"}]}]}]},excerpt:{type:S,children:[]},dir:ez,path:"\u002F分布式\u002F20200709\u002F分布式事务",extension:ap,title:qs,url:"\u002Fblog-code\u002Fview\u002F$E5$88$86$E5$B8$83$E5$BC$8F\u002F20200709\u002F$E5$88$86$E5$B8$83$E5$BC$8F$E4$BA$8B$E5$8A$A1\u002F",createAt:new Date(1594252800000),updateAt:new Date(1594252800000),attributes:[{name:aq,value:eA},{name:ar,value:eA},{name:as,value:ez,url:qr}]},{slug:qw,description:ab,createdAt:qx,updatedAt:qx,toc:[],body:{type:S,children:[{type:a,value:e},{type:b,tag:w,props:{id:"spring-bean-scope"},children:[{type:b,tag:j,props:{href:"#spring-bean-scope",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"Spring Bean Scope"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"spring bean的作用域范围最常用的是单例和原型，使用"},{type:b,tag:y,props:{},children:[{type:a,value:"@Scope(\"prototype\")"}]},{type:a,value:"指定即可。"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:ac,props:{},children:[{type:a,value:"singleton(单例)"}]},{type:a,value:"：spring的scope默认是单例"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:b,tag:ac,props:{},children:[{type:a,value:"prototype(原型)"}]},{type:a,value:"：每一次对该bean的请求都会创建一个新的实例"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"request：http请求每次都会创建一个新的实例"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"session：http请求每个新的session都会创建一个新的实例"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:"spring-bean生命周期"},children:[{type:b,tag:j,props:{href:"#spring-bean%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"Spring Bean生命周期"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"spring只会帮我们去管理单例的bean的整个生命周期。\n对于原型的bean，spring在走完创建的流程，交给使用者后，bean的后续生命周期的流程就交由使用者进行管理了。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"所以下图的spring对单例的整个生命周期的管理。\n图中的"},{type:b,tag:y,props:{},children:[{type:a,value:"调用xx类的yy方法"}]},{type:a,value:"是指此bean实现了此接口才会调用。\n对于要自己管理对象的生命周期的话，除了第四步bean本来就在自己手上，其余的方法都是要自己调用的。\n所以常用的主要就是一下这几点。"}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"spring负责调用构造函数创建对象"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"spring负责注入依赖bean"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"spring负责调用我们自定义的bean的初始化函数（如果有）"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"spring负责注入bean，把bean交到使用者手上"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"spring负责在容器关闭时调用我们自定义的bean的销毁函数（如果有）"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:au,props:{alt:ab,"data-src":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20200714\u002Fi.loli.net-2019-05-08-5cd1d7d0416f5.jpg.JPEG"},children:[]}]},{type:a,value:e},{type:b,tag:w,props:{id:"spring循环依赖"},children:[{type:b,tag:j,props:{href:"#spring%E5%BE%AA%E7%8E%AF%E4%BE%9D%E8%B5%96",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"Spring循环依赖"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"spring的循环依赖问题是指几个bean直接相互引用，例如A引用B，B又引用A，或者直接是A引用自己。\nspring的依赖注入有三种入口：构造函数注入，成员变量注入和setter注入。\n而spring只能解决单例的成员变量或者setter注入问题。\n首先，无论bean的作用域是哪种，构造函数注入的循环应用都是无解的。\n而对于作用域是原型的，则无论哪种注入方式也都是无解的。\n因为例如A1引用B1，B1又引用A2，A2-\u003EB2，如此反复无穷无尽也。\n所以对于以上无解情形spring检测出来会抛异常，而有解的只有单例的成员变量和setter注入。\nspring循环依赖的解决办法是通过三个map做bean的缓存实现的。"}]},{type:a,value:e},{type:b,tag:M,props:{className:[N]},children:[{type:b,tag:O,props:{className:[aT,P]},children:[{type:b,tag:y,props:{},children:[{type:b,tag:c,props:{className:[d,cA,H]},children:[{type:a,value:"\u002F** 单例池：存放初始化好的bean，拿出来就能用 *\u002F"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aO}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bn}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:gA}]},{type:b,tag:c,props:{className:[d,aL]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:b$}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:" singletonObjects "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aU}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:"ConcurrentHashMap"}]},{type:b,tag:c,props:{className:[d,aL]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:b$}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:"256"}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:aA},{type:b,tag:c,props:{className:[d,cA,H]},children:[{type:a,value:"\u002F** 存放用于创建[还没创建的]bean的工厂对象 *\u002F"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aO}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bn}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:gA}]},{type:b,tag:c,props:{className:[d,aL]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:qy}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bF}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:" singletonFactories "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aU}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:qz}]},{type:b,tag:c,props:{className:[d,aL]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:qy}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:bF}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:qA}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:aA},{type:b,tag:c,props:{className:[d,cA,H]},children:[{type:a,value:"\u002F** 早期引用：存放还没初始化完成的bean *\u002F"}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aO}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:bn}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:gA}]},{type:b,tag:c,props:{className:[d,aL]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:b$}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:a,value:" earlySingletonObjects "},{type:b,tag:c,props:{className:[d,k]},children:[{type:a,value:p}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,o]},children:[{type:a,value:aU}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:qz}]},{type:b,tag:c,props:{className:[d,aL]},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:aj}]},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:ah}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:g},{type:b,tag:c,props:{className:[d,E]},children:[{type:a,value:b$}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:R}]}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:n}]},{type:b,tag:c,props:{className:[d,v]},children:[{type:a,value:qA}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:m}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:J}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"例如下图的AB互相引用的例子"}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"从singletonObjects里检查A是不是已经初始化完成，是的话则返回"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"否则创建A，将A封装到A工厂里，放到工厂map"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"初始化A，发现A依赖B"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"从singletonObjects里检查B是不是已经初始化完成，是的话则返回"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"否则创建B，将B封装到B工厂里，放到工厂map"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"初始化B，发现B依赖A"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"发现A在工厂map里，将A移到早期引用map里，工厂map移除A工厂"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"B在早期引用注入A，B完成初始化"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"A在单例池注入B，A完成初始化"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:au,props:{alt:ab,"data-src":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20200714\u002Fbijeuubd5z.gif"},children:[]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:aK}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fblog.csdn.net\u002Fpange1991\u002Farticle\u002Fdetails\u002F81429393",rel:[A,B,C],target:D},children:[{type:a,value:"Spring bean scope 的几种类型"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fcrossoverjie.top\u002F2018\u002F03\u002F21\u002Fspring\u002Fspring-bean-lifecycle\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"Spring Bean 生命周期"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fwww.javazhiyin.com\u002F37577.html",rel:[A,B,C],target:D},children:[{type:a,value:"深究Spring中Bean的生命周期"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"http:\u002F\u002Fwww.tianxiaobo.com\u002F2018\u002F06\u002F08\u002FSpring-IOC-%E5%AE%B9%E5%99%A8%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90-%E5%BE%AA%E7%8E%AF%E4%BE%9D%E8%B5%96%E7%9A%84%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"Spring IOC 容器源码分析 - 循环依赖的解决办法"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fcloud.tencent.com\u002Fdeveloper\u002Farticle\u002F1632576",rel:[A,B,C],target:D},children:[{type:a,value:"拜托，别再问我Spring循环依赖了，给你手写出来行不行？"}]}]}]},excerpt:{type:S,children:[]},dir:qB,path:"\u002F框架\u002F20200714\u002FSpring Bean总结",extension:ap,title:qw,url:"\u002Fblog-code\u002Fview\u002F$E6$A1$86$E6$9E$B6\u002F20200714\u002FSpring$20Bean$E6$80$BB$E7$BB$93\u002F",createAt:new Date(1594684800000),updateAt:new Date(1594684800000),attributes:[{name:aq,value:qC},{name:ar,value:qC},{name:as,value:qB,url:"\u002Fblog-code\u002Fpage\u002F$E6$A1$86$E6$9E$B6\u002F20200714\u002F1\u002F"}]},{slug:qD,description:ab,createdAt:qE,updatedAt:qE,toc:[],body:{type:S,children:[{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"在TCP\u002FIP架构里，IP是逻辑地址，MAC是物理地址，这之间通过ARP地址转换协议进行映射。\nARP协议简单的说就是在局域网里发广播，询问哪台设备持有此IP，并且告知一下MAC。\n因此，MAC是与某一硬件网卡所绑定的，而IP则不必。\n所以虚拟IP则是一个没有分配到具体网卡的IP，其高可用流程如下："}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"有服务器A和服务器B，现在服务器A是主服务器"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"有数据请求到虚拟IP，路由器通过地址转换协议询问虚拟IP对应的MAC，服务器A应答，因此虚拟IP指向服务器A"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"当服务器B监控服务器A，或者服务器A会向服务器B发送心跳"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"服务器B发现服务器A宕机，服务器B则请求路由器，让路由器的虚拟IP映射为自己的MAC，完成虚拟IP的映射切换"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"实际上，可以使用Keepalived这个软件来实现虚拟IP的高可用方案。"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:aK}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"http:\u002F\u002Fxiaobaoqiu.github.io\u002Fblog\u002F2015\u002F04\u002F02\u002Fxu-ni-iphe-ippiao-yi\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"虚拟IP和IP漂移"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fwww.cnblogs.com\u002Fjmcui\u002Fp\u002F13055283.html",rel:[A,B,C],target:D},children:[{type:a,value:"虚拟IP原理及使用"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"http:\u002F\u002Fwww.xumenger.com\u002Fvirtual-ip-20190220\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"虚拟IP技术"}]}]}]},excerpt:{type:S,children:[]},dir:qF,path:"\u002F分布式\u002F20200715\u002F虚拟IP",extension:ap,title:qD,url:"\u002Fblog-code\u002Fview\u002F$E5$88$86$E5$B8$83$E5$BC$8F\u002F20200715\u002F$E8$99$9A$E6$8B$9FIP\u002F",createAt:new Date(1594771200000),updateAt:new Date(1594771200000),attributes:[{name:aq,value:qG},{name:ar,value:qG},{name:as,value:qF,url:"\u002Fblog-code\u002Fpage\u002F$E5$88$86$E5$B8$83$E5$BC$8F\u002F20200715\u002F1\u002F"}]},{slug:qH,description:ab,createdAt:qI,updatedAt:qI,toc:[{id:qJ,depth:_,text:qK},{id:qL,depth:_,text:qM},{id:qN,depth:_,text:qO},{id:qP,depth:_,text:qQ},{id:qR,depth:_,text:qS}],body:{type:S,children:[{type:a,value:e},{type:b,tag:w,props:{id:qT},children:[{type:b,tag:j,props:{href:"#%E5%BE%AE%E6%9C%8D%E5%8A%A1",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:qT}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"微服务是将一个大的单体应用，根据服务拆分为多个功能专一的轻量服务。\n各个微服务之间可以使用不同的语言和数据库，服务之间通过HTTP进行调用。"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"服务能很容易的横线扩展"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"服务之间松耦合"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"服务简单，内聚度高，开发效率高"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"微服务通信"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"数据一致性"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"调用性能监控"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"多服务运维"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:"spring-cloud与dubbo"},children:[{type:b,tag:j,props:{href:"#spring-cloud%E4%B8%8Edubbo",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"Spring Cloud与dubbo"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"dubbo与zookeeper实现了服务发现和RPC调用。而spring cloud是定位于微服务治理全家桶。\n像配置中心、熔断器、服务网关等，spring cloud都有相应的组件实现，而dubbo则需要其他中间件的配合。"}]},{type:a,value:e},{type:b,tag:w,props:{id:qU},children:[{type:b,tag:j,props:{href:"#%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:qU}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"微服务集群服务数量很多，如果通过配置指定依赖的服务的地址，当节点上下线的时候，会大大增加维护成本。\n而注册中心提供服务注册和服务发现的功能。\n每一个微服务都会向注册中心组成自己所提供的服务，并且从注册中心查询所需服务的地址。\n每一个节点也会向注册中心上报健康情况，动态更新服务列表。"}]},{type:a,value:e},{type:b,tag:$,props:{id:qJ},children:[{type:b,tag:j,props:{href:"#eureka",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:qK}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"Eureka是spring cloud的注册中心组件。\n如上所说，其他服务会通过Eureka客户端连接到Eureka服务端，保持心跳，把自己的信息注册到注册中心。"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"高可用：使用Eureka集群，不同的Eureka节点之间相互注册，通过注册中心本身来监控Eureka节点的更新"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"自我保护模式：如果Eureka在一段时间里没有收到某服务的心跳，会进入自我保护模式。\n并不会清除该服务的注册信息并正常对外提供。\n直到心跳恢复正常才会退出自我保护模式，更新服务列表。简单来说就好有比没有好"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"Eureka与ZooKeeper：如果zookeeper的主节点挂了要进行选举，在选举期间是无法对外提供服务的，重于一致性。\nEureka的各个节点之间是平等的，只要有节点正常就能对外提供服务，重于可用性。"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:qV},children:[{type:b,tag:j,props:{href:"#%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%9D%87%E8%A1%A1%E8%B4%9F%E8%BD%BD",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:qV}]},{type:a,value:e},{type:b,tag:$,props:{id:qL},children:[{type:b,tag:j,props:{href:"#ribbon",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:qM}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"Ribbon是spring cloud的客户端均衡负载组件。\nRibbon会从注册中心获取服务的全部节点信息，使用轮询去均衡请求各个节点。\n使用"},{type:b,tag:y,props:{},children:[{type:a,value:"@LoadBalanced"}]},{type:a,value:"注解开启均衡负载。"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"Ribbon与Nginx：Nginx是在反代的过程中均衡负载，请求的流量会经过nginx。Ribbon是客户端请求时直接均衡负载到服务端。"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:qW},children:[{type:b,tag:j,props:{href:"#%E5%A3%B0%E6%98%8E%E5%BC%8Fweb%E5%AE%A2%E6%88%B7%E7%AB%AF",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:qW}]},{type:a,value:e},{type:b,tag:$,props:{id:qN},children:[{type:b,tag:j,props:{href:"#feign",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:qO}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"Feign是一个声明式web客户端，帮助我就构造请求HTTP接口。\n与Ribbon结合，就能实现轮询的声明式HTTP请求接口。"}]},{type:a,value:e},{type:b,tag:w,props:{id:qX},children:[{type:b,tag:j,props:{href:"#%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:qX}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"微服务集群节点众多，与注册中心一样，需要一样统一的配置中心对不同服务的配置进行管理和更新。\n配置中心基于git，通过git能原始实现对配置文件的版本控制。"}]},{type:a,value:e},{type:b,tag:w,props:{id:qY},children:[{type:b,tag:j,props:{href:"#%E7%86%94%E6%96%AD%E5%99%A8",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:qY}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"在分布式系统里，如果其中有一个服务不可用，服务请求阻塞直到超时，占用服务的全部线程，导致整个服务不可用。\n新的服务不可用又会导致别的服务不可用，最后连锁效应导致整个服务集群发生雪崩效应。"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"隔离：熔断器会隔离不同服务之间的影响"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"监控：熔断器会对每次调用的成功失败、时间进行记录"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"熔断：熔断器监控服务的失败数或者失败率达到一定的值，会对这个服务进行熔断，不再请求这个服务"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"降级：熔断器在熔断后服务会进行降级，调用备用的降级方法，维持服务的可用性"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"关闭：熔断器关闭，请求正常"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"打开：发现某个服务不可用，熔断该服务，熔断器处于打开状态"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"半开：熔断的一段时间后，会将部分请求发给接口"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:$,props:{id:qP},children:[{type:b,tag:j,props:{href:"#hystrix",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:qQ}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"Tomcat默认只有一个线程池来处理请求，会导致服务雪崩。\nHystrix会给每一个服务配一个线程池，通过线程池隔离不同的服务。除此以外还可以使用信号量方式。"}]},{type:a,value:e},{type:b,tag:w,props:{id:qZ},children:[{type:b,tag:j,props:{href:"#%E6%9C%8D%E5%8A%A1%E7%BD%91%E5%85%B3",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:qZ}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"服务网关通过路由转发，统一暴露微服务集群的接口。\n并且在服务网关里实现与业务逻辑无关的，如鉴权、限流、缓存、监控、统计等功能。"}]},{type:a,value:e},{type:b,tag:$,props:{id:qR},children:[{type:b,tag:j,props:{href:"#zuulzuul2%E4%B8%8Egateway",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:qS}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"Zuul基于Servlet是BIO，Zuul2基于netty是NIO，Gateway是spring cloud推出的第二代网关，同样是NIO，用于替代zuul。"}]},{type:a,value:e},{type:b,tag:w,props:{id:q_},children:[{type:b,tag:j,props:{href:"#%E6%B6%88%E6%81%AF%E6%80%BB%E7%BA%BF",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:q_}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"可与配置中心结合，实现配置实时更新。"}]},{type:a,value:e},{type:b,tag:w,props:{id:q$},children:[{type:b,tag:j,props:{href:"#%E7%BB%84%E4%BB%B6%E5%8F%91%E9%9F%B3",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:q$}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"Eureka [jʊ'ri:kə]"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"Ribbon [ˈrɪbən]"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"Feign [fen]"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"Hystrix [hɪst'rɪks]"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"Zuul [zulu]"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"Sleuth [sluθ]"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"Turbine [ˈtɜ:rbaɪn]"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:aK}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fjuejin.im\u002Fpost\u002F5e94233bf265da47c5584b3b",rel:[A,B,C],target:D},children:[{type:a,value:"SpringCloud面试题（总结最全面的面试题！！！）"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fjuejin.im\u002Fpost\u002F5be13b83f265da6116393fc7",rel:[A,B,C],target:D},children:[{type:a,value:"拜托！面试请不要再问我Spring Cloud底层原理"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fwww.jianshu.com\u002Fp\u002Fdd1c4c3e2a7f",rel:[A,B,C],target:D},children:[{type:a,value:"SpringCloud面试题"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fwww.cnblogs.com\u002Flinkstar\u002Fp\u002F9055900.html",rel:[A,B,C],target:D},children:[{type:a,value:"SpringCloud各个组件说明"}]}]}]},excerpt:{type:S,children:[]},dir:ra,path:"\u002F分布式\u002F20200717\u002FSpring Cloud组件总结",extension:ap,title:qH,url:"\u002Fblog-code\u002Fview\u002F$E5$88$86$E5$B8$83$E5$BC$8F\u002F20200717\u002FSpring$20Cloud$E7$BB$84$E4$BB$B6$E6$80$BB$E7$BB$93\u002F",createAt:new Date(1594944000000),updateAt:new Date(1594944000000),attributes:[{name:aq,value:rb},{name:ar,value:rb},{name:as,value:ra,url:"\u002Fblog-code\u002Fpage\u002F$E5$88$86$E5$B8$83$E5$BC$8F\u002F20200717\u002F1\u002F"}]},{slug:el,description:ab,createdAt:rc,updatedAt:rc,toc:[],body:{type:S,children:[{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"一般而言，缓存都需要设置过期时间，通过缓存过期实现缓存与数据库的数据一致性是最后的兜底策略。\n然后根据更新数据库的先后和是更新还是删除缓存做排序，有以下四种情形。\n一般是使用更新数据库，删除缓存，当然都还是有并发问题的。"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"更新缓存，更新数据库\n"},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"如果更新数据库失败，那么其实操作还没执行成功，缓存最终还是会变回旧数据"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"如果缓存不是会被经常读取，那么这个缓存就会占用空间，还可能浪费计算资源"}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"删除缓存，更新数据库\n"},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"同样有更新数据库失败问题"}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"更新数据库，更新缓存\n"},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"同样有更新缓存问题"}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"更新数据库，删除缓存\n"},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"以数据库更新是否成功为准"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"删除缓存，减少了空间占用和计算"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"如果删除缓存失败，只能通过过期更新"}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:rd},children:[{type:b,tag:j,props:{href:"#%E5%88%A0%E9%99%A4%E7%BC%93%E5%AD%98%E5%AF%BC%E8%87%B4%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:rd}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"机器不多，可以只用本地锁"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"机器多，需要上分布式锁"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:re},children:[{type:b,tag:j,props:{href:"#%E8%A7%A3%E5%86%B3%E5%B9%B6%E5%8F%91%E6%9B%B4%E6%96%B0%E7%BC%93%E5%AD%98",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:re}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"双删除：删除缓存-\u003E更新数据库-\u003E延迟一段时间-\u003E删除缓存。\n这个延迟一段时间，第一是等待那些读到旧值的线程完成缓存的写入，第二可以等待mysql主从同步"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:rf},children:[{type:b,tag:j,props:{href:"#%E8%A7%A3%E5%86%B3%E5%88%A0%E9%99%A4%E7%BC%93%E5%AD%98%E5%A4%B1%E8%B4%A5",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:rf}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"本地重试：但是如果是网络问题，短时间内的网络重试没什么意义"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"MQ异步重试：本地删除失败了，通过MQ的消费服异步删除，只有在redis和MQ同时故障的时候才行不通"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"Mysql的binlog异步删除：通过一个服务解析binlog，去删除相应的缓存"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:rg},children:[{type:b,tag:j,props:{href:"#%E5%BC%BA%E4%B8%80%E8%87%B4%E6%80%A7",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:rg}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"强一致性方案当然可以解决并发更新缓存问题。"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"分布式读写锁：让读线程等待写线程完成写入。\n读多写少可能还好，读少写多的缓存没啥作用，可能要考虑是不是要去掉缓存"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:aK}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fjuejin.im\u002Fpost\u002F5d7c7a14f265da03f47c4f93",rel:[A,B,C],target:D},children:[{type:a,value:"聊聊数据库与缓存数据一致性问题"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fwww.cnblogs.com\u002Frjzheng\u002Fp\u002F9041659.html",rel:[A,B,C],target:D},children:[{type:a,value:"【原创】分布式之数据库和缓存双写一致性方案解析"}]}]}]},excerpt:{type:S,children:[]},dir:rh,path:"\u002F分布式\u002F20200727\u002F缓存与数据库的一致性",extension:ap,title:el,url:"\u002Fblog-code\u002Fview\u002F$E5$88$86$E5$B8$83$E5$BC$8F\u002F20200727\u002F$E7$BC$93$E5$AD$98$E4$B8$8E$E6$95$B0$E6$8D$AE$E5$BA$93$E7$9A$84$E4$B8$80$E8$87$B4$E6$80$A7\u002F",createAt:new Date(1595808000000),updateAt:new Date(1595808000000),attributes:[{name:aq,value:ri},{name:ar,value:ri},{name:as,value:rh,url:"\u002Fblog-code\u002Fpage\u002F$E5$88$86$E5$B8$83$E5$BC$8F\u002F20200727\u002F1\u002F"}]},{slug:rj,description:gB,createdAt:rk,updatedAt:rk,toc:[{id:eB,depth:_,text:eB},{id:eC,depth:_,text:eC}],body:{type:S,children:[{type:b,tag:i,props:{},children:[{type:a,value:gB}]},{type:a,value:e},{type:a,value:e},{type:b,tag:w,props:{id:rl},children:[{type:b,tag:j,props:{href:"#%E5%88%86%E5%B8%83%E4%B8%80%E8%87%B4%E6%80%A7%E7%B1%BB%E5%9E%8B",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:rl}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"强一致性：写入什么数据读出来就是什么数据。任何时候读出来的数据都是最新的"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"弱一致性：不承诺能立即读到新值，也不承诺多久之后能读到新值，但会尽量确保在一个时间级别（例如秒级）能读到新值"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"最终一致性：是弱一致性的一种特例，保证在一定时间内能读到新值"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:"cap理论"},children:[{type:b,tag:j,props:{href:"#cap%E7%90%86%E8%AE%BA",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"CAP理论"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"分布式系统只能最多同时满足可用性、一致性和分区容错性的其中两个。\n由于分布式系统的分区特性是无法避免的，所以实际上分布式系统只能在可用性和一致性之间做妥协。"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"一致性(Consistency)：数据在任何时候都是一致的（强一致性）"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"可用性(Availability)：服务一直处于可用状态，在有限时间内返回结果（强可用性）"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"分区容错性(Partition tolerance)：当系统出现网络分区故障时，仍能对外提供满足一致性和可用性的服务"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:"base理论"},children:[{type:b,tag:j,props:{href:"#base%E7%90%86%E8%AE%BA",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"BASE理论"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"BASE理论的核心想法是，即使做不到强一致性，也至少要保证最终一致性，允许可用性只要求基本可用以加强一致性。"}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"基本可用(Basically Available)：系统出现故障时允许丢失部分可用性，例如增加响应时间，服务降级等"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"软状态(Soft state)：允许系统数据存在中间状态，即系统的不同节点之间的数据同步存在延迟"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"最终一致性(Eventually consistent)：系统的所有节点经过一段时间的同步之后都会达到一致"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:rm},children:[{type:b,tag:j,props:{href:"#%E4%B8%A4%E9%98%B6%E6%AE%B5%E6%8F%90%E4%BA%A4",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:rm}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"两阶段提交以及升级版的三阶段提交都是只是缓解了数据不一致的问题，并没有完全解决问题。\n看步骤感觉跟分布式事务的两阶段提交和TCC(Try Confirm Cancel)有点像，不知道是不是同一个东西。"}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"将数据发送到全部节点，等待节点确认"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"如果全部节点都确认了，则向全部节点发送提交，否则返回失败"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:"paxos协议"},children:[{type:b,tag:j,props:{href:"#paxos%E5%8D%8F%E8%AE%AE",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"Paxos协议"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"网上说好难理解，看过的那几篇文章都没展开介绍，所以就懒得写了。"}]},{type:a,value:e},{type:b,tag:w,props:{id:"raft协议"},children:[{type:b,tag:j,props:{href:"#raft%E5%8D%8F%E8%AE%AE",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"Raft协议"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"Raft里，节点有三种状态，且同时只会处于其中一种状态："}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"从节点：初始时节点都是从节点状态"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"候选节点：当从节点收不到主节点的心跳，从节点会变为候选节点"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"主节点：候选节点会让其他节点给自己投票，获取过半数票节点变为主节点。\n读操作全部节点处理，写操作主节点处理。\n"},{type:b,tag:j,props:{href:rn,rel:[A,B,C],target:D},children:[{type:a,value:"写同步我看文章理解是类似二段提交"}]},{type:a,value:"（那这样子怎么就解决了呢？）"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:w,props:{id:"zab协议"},children:[{type:b,tag:j,props:{href:"#zab%E5%8D%8F%E8%AE%AE",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"ZAB协议"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"ZAB全称Zookeeper Atomic Broadcast（zookeeper原子广播），据说参考了Paxos，是zookeeper里的分布式一致性的实现。\n虽然我不晓得Paxos是啥样，但是有其中一篇文章说ZAB是简化版的两阶段提交，我看来确实有点像两阶段提交，还是说其实都像。\nzookeeper的节点除了主节点和从节点以外还有观察节点，但是观察节点不参与投票，所以Zab协议并没有观察节点的什么事。\nzookeeper的读操作可以由全部节点直接处理，而从节点和观察节点接受到写操作会转发给主节点处理。\nZAB协议包含两部分，分别是正常状态下的消息广播和异常状态下的崩溃恢复。"}]},{type:a,value:e},{type:b,tag:$,props:{id:eB},children:[{type:b,tag:j,props:{href:"#%E6%B6%88%E6%81%AF%E5%B9%BF%E6%92%AD",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:eB}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"主节点会将写请求提案(Proposal)，并且每个提案都有一个递增的zxid（高32位表示年代，低32位自增）"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"主节点对每个从节点都会有一个队列用来存放、异步投递提案，提高性能"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"从节点收到提案后会把提案数据进行持久化，然后给主节点发送确认"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"主节点收到过半数从节点的确认后，就会向全部从节点发送提交，并且同时也会提交自己的提案，然后给客户端返回成功"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"从节点收到主节点的提交后，会提交自己的提案"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:ro}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"为什么过半数就可以提交：因为只要过半数，就能确保至少有一个从节点是保存着全部的数据或者提案的，它将有机会在奔溃恢复中被选举为新的主节点"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"在从节点确认提案和主节点提交提案这两步有点像两阶段提交，从节点都没收到提交，主节点给客户端返回成功但自己挂了的情况，依然不理解怎么解决"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:$,props:{id:eC},children:[{type:b,tag:j,props:{href:"#%E5%A5%94%E6%BA%83%E6%81%A2%E5%A4%8D",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:eC}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"当集群刚启动时，或者主节点失去与过半数从节点联系时，会进入奔溃恢复选举主节点"}]},{type:a,value:e},{type:b,tag:ai,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"所有从节点一开始先投票给自己，把自己的投票结果发给其他节点"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"节点收到其他节点的投票结果，依据"},{type:b,tag:y,props:{},children:[{type:a,value:"epoch更大-\u003Ezxid更大-\u003Emyid更大"}]},{type:a,value:"，决定是否要修改投票，要改的话则把新的投票发给其他节点"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"有节点获票过半数，当选主节点，会使结果偏向"},{type:b,tag:y,props:{},children:[{type:a,value:"epoch最大 && zxid最大 && myid最大"}]}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"新的主节点会与其余从节点同步数据，直到同步完成才接受请求，对自己的年代加一"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:ro}]},{type:a,value:e},{type:b,tag:I,props:{},children:[{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"文章里都说：确保被主节点提交的提案必须最终被所有的从节点提交。\n但是按这套逻辑实现不了呀，确保被过半数从节点确认\u002F至少一个从节点提交的提案必须最终被所有的从节点提交倒是可以"}]},{type:a,value:e},{type:b,tag:h,props:{},children:[{type:a,value:"文章里都说：确保丢弃被主节点提出的但是没有被提交的提案。没有看到有文章说明是怎么个丢弃法。"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:aK}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fwww.cnblogs.com\u002Fxrq730\u002Fp\u002F4944768.html",rel:[A,B,C],target:D},children:[{type:a,value:"从分布式一致性谈到CAP理论、BASE理论"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"http:\u002F\u002Fairekans.github.io\u002Fcloud-computing\u002F2016\u002F10\u002F26\u002Fintro-to-distributed-consensus",rel:[A,B,C],target:D},children:[{type:a,value:"浅谈分布式一致性"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:rn,rel:[A,B,C],target:D},children:[{type:a,value:"图解分布式一致性算法"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"http:\u002F\u002Fjavavipblog.com\u002F2020\u002F01\u002F20\u002Fzookeeper\u002FZookeeper%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5%E6%B5%81%E7%A8%8B\u002F",rel:[A,B,C],target:D},children:[{type:a,value:"Zookeeper数据同步以及Leader选举"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fwww.jianshu.com\u002Fp\u002F2bceacd60b8a",rel:[A,B,C],target:D},children:[{type:a,value:"Zookeeper——一致性协议:Zab协议"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fjuejin.im\u002Fpost\u002F5b924b0de51d450e9a2de615",rel:[A,B,C],target:D},children:[{type:a,value:"看大牛如何分析Zookeeper ZAB 协议"}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fdbaplus.cn\u002Fnews-141-1875-1.html",rel:[A,B,C],target:D},children:[{type:a,value:"实例详解ZooKeeper ZAB协议、分布式锁与领导选举"}]}]}]},excerpt:{type:S,children:[{type:b,tag:i,props:{},children:[{type:a,value:gB}]}]},dir:rp,path:"\u002F分布式\u002F20200730\u002F迷谈分布式一致性",extension:ap,title:rj,url:"\u002Fblog-code\u002Fview\u002F$E5$88$86$E5$B8$83$E5$BC$8F\u002F20200730\u002F$E8$BF$B7$E8$B0$88$E5$88$86$E5$B8$83$E5$BC$8F$E4$B8$80$E8$87$B4$E6$80$A7\u002F",createAt:new Date(1596067200000),updateAt:new Date(1596067200000),attributes:[{name:aq,value:rq},{name:ar,value:rq},{name:as,value:rp,url:"\u002Fblog-code\u002Fpage\u002F$E5$88$86$E5$B8$83$E5$BC$8F\u002F20200730\u002F1\u002F"}]},{slug:rr,description:ab,createdAt:rs,updatedAt:rs,toc:[],body:{type:S,children:[{type:a,value:e},{type:b,tag:w,props:{id:dG},children:[{type:b,tag:j,props:{href:mc,ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:dG}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:rt,rel:[A,B,C],target:D},children:[{type:a,value:rt}]}]},{type:a,value:e},{type:b,tag:w,props:{id:ru},children:[{type:b,tag:j,props:{href:"#%E6%B2%B9%E7%8C%B4",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:ru}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fgreasyfork.org\u002Fzh-CN\u002Fscripts\u002F14178-ac-baidu-%E9%87%8D%E5%AE%9A%E5%90%91%E4%BC%98%E5%8C%96%E7%99%BE%E5%BA%A6%E6%90%9C%E7%8B%97%E8%B0%B7%E6%AD%8C%E5%BF%85%E5%BA%94%E6%90%9C%E7%B4%A2-favicon-%E5%8F%8C%E5%88%97",rel:[A,B,C],target:D},children:[{type:a,value:"https:\u002F\u002Fgreasyfork.org\u002Fzh-CN\u002Fscripts\u002F14178-ac-baidu-重定向优化百度搜狗谷歌必应搜索-favicon-双列"}]},{type:a,value:e},{type:b,tag:j,props:{href:rv,rel:[A,B,C],target:D},children:[{type:a,value:rv}]}]},{type:a,value:e},{type:b,tag:w,props:{id:"windows"},children:[{type:b,tag:j,props:{href:"#windows",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"Windows"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:rw,rel:[A,B,C],target:D},children:[{type:a,value:rw}]}]},{type:a,value:e},{type:b,tag:w,props:{id:rx},children:[{type:b,tag:j,props:{href:"#%E7%81%AB%E7%BB%92",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:rx}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:ry,rel:[A,B,C],target:D},children:[{type:a,value:ry}]}]},{type:a,value:e},{type:b,tag:w,props:{id:"notepad"},children:[{type:b,tag:j,props:{href:"#notepad",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"notepad++"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:rz,rel:[A,B,C],target:D},children:[{type:a,value:rz}]}]},{type:a,value:e},{type:b,tag:w,props:{id:rA},children:[{type:b,tag:j,props:{href:"#7zip",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:rA}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:rB,rel:[A,B,C],target:D},children:[{type:a,value:rB}]}]},{type:a,value:e},{type:b,tag:w,props:{id:"office"},children:[{type:b,tag:j,props:{href:"#office",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"Office"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:rC,rel:[A,B,C],target:D},children:[{type:a,value:rC}]}]},{type:a,value:e},{type:b,tag:w,props:{id:"mpv"},children:[{type:b,tag:j,props:{href:"#mpv",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"MPV"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:rD,rel:[A,B,C],target:D},children:[{type:a,value:rD}]}]},{type:a,value:e},{type:b,tag:w,props:{id:"translucenttb"},children:[{type:b,tag:j,props:{href:"#translucenttb",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"TranslucentTB"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:rE,rel:[A,B,C],target:D},children:[{type:a,value:rE}]}]},{type:a,value:e},{type:b,tag:w,props:{id:"qb"},children:[{type:b,tag:j,props:{href:"#qb",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"QB"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:rF,rel:[A,B,C],target:D},children:[{type:a,value:rF}]},{type:a,value:e},{type:b,tag:j,props:{href:rG,rel:[A,B,C],target:D},children:[{type:a,value:rG}]}]},{type:a,value:e},{type:b,tag:w,props:{id:rH},children:[{type:b,tag:j,props:{href:"#%E5%BE%AE%E4%BF%A1",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:rH}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:rI,rel:[A,B,C],target:D},children:[{type:a,value:rI}]},{type:a,value:e},{type:b,tag:j,props:{href:rJ,rel:[A,B,C],target:D},children:[{type:a,value:rJ}]}]},{type:a,value:e},{type:b,tag:w,props:{id:rK},children:[{type:b,tag:j,props:{href:"#%E5%9B%BE%E7%89%87%E6%9F%A5%E7%9C%8B%E5%99%A8",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:rK}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:rL,rel:[A,B,C],target:D},children:[{type:a,value:rL}]}]},{type:a,value:e},{type:b,tag:w,props:{id:"xshell"},children:[{type:b,tag:j,props:{href:"#xshell",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"Xshell"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:rM,rel:[A,B,C],target:D},children:[{type:a,value:rM}]}]},{type:a,value:e},{type:b,tag:w,props:{id:rN},children:[{type:b,tag:j,props:{href:"#raidrive",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:rN}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:rO,rel:[A,B,C],target:D},children:[{type:a,value:rO}]}]},{type:a,value:e},{type:b,tag:w,props:{id:rP},children:[{type:b,tag:j,props:{href:"#windows%E6%98%BE%E7%A4%BA%E7%A7%92",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:rP}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:rQ,rel:[A,B,C],target:D},children:[{type:a,value:rQ}]}]},{type:a,value:e},{type:b,tag:w,props:{id:"wsl"},children:[{type:b,tag:j,props:{href:"#wsl",ariaHidden:q,tabIndex:r},children:[{type:b,tag:c,props:{className:[s,t]},children:[]}]},{type:a,value:"WSL"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:j,props:{href:"https:\u002F\u002Fgithub.com\u002Fcellargalaxy\u002Fblog-code\u002Fblob\u002Fmaster\u002F%E6%8A%98%E8%85%BE\u002F20190823\u002F%E9%80%9A%E8%BF%87ssh%E8%BF%9C%E7%A8%8BWindows%E7%9A%84linux%E7%8E%AF%E5%A2%83.md",rel:[A,B,C],target:D},children:[{type:a,value:"https:\u002F\u002Fgithub.com\u002Fcellargalaxy\u002Fblog-code\u002Fblob\u002Fmaster\u002F折腾\u002F20190823\u002F通过ssh远程Windows的linux环境.md"}]}]}]},excerpt:{type:S,children:[]},dir:rR,path:"\u002F折腾\u002F20201226\u002Fwindows重装系统常用软件手记",extension:ap,title:rr,url:"\u002Fblog-code\u002Fview\u002F$E6$8A$98$E8$85$BE\u002F20201226\u002Fwindows$E9$87$8D$E8$A3$85$E7$B3$BB$E7$BB$9F$E5$B8$B8$E7$94$A8$E8$BD$AF$E4$BB$B6$E6$89$8B$E8$AE$B0\u002F",createAt:new Date(1608940800000),updateAt:new Date(1608940800000),attributes:[{name:aq,value:rS},{name:ar,value:rS},{name:as,value:rR,url:"\u002Fblog-code\u002Fpage\u002F$E6$8A$98$E8$85$BE\u002F20201226\u002F1\u002F"}]}]}],fetch:{},mutations:void 0}}("text","element","span","token","\n","punctuation"," ","li","p","a","operator","function",")","(","keyword","=","true",-1,"icon","icon-link",".","number","h1",",","code","string","nofollow","noopener","noreferrer","_blank","class-name","\\","\n    ","comment","ul",";","td","sudo","div","nuxt-content-highlight","pre","line-numbers","variable","\u003E","root","1","tag","assign-left","[","]","tr","language-shell",2,"h2","boolean","","strong","{","}","return","|","String","ol","\u003C","\n        ","docker","environment","constant",":",".md","createAt","updateAt","sort","annotation","img","2","builtin","public","local","\"","\n\n","+","th","import","install","output_tensor","\n-p ","\"zh_CN\"","0","\n\n    ","参考文章：","generics","\n            ","apt-get","private","\n    output_tensor ","*","    ","attr-name","language-java","new","from","\n  -e ","   ","attr-value","\u003C\u002F","null","-","10"," key","if","call","attr-equals","apt"," run -d ","3","select","11","tonumber","vim","key","final","int","def","class","properties","table","language-text"," redisTemplate","shape","\n        plt","thead","tbody","ht[1]","wide","blockquote","set","$(","in","?","then","end","input_tensor"," K","history"," history","   小明  ","false","RedisTemplate","Jedis"," n"," i","id","nuxt-link","\n--restart always ","@Bean","info","\n        jedisConnectionFactory","namespace","redis"," success","Object"," redis"," \n","\n\n\n"," x_train","\u002F"," activation"," output_tensor","summary"," decoder"," inputs","fcitx ","language-sql","------+","阻塞","ARGV","\n  ","em","reboot","static","@RefreshScope","\n        poolConfig","\n        redisTemplate","stringRedisSerializer","language-bash","script","Arrays","doc-comment","\n            log"," KEYS","as"," keras"," Dense"," x_test","'relu'","\n    vae"," digit_size","hash","KEYS","\nredis","show","前记","注意","cat"," \u002Fetc\u002Fnetwork\u002Finterfaces\n","arch","arm64,armhf ","echo","\"zh_CN.UTF-8\"","type","\n--restart","always ","6881","cut","@Configuration","@ConfigurationProperties","prefix ","PropertySource","default","PropertySourceFactory"," name"," resource","name "," properties","getPool","选型","dependency","groupId","artifactId","data","RedisCallback"," result ","asList"," \n    "," Conv2D","32","x_train","x_test","reshape"," np"," padding","'same'","\n    encoder","\n    decoder","plot","epochs"," label","谷歌浏览器","https:\u002F\u002Fgithub.com\u002Fohmyzsh\u002Fohmyzsh"," person ","join"," address ","on"," person","pid","address","pid\n\npid  age  name  aid  pid","  city\n","       北京\n","       东京\n","22","   小红  ","12","       南京\n","  "," id ","where","\u003C\u003C","标记-清除算法","标记-整理算法","复制算法","概念","生产端","消费端","2020-06-02T00:00:00.000Z","2020-06-02","list","哨兵集群选举","哨兵集群的数据丢失","ht[0]","缓存与数据库的一致性","偏向锁","获取轻量级锁","释放轻量级锁","重量级锁","锁消除","锁优化","锁升级与锁降级","2020-07-03T00:00:00.000Z","服务接入","\u002F分布式\u002F20200703","2020-07-03","子事务各自独立","2020-07-09T00:00:00.000Z","\u002F分布式\u002F20200709","2020-07-09","消息广播","奔溃恢复","文章","经过将近两个星期的折腾，博客2.0终于装修完毕，在装修过程中吸取了其他一下博客的灵感进行设计。","https:\u002F\u002F2heng.xin\u002F","樱花庄的白猫","v-if","和","v-show","language-html"," update\n","\ndeb ","\n        option ifname ","\n        option proto ",",\n  ","for","UUID","\n-e ","del","value","User"," username"," password","getter","setter\n","name","\"\"","PropertySourcesPlaceholderConfigurer","RedisProperties","\n        log","\n\n        ","\n\n        redisTemplate","https:\u002F\u002Faimingoo.github.io\u002F1-1722.html","手记4：谈谈Gitment中泄露secret的前因后果与解决方法","之前写过一篇分别用mysql，redis和zookeeper实现分布式锁，但写的比较简略。这次写个比较完整的redis锁和redis计数器的实现。","this"," secondsToExpire","execute","Boolean"," redisConnection ","-\u003E"," jedis "," redisConnection","getNativeConnection"," jedis"," success ","equals","result","language-lua","else","由于对ffmpeg基本一窍不通，所以只能在网上搜索一下别人写好的ffmpeg参数，复制粘贴一下，做个备忘。","\n-r ","5","25"," Input","28","\n    x_train ","\n    x_test "," strides","64","latent_dim","np"," input_tensor\n    output_tensor ","\n\n    output_tensor ","mean_output_tensor"," variance_output_tensor"," mean_output_tensor"," Model","None","monitor","'val_loss'"," vae","batch_size","save"," load_model","figure","range","len","cp","\"host\""," -d: -f3"," t ","NULL","n ","多路复用IO","Serial与Serial Old","Parallel Scavenge与Parallel Old","CMS收集器",3,"h3","java除了基本类型以外，其余的都是引用类型。\n而java的引用类型有四种：强引用，软引用，弱引用和虚引用。\n除了强引用外，其余的引用都是抽象类Reference的子类。","10\u003Cage\u003C20","----+-------------+--------------+-------+---------------+---------+---------+------+--------+-----------------------+","\n  current_token "," math"," current_token","current_token"," next_free_ticket_micros "," stored_permits ","REQUIRED","NESTED","REQUIRES_NEW","MANDATORY","SUPPORTS","NOT_SUPPORTED","NEVER","父子方法同一事务","Map","这篇文章的标题我也不知道是不是题文相关，依照分布式一致性和Zab协议这两个关键字搜索看了好多篇文章，但是依然很迷糊。\n有些文章甚至研究的是区块链里的分布式一致性算法（大佬，告辞）。\n所以叫迷谈，但尽量不胡谈，起码是参考过别的文章，不是瞎掰。",10000,"青春猪头-牧之原翔子-江之岛","博客2.0装修","2020-01-30T00:00:00.000Z","首页","https:\u002F\u002Fblinkfox.github.io\u002F","闪烁之狐","导航","。","template","b-navbar","b-collapse","\n      ","b-navbar-nav","b-nav-item","i","b","其他组件","装修时参考的网站","https:\u002F\u002Fkabukky.github.io\u002Fjourney\u002F","https:\u002F\u002Fboo-demo.poeticthemes.com\u002F","https:\u002F\u002Fjekflix.rossener.com\u002F","http:\u002F\u002Farkadianriver.github.io\u002Fspectral\u002F","\u002F随笔\u002F20200130","2020-01-30","n1安装armbian做小pc","2020-02-21T00:00:00.000Z","#%E5%89%8D%E8%AE%B0","之前刚入手n1的时候就是想倒腾Armbian做小pc的，但是当时出于几个原因就放弃了。","一是当时以为，只要有断电强关机，系统就会崩掉。\n实际上并不会，当时崩了以为只是以为我自己搞崩的，然后无法重启只能强行断电，然后以为断电搞崩了。。。","二是我没成功安装中文输入法。","三是内存只有2G，浏览器打开三四个非视频页面还行的，再多就卡爆","四是视频播放不支持硬解，看网页视频或者播放本地视频只能到720，不然就是看ppt加卡爆。","但是生命不息，折腾不止，心想给n1刷个Armbian桌面版能做个垃圾小pc，再装上docker能做个下载机和垃圾nas，最后再在docker装个openwrt来个旁路由，想想都觉得自己血赚。。。","#%E6%B3%A8%E6%84%8F","下面的操作步骤最好按顺序，不然有可能会莫名其妙的崩掉。已经下面会有几次reboot命令，请不要偷懒，最后才来reboot，否则也可能会莫名其妙的崩掉。","准备","降级","https:\u002F\u002Floksado.com\u002F2020\u002F02\u002Fdownload-armbian-linux-untuk-hg680p-dan-b860h-amlogic-s905-p212\u002F","n1切换为启动盘模式","原系统备份与还原","\nddbr -"," y -"," y\n","网络问题","source","# Wired adapter #1","替换apt源","设置时区为北京时间","&&","rm","支持中文显示","LANG","LANGUAGE","\"zh_CN:zh\"","LC_NUMERIC","LC_TIME","LC_MONETARY","LC_PAPER","LC_NAME","LC_ADDRESS","LC_TELEPHONE","LC_MEASUREMENT","LC_IDENTIFICATION","LC_ALL","安装谷歌拼音输入法","安装","安装docker","https:\u002F\u002Fyeasy.gitbooks.io\u002Fdocker_practice\u002Finstall\u002Fubuntu.html","curl"," -fsSL get.docker.com -o get-docker.sh\n","sh"," get-docker.sh --mirror Aliyun\n","安装openwrt做旁路由","192.168","\n--name openwrt ","\n--network macnet ","\n--privileged ","vi","'static'","\n        option ipaddr ","\n        option netmask ","\n\nconfig interface ","'192.168.123.1'","安装火狐浏览器","\"log-driver\"","\"json-file\"","\"log-opts\"","\"max-size\"","\"5m\"",", ","\"max-file\"","\"3\""," systemctl daemon-reload\n"," systemctl restart ","\n                ","$log","chmod","清理","一些docker镜像"," volume create portainer_data\n","8000","9000","445","9900","git","51413","\n--name qbittorrent ",":6881 ",":6881\u002Fudp ","8080","9092","现有问题","\u002F折腾\u002F20200221","2020-02-21","SpringBoot的配置文件","2020-03-19T00:00:00.000Z","配置文件加载优先级","配置的使用与装配","\"user\"","@Value","加载指定的配置文件","encoding","implements","@Override","createPropertySource","@Nullable","EncodedResource","throws","IOException","ResourcePropertySource","YamlPropertiesFactoryBean","动态刷新bean","@Slf4j","RedisConnectionFactory","redisConnectionFactory","getDatabase","getHost","getPort","JedisPoolConfig","JedisConnectionFactory","redisTemplate","StringRedisSerializer","DataSource","dataSource","JdbcTemplate","参考文章","\u002F框架\u002F20200319","2020-03-19","博客评论系统","2020-04-02T00:00:00.000Z","#%E9%80%89%E5%9E%8B","Disqus，需要翻墙，不过我不觉得是什么问题。","来必力，韩国的评论系统，自带中文，无需翻墙。感觉比Disqus要友好。","Valine，开源的前端评论框架，数据保存在leancloud里。leancloud貌似是国内服务，注册需要手机，告辞。","utterances、gitalk、gitment、vssue等issue系，利用github的issue实现的评论系统。数据难以备份和迁移，对于每一页的博文都要手动去初始化，略有麻烦。然后看到","一文，说了一句卧槽，告辞。","commento，开源的评论系统，服务端可以自己部署，不过依赖于PostgreSQL数据库，太小题大做了，管理麻烦，下一个。","Statiman，开源的评论系统，服务端可以自己部署，将评论保存在yaml或者json文件，然后保存到github库上。很方便对数据进行备份迁移，看来一下部署教程有点复杂，自己部署服务数据还不在自己手上，作罢。","Isso，也是个开源的评论系统，服务端好像是用php写的，占几十m内存，数据库用sqlite，docker部署，备份管理简单。","最后我还是选择了Isso。由于Disqus被墙，也不是很好看，所以本来我是想用来必力的了。但是基于能不注册就不注册，数据能在自己手里就在自己手里的原则，最后还是选择了自己搭建，也就几十M内存，还过得去。","always -p ","caddy反代","坑","客户端代码","section","data-isso","https:\u002F\u002Fposativ.org\u002Fisso\u002F","\u002F折腾\u002F20200402","2020-04-02","redis锁与redis计数器","2020-04-16T00:00:00.000Z","redlock","Redlock","场景与问题","现有的redis锁逻辑","tryLock","long"," time"," timeUnit","opsForValue","unLock","改进思路","redis分布式锁","jedis","org","springframework","core","java","util","RedisLockImpl"," instanceId","secondsToExpire ","\u003C=","error","\"过期时间不得小于等于0\""," script ","eval","instanceId"," SUCCESS","\u002F\u002F","'get'","~="," ARGV","'del'","==","redis计数器","\u002F中间件\u002F20200416","2020-04-16","ffmpeg参数备忘","2020-04-22T00:00:00.000Z","将一个视频转为多张图片","ffmpeg ","将一个图片转为视频","转为音频","\u002F折腾\u002F20200422","2020-04-22","keras实现mnist数据集的VEA模型","2020-04-30T00:00:00.000Z","自己用keras写了个VAE自编码器，用的是mnist数据集。参考了《Python深度学习》_2018中文版.pdf和","https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F54032548","深度学习第52讲：变分自编码器VAE原理以及keras实现","里的实现","用CPU跑真是慢死了，人生苦短，莫得N卡.","调参调了一整天，噫吁嚱。"," keras "," Flatten"," Lambda"," Reshape"," _","astype","'float32'","255."," input_shape"," random_data","print","indexs","mean_variance_merge","14","hide_shape"," VaeLossLayer","\n\n    input_tensor "," conv2D_layer1","# output_tensor = max_pool_layer1(output_tensor)"," conv2D_layer2","# output_tensor = max_pool_layer2(output_tensor)"," flatten_layer"," dense_layer1"," mean_layer"," dense_layer2"," reshape_layer"," conv2DTranspose_layer1"," conv2D_layer4"," loss","\n    encoder ","\n    decoder "," encoder"," vae\n\n\n","flatten","mean"," variance_output_tensor ","exp","variance_output_tensor"," latent_dim","fit","vae","encoder","'my_vae-encoder.h5'","'my_vae-decoder.h5'","'my_vae-vae.h5'","decoder"," norm","ppf","linspace","0.05","0.95","enumerate","\n            z_sample ","z_sample"," batch_size","i ","\n    plt","'acc'","history ","and","'val_acc'","\n        epochs ","'bo'","'b'","title","legend","'loss'","\u002F算法\u002F20200430","2020-04-30","安装ubuntu18常用软件手记","2020-05-03T00:00:00.000Z","更新源","搜狗输入法","#%E8%B0%B7%E6%AD%8C%E6%B5%8F%E8%A7%88%E5%99%A8","略","其他软件","gnome-tweak","https:\u002F\u002Fextensions.gnome.org\u002Fextension\u002F750\u002Fopenweather\u002F","https:\u002F\u002Fextensions.gnome.org\u002Fextension\u002F120\u002Fsystem-monitor\u002F","https:\u002F\u002Fextensions.gnome.org\u002Fextension\u002F1112\u002Fscreenshot-tool\u002F","https:\u002F\u002Fextensions.gnome.org\u002Fextension\u002F1320\u002Fnvidia-gpu-stats-tool\u002F","https:\u002F\u002Fextensions.gnome.org\u002Fextension\u002F1166\u002Fextension-update-notifier\u002F","字体","cd"," \u002Fusr\u002Fshare\u002Ffonts\u002Fwin\n","主题","设置硬件时间为本地时间","https:\u002F\u002Fgithub.com\u002Foldj\u002FSwitchHosts\u002Fblob\u002Fmaster\u002FREADME_cn.md","https:\u002F\u002Fgithub.com\u002F521xueweihan\u002FGitHub520","shell","grub启动","zsh","https:\u002F\u002Fe99net.github.io\u002F2018\u002F06\u002F07\u002Finstall_oh-my-zsh_of_ubuntu\u002F","截图","\n  --device \u002Fdev\u002Fsnd ","\n  --ipc","\n  -v \u002Ftmp\u002F.X11-unix:\u002Ftmp\u002F.X11-unix ","DISPLAY","unix","$DISPLAY","XMODIFIERS","@im","QT_IM_MODULE","GTK_IM_MODULE","AUDIO_GID","getent group audio ","GID"," -g","UID"," -u","\u002F折腾\u002F20200503","2020-05-03","一些SQL知识点","2020-05-09T00:00:00.000Z","数据","内连接","左连接","33","   小白  ","右连接","13","4","       西京\n","全连接"," name ","\u002F中间件\u002F20200509","2020-05-09","一些位运算","2020-05-12T00:00:00.000Z","位运算","修改位","&","获取位情况","\u002F算法\u002F20200512","2020-05-12","Linux的IO模型","2020-05-13T00:00:00.000Z","本文主要是","https:\u002F\u002Fmp.weixin.qq.com\u002Fs\u002FRkncXcZT4nDQgdLeUcFaxQ","聊聊 Linux 中的五种 IO 模型","的概括。","同步非阻塞IO","异步非阻塞IO","非阻塞,异步等回调","同步阻塞IO（BIO）","同步非阻塞IO（NIO）","异步非阻塞IO（AIO）","关于异步阻塞","总结","poll","epoll","\u002F操作系统\u002F20200513","2020-05-13","垃圾收集算法与垃圾收集器","2020-05-15T00:00:00.000Z","serial与serial-old","parnew","ParNew","parallel-scavenge与parallel-old","cms收集器","g1收集器","G1收集器","g1内存划分","G1内存划分","remembered-set","Remembered Set","g1回收步骤","G1回收步骤","对象存活判断","垃圾收集算法","先标记","垃圾收集器","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","初始标记：STW，只是标记一下GC Roots能直接关联到的对象，速度很快","并发标记：进行可达性分析，耗时长","\u002Fjava\u002F20200515","2020-05-15","Java引用类型","2020-05-18T00:00:00.000Z","强引用","虚引用","\u002Fjava\u002F20200518","2020-05-18","MQ总结","2020-06-01T00:00:00.000Z","kafka端","Kafka端","消费积压","\u002F中间件\u002F20200601","2020-06-01","ElasticSearch总结","ES的数据结构：index -\u003E type -\u003E document -\u003E field。","每一个索引会被分为多个shard，每个shard保存部分数据，分别放在不同节点上。\nshard有主shard允许读写，从shard允许读，从shard会与主shard同步数据。\nES集群会选举出一个主节点，负责维护索引元数据和管理主shard和从shard。","ES写数据请求：客户端选择一个节点作为自己的协调节点，协调节点根据请求文档进行路由。\n把请求转发给主shard所在的节点，当从shard也同步完成了，协调节点才会给客户端响应。","ES读数据请求：客户端选择一个节点作为自己的协调节点，协调节点根据请求文档进行路由。\n在主shard和全部从shard节点上轮询一个节点进行请求转发，然后把结果返回给客户端。","倒排索引","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","doc id","\u002F中间件\u002F20200602","Taf框架","\u002F框架\u002F20200602","Redis总结","2020-06-03T00:00:00.000Z","sorted-set","sorted set","rdb","RDB","aof","AOF","缓存作用","的2^n大小的","缓存淘汰策略","集群模式","缓存雪崩","缓存穿透","缓存击穿","\u002F中间件\u002F20200603","2020-06-03","MySQL总结","2020-06-09T00:00:00.000Z","mysql架构","并发控制","最左匹配原则","explain字段含义"," tb_devicemap ","rows","index","读写分离","分库分表","优化","支持","不支持","数据恢复","\u002F中间件\u002F20200609","2020-06-09","Java并发","2020-06-17T00:00:00.000Z","java内存模型jmm","#java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8Bjmm","java内存模型(JMM)","JMM模型下，每个线程都有自己的本地内存，线程对内存的操作也是先操作本地内存。\n之后才将本地内存的数据刷新到主内存里，让各个线程更新共享。","内存屏障","其他线程可见后才","读","写","volatile","synchronized","队列同步器","功能","await()","\u002Fjava\u002F20200617","2020-06-17","API网关总结","#%E6%9C%8D%E5%8A%A1%E6%8E%A5%E5%85%A5","API网关最重要的功能就是提供服务的统一接入。\n通常是外部服务统一经过API网关请求到内部不同的服务。\n这样内部服务不会直接暴露在外部，保护了内部服务的安全。\n外部服务也只需要面向API网关进行对接即可，不用跟内部各种异构的服务打交道。","异步请求","链式处理","业务隔离","管理平台","\u002Fblog-code\u002Fpage\u002F$E5$88$86$E5$B8$83$E5$BC$8F\u002F20200703\u002F1\u002F","分布式限流","固定窗口计数器","滑动窗口计数器","漏桶算法","令牌桶算法","令牌桶算法的实现","'last_time'","'current_token'"," current_token ","nil","last_time\n  ","reverse_time","last_time"," required_permits ","'hget'","'next_free_ticket_micros'","or","time","1000000","'stored_permits'","now_micros "," next_free_ticket_micros","min"," now_micros\n"," moment_available "," fresh_permits "," stored_permits_to_spend","'hset'","Spring事务总结","2020-07-07T00:00:00.000Z","required","nested","requires_new","mandatory","supports","not_supported","never","事务传播行为","报错","父子方法各自独立","\u002F框架\u002F20200707","2020-07-07","分布式ID","雪花算法","\u002Fblog-code\u002Fpage\u002F$E5$88$86$E5$B8$83$E5$BC$8F\u002F20200709\u002F1\u002F","分布式事务","本地消息表","最大努力通知","可靠消息服务","Spring Bean总结","2020-07-14T00:00:00.000Z","ObjectFactory","HashMap","16","\u002F框架\u002F20200714","2020-07-14","虚拟IP","2020-07-15T00:00:00.000Z","\u002F分布式\u002F20200715","2020-07-15","Spring Cloud组件总结","2020-07-17T00:00:00.000Z","eureka","Eureka","ribbon","Ribbon","feign","Feign","hystrix","Hystrix","zuulzuul2与gateway","Zuul、Zuul2与Gateway","微服务","注册中心","客户端均衡负载","声明式web客户端","配置中心","熔断器","服务网关","消息总线","组件发音","\u002F分布式\u002F20200717","2020-07-17","2020-07-27T00:00:00.000Z","删除缓存导致缓存击穿","解决并发更新缓存","解决删除缓存失败","强一致性","\u002F分布式\u002F20200727","2020-07-27","迷谈分布式一致性","2020-07-30T00:00:00.000Z","分布一致性类型","两阶段提交","https:\u002F\u002Fzhuanlan.51cto.com\u002Fart\u002F201910\u002F604122.htm","上面有几个补充说明的问题：","\u002F分布式\u002F20200730","2020-07-30","windows重装系统常用软件手记","2020-12-26T00:00:00.000Z","https:\u002F\u002Fwww.google.com\u002Fintl\u002Fzh-CN\u002Fchrome\u002F","油猴","https:\u002F\u002Fgithub.com\u002Fsyhyz1990\u002Fbaiduyun","https:\u002F\u002Fkms.cangshui.net\u002F","火绒","https:\u002F\u002Fwww.huorong.cn\u002F","https:\u002F\u002Fnotepad-plus-plus.org\u002Fdownloads\u002F","7zip","https:\u002F\u002Fwww.7-zip.org\u002Fdownload.html","https:\u002F\u002Fotp.landian.vip\u002Fzh-cn\u002Fdownload.html","https:\u002F\u002Fsourceforge.net\u002Fprojects\u002Fmpv-player-windows\u002Ffiles\u002F64bit\u002F","https:\u002F\u002Fgithub.com\u002FTranslucentTB\u002FTranslucentTB\u002Freleases","https:\u002F\u002Fgithub.com\u002Fc0re100\u002FqBittorrent-Enhanced-Edition\u002Freleases","https:\u002F\u002Fraw.githubusercontent.com\u002Fngosang\u002Ftrackerslist\u002Fmaster\u002Ftrackers_all.txt","微信","https:\u002F\u002Fpc.weixin.qq.com\u002F","https:\u002F\u002Fgithub.com\u002Fhuiyadanli\u002FRevokeMsgPatcher\u002Freleases","图片查看器","https:\u002F\u002Fcn.bandisoft.com\u002Fhoneyview\u002F","https:\u002F\u002Fwww.microsoft.com\u002Fzh-CN\u002Fdownload\u002Fdetails.aspx?id=30679","raidrive","https:\u002F\u002Fwww.raidrive.com\u002Fdownload","windows显示秒","https:\u002F\u002Fwalker-a.com\u002Farchives\u002F4096","\u002F折腾\u002F20201226","2020-12-26")));