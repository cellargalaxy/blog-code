__NUXT_JSONP__("/view/$E4$B8$AD$E9$97$B4$E4$BB$B6/20200602/ElasticSearch$E6$80$BB$E7$BB$93", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K){return {data:[{siteConfig:{siteName:q,siteHost:"https:\u002F\u002Fcellargalaxy.github.io",basePath:"\u002Fblog-code\u002F",navs:[{text:"文章",url:"\u002Fblog-code\u002Fpage\u002F1\u002F"},{text:"归档",url:"\u002Fblog-code\u002Farchive\u002F0\u002F"},{text:"画画",url:"\u002Fblog-code\u002Fhtml\u002Fhua.html"},{text:"开源",url:"\u002Fblog-code\u002Fhttps:\u002Fgithub.com\u002Fcellargalaxy\u002Fblog-vue"}],pageSize:10,urlReplace:{"^/file/blog/code":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode"},backgroundImage:{duration:r,fade:1000,images:[{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F01\u002F25\u002FcofTzDQXitjeVZ6.jpg",description:s,type:f},{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F01\u002F25\u002FsfaRJ2lVeM3NDbE.jpg",description:s,type:f},{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F01\u002F26\u002FKybiTdftam5Su7x.jpg",description:"青春猪头-双葉理央",type:f},{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F09\u002F08\u002FxdX73nfs24qgOYk.jpg",description:"京吹-明日香,久美子",type:f},{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F02\u002F14\u002FMAiruNcEFW2HYtg.jpg",description:"终将成为你-七海灯子,小糸侑",type:f},{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F02\u002F05\u002FEojdAxTDJsFpbPw.jpg",description:"玉子市场-北白川玉子",type:f},{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F01\u002F31\u002FAXxwJDRS9fmN2uU.jpg",description:"fate_hf-弓道馆",type:f},{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F02\u002F01\u002FaHhVObpJus6dnM4.jpg",description:"fate_hf-樱花树",type:f}]}},homeConfig:{brandInterval:r,brands:[{imageUrl:"https:\u002F\u002Fi.loli.net\u002F2020\u002F01\u002F21\u002FmMEAnwY5XPC2pFb.jpg",title:"日常",texts:["我们所度过的每个平凡的日常，也许就是连续不断发生的奇迹。","日々、私たちが過ごしている日常は、実は奇跡の連続なのかもしれない。"]},{imageUrl:"https:\u002F\u002Fi.loli.net\u002F2020\u002F04\u002F19\u002FH1MmXb9xPcYEhT2.jpg",title:"昨日之歌",texts:["时间梭梭箭如飞，人道漫漫步蹒跚","人間そんな変わるもんじゃないのに、月日ばっかどんどん過ぎて"]}],navs:[{text:"Github",url:"https:\u002F\u002Fgithub.com\u002Fcellargalaxy\u002F"}]},pageFootConfig:{lines:[[{text:"Copyright © 2017-? ."},{text:"备案？不存在的"},{text:"Powered by Nuxt.js & Github"}]]},buildTime:new Date(1652943413902),siteName:q,file:{slug:t,description:"ES的数据结构：index -\u003E type -\u003E document -\u003E field。\n每一个索引会被分为多个shard，每个shard保存部分数据，分别放在不同节点上。\nshard有主shard允许读写，从shard允许读，从shard会与主shard同步数据。\nES集群会选举出一个主节点，负责维护索引元数据和管理主shard和从shard。\nES写数据请求：客户端选择一个节点作为自己的协调节点，协调节点根据请求文档进行路由。\n把请求转发给主shard所在的节点，当从shard也同步完成了，协调节点才会给客户端响应。\nES读数据请求：客户端选择一个节点作为自己的协调节点，协调节点根据请求文档进行路由。\n在主shard和全部从shard节点上轮询一个节点进行请求转发，然后把结果返回给客户端。",createdAt:u,updatedAt:u,toc:[],body:{type:v,children:[{type:b,tag:e,props:{},children:[{type:a,value:w}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:x}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:y}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:z}]},{type:a,value:c},{type:a,value:c},{type:b,tag:i,props:{id:"es写数据原理"},children:[{type:b,tag:j,props:{ariaHidden:k,href:"#es%E5%86%99%E6%95%B0%E6%8D%AE%E5%8E%9F%E7%90%86",tabIndex:l},children:[{type:b,tag:m,props:{className:[n,o]},children:[]}]},{type:a,value:"ES写数据原理"}]},{type:a,value:c},{type:b,tag:A,props:{},children:[{type:a,value:c},{type:b,tag:p,props:{},children:[{type:a,value:"将数据写入buffer，在buffer时是不可查询的"}]},{type:a,value:c},{type:b,tag:p,props:{},children:[{type:a,value:"buffer快慢或者定时1秒，将buffer数据写入系统缓存里，此时数据可查询。"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"ES会定时5秒把系统缓存的数据写到translog文件里，以便重启后恢复。\n3. 当translog文件够大或者定时30分钟，ES会把buffer和translog文件里的数据写到硬盘上。"}]},{type:a,value:c},{type:b,tag:i,props:{id:"es更删数据原理"},children:[{type:b,tag:j,props:{ariaHidden:k,href:"#es%E6%9B%B4%E5%88%A0%E6%95%B0%E6%8D%AE%E5%8E%9F%E7%90%86",tabIndex:l},children:[{type:b,tag:m,props:{className:[n,o]},children:[]}]},{type:a,value:"ES更\u002F删数据原理"}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"删数据会在一个"},{type:b,tag:"code",props:{},children:[{type:a,value:".del"}]},{type:a,value:"文件里标明这个文档已经被删除。而更新则是先删再插入一条新的文档。"}]},{type:a,value:c},{type:b,tag:i,props:{id:B},children:[{type:b,tag:j,props:{ariaHidden:k,href:"#%E5%80%92%E6%8E%92%E7%B4%A2%E5%BC%95",tabIndex:l},children:[{type:b,tag:m,props:{className:[n,o]},children:[]}]},{type:a,value:B}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"对文件提取一些词，标记这些词在哪些文档里出现过，当查询关键字的时候就能快速返回包含关键字的文档。"}]},{type:a,value:"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{type:b,tag:C,props:{},children:[{type:b,tag:D,props:{},children:[{type:b,tag:g,props:{},children:[{type:b,tag:h,props:{},children:[{type:a,value:E}]},{type:b,tag:h,props:{},children:[{type:a,value:"doc"}]}]}]},{type:b,tag:F,props:{},children:[{type:b,tag:g,props:{},children:[{type:b,tag:d,props:{},children:[{type:a,value:G}]},{type:b,tag:d,props:{},children:[{type:a,value:"google 推特"}]}]},{type:b,tag:g,props:{},children:[{type:b,tag:d,props:{},children:[{type:a,value:H}]},{type:b,tag:d,props:{},children:[{type:a,value:"推特 facebook"}]}]},{type:b,tag:g,props:{},children:[{type:b,tag:d,props:{},children:[{type:a,value:I}]},{type:b,tag:d,props:{},children:[{type:a,value:"facebook google"}]}]}]}]},{type:a,value:"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{type:b,tag:C,props:{},children:[{type:b,tag:D,props:{},children:[{type:b,tag:g,props:{},children:[{type:b,tag:h,props:{},children:[{type:a,value:"word id"}]},{type:b,tag:h,props:{},children:[{type:a,value:"word"}]},{type:b,tag:h,props:{},children:[{type:a,value:E}]}]}]},{type:b,tag:F,props:{},children:[{type:b,tag:g,props:{},children:[{type:b,tag:d,props:{},children:[{type:a,value:G}]},{type:b,tag:d,props:{},children:[{type:a,value:"google"}]},{type:b,tag:d,props:{},children:[{type:a,value:"1,3"}]}]},{type:b,tag:g,props:{},children:[{type:b,tag:d,props:{},children:[{type:a,value:H}]},{type:b,tag:d,props:{},children:[{type:a,value:"推特"}]},{type:b,tag:d,props:{},children:[{type:a,value:"1,2"}]}]},{type:b,tag:g,props:{},children:[{type:b,tag:d,props:{},children:[{type:a,value:I}]},{type:b,tag:d,props:{},children:[{type:a,value:"facebook"}]},{type:b,tag:d,props:{},children:[{type:a,value:"2,3"}]}]}]}]},{type:a,value:c},{type:b,tag:i,props:{id:"大数据量es"},children:[{type:b,tag:j,props:{ariaHidden:k,href:"#%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%87%8Fes",tabIndex:l},children:[{type:b,tag:m,props:{className:[n,o]},children:[]}]},{type:a,value:"大数据量ES"}]},{type:a,value:c},{type:b,tag:A,props:{},children:[{type:a,value:c},{type:b,tag:p,props:{},children:[{type:a,value:"虽然ES把数据写到了硬盘，但是操作系统会对硬盘的数据进行系统缓存到内存里。所以导致第一次查很慢，之后就很快了。"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"为了尽量能走系统缓存，应该尽量留多一点可用内存给操作系统而不是服务本身。最好可用内存为数据量的一半或以上\n2. 进行冷热数据分离\n3. ES的数据只保留查询字段，减少数据体积，非查询字段通过文档id再去其他地方查\n4. 数据预热\n5. ES的分页查询是每次都是从头查到中间的（像链表那样），不允许深页查，跳页查，可以一次性返回前N页自己分页"}]}]},excerpt:{type:v,children:[{type:b,tag:e,props:{},children:[{type:a,value:w}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:x}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:y}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:z}]}]},dir:J,path:"\u002F中间件\u002F20200602\u002FElasticSearch总结",extension:".md",title:t,url:"\u002Fblog-code\u002Fview\u002F$E4$B8$AD$E9$97$B4$E4$BB$B6\u002F20200602\u002FElasticSearch$E6$80$BB$E7$BB$93\u002F",createAt:new Date(1591056000000),updateAt:new Date(1591056000000),attributes:[{name:"createAt",value:K},{name:"updateAt",value:K},{name:"sort",value:J,url:"\u002Fblog-code\u002Fpage\u002F$E4$B8$AD$E9$97$B4$E4$BB$B6\u002F20200602\u002F1\u002F"}]}}],fetch:{},mutations:void 0}}("text","element","\n","td","p","wide","tr","th","h1","a","true",-1,"span","icon","icon-link","li","无名の窝",10000,"青春猪头-牧之原翔子-江之岛","ElasticSearch总结","2020-06-02T00:00:00.000Z","root","ES的数据结构：index -\u003E type -\u003E document -\u003E field。","每一个索引会被分为多个shard，每个shard保存部分数据，分别放在不同节点上。\nshard有主shard允许读写，从shard允许读，从shard会与主shard同步数据。\nES集群会选举出一个主节点，负责维护索引元数据和管理主shard和从shard。","ES写数据请求：客户端选择一个节点作为自己的协调节点，协调节点根据请求文档进行路由。\n把请求转发给主shard所在的节点，当从shard也同步完成了，协调节点才会给客户端响应。","ES读数据请求：客户端选择一个节点作为自己的协调节点，协调节点根据请求文档进行路由。\n在主shard和全部从shard节点上轮询一个节点进行请求转发，然后把结果返回给客户端。","ol","倒排索引","table","thead","doc id","tbody","1","2","3","\u002F中间件\u002F20200602","2020-06-02")));