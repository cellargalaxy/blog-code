__NUXT_JSONP__("/view/协议/20180318/TCP三次握手与四次分手", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E){return {data:[{siteConfig:{siteName:u,siteHost:"https:\u002F\u002Fcellargalaxy.github.io",basePath:"\u002Fblog-code\u002F",navs:[{text:"文章",url:"\u002Fblog-code\u002Fpage\u002F1\u002F"},{text:"归档",url:"\u002Fblog-code\u002Farchive\u002F0\u002F"},{text:"画画",url:"\u002Fblog-code\u002Fhtml\u002Fhua.html"},{text:"开源",url:"\u002Fblog-code\u002Fhttps:\u002Fgithub.com\u002Fcellargalaxy\u002Fblog-vue"}],pageSize:10,urlReplace:{"^/file/blog/code":"https:\u002F\u002Foracleamd1.dynv6.net\u002Ffile\u002Ffile\u002Fblog\u002Fcode"},backgroundImage:{duration:v,fade:1000,images:[{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F01\u002F25\u002FcofTzDQXitjeVZ6.jpg",description:w,type:f},{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F01\u002F25\u002FsfaRJ2lVeM3NDbE.jpg",description:w,type:f},{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F01\u002F26\u002FKybiTdftam5Su7x.jpg",description:"青春猪头-双葉理央",type:f},{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F09\u002F08\u002FxdX73nfs24qgOYk.jpg",description:"京吹-明日香,久美子",type:f},{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F02\u002F14\u002FMAiruNcEFW2HYtg.jpg",description:"终将成为你-七海灯子,小糸侑",type:f},{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F02\u002F05\u002FEojdAxTDJsFpbPw.jpg",description:"玉子市场-北白川玉子",type:f},{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F01\u002F31\u002FAXxwJDRS9fmN2uU.jpg",description:"fate_hf-弓道馆",type:f},{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F02\u002F01\u002FaHhVObpJus6dnM4.jpg",description:"fate_hf-樱花树",type:f}]}},homeConfig:{brandInterval:v,brands:[{imageUrl:"https:\u002F\u002Fi.loli.net\u002F2020\u002F01\u002F21\u002FmMEAnwY5XPC2pFb.jpg",title:"日常",texts:["我们所度过的每个平凡的日常，也许就是连续不断发生的奇迹。","日々、私たちが過ごしている日常は、実は奇跡の連続なのかもしれない。"]},{imageUrl:"https:\u002F\u002Fi.loli.net\u002F2020\u002F04\u002F19\u002FH1MmXb9xPcYEhT2.jpg",title:"昨日之歌",texts:["时间梭梭箭如飞，人道漫漫步蹒跚","人間そんな変わるもんじゃないのに、月日ばっかどんどん過ぎて"]}],navs:[{text:"Github",url:"https:\u002F\u002Fgithub.com\u002Fcellargalaxy\u002F"}]},pageFootConfig:{lines:[[{text:"Copyright © 2017-? ."},{text:"备案？不存在的"},{text:"Powered by Nuxt.js & Github"}]]},buildTime:new Date(1684669992503),siteName:u,file:{slug:x,description:g,createdAt:y,updatedAt:y,toc:[],body:{type:z,children:[{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"学完计算机网络之后再次看TCP的握手和分手，突然悟到了一种对为什么握手要三次，分手要四次的通俗解释。首先，TCP是要确保连接正常的。对于任意一方，则是确保对方是正常的。一方要测试另一方正常，需要一个应答来确认，一应一答为两次。既然TCP双方都需要确认对方正常，那至少要四次握手。但是在在第一次应答的答中，除了回答之外还可以顺便提出请求，所以合并了成了三次握手。同样分手也要四次，但是这四次不能合并，因为两次应答之间可能还有数据需要传输，所以分手是四次。"}]},{type:a,value:c},{type:b,tag:j,props:{id:"tcp报文段首部"},children:[{type:b,tag:h,props:{href:"#tcp%E6%8A%A5%E6%96%87%E6%AE%B5%E9%A6%96%E9%83%A8",ariaHidden:k,tabIndex:l},children:[{type:b,tag:m,props:{className:[n,o]},children:[]}]},{type:a,value:"TCP报文段首部"}]},{type:a,value:c},{type:b,tag:p,props:{},children:[{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"序号：这个报文发送的数据的第一个数据，在整个TCP连接中的序号"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"确认号：你下次可以发送序号开始n+1的数据，言下之意就是序号小于n的数据我都收到了"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"ACK：有两个取值：0和1。为1的时候表示应答域有效，反之为0"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"SYN：表示同步序号，用来建立连接。SYN=1的报文不能传输数据，但是消耗一个序号"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"FIN：为1时表示报文发送方以及没有数据要传输，要断开连接，消耗一个序号"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:b,tag:i,props:{alt:g,"data-src":"https:\u002F\u002Fcamo.githubusercontent.com\u002F78f58951bb9ea91fb68d5cb85e4b0136d997cdbd\u002F687474703a2f2f696d672e6d792e6373646e2e6e65742f75706c6f6164732f3230313231302f32332f313335303938343238335f353835372e6a7067"},children:[]}]},{type:a,value:c},{type:b,tag:j,props:{id:"tcp三次握手"},children:[{type:b,tag:h,props:{href:"#tcp%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B",ariaHidden:k,tabIndex:l},children:[{type:b,tag:m,props:{className:[n,o]},children:[]}]},{type:a,value:"TCP三次握手"}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:b,tag:i,props:{alt:g,"data-src":"https:\u002F\u002Foracleamd1.dynv6.net\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20180314\u002Fupload-images.jianshu.io-upload_images-2964446-fdfb1a8fce8de946.png.1.png"},children:[]}]},{type:a,value:c},{type:b,tag:p,props:{},children:[{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"首先服务器处于监听状态。客户端发送第一个报文，seq=x。因为是刚要建立连接，所以ack不知道，SYN=1。这是客户端进入SYN_SEND状态。"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:b,tag:i,props:{alt:g,"data-src":"https:\u002F\u002Foracleamd1.dynv6.net\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20180318\u002Fwww.centos.bz-wp-content-uploads-2012-08-100327002911.png.1.png"},children:[]},{type:a,value:"\n2. 服务器收到报文要建立连接。seq=y，ack=x+1，SYN=1，ACK=1。服务器进入SYN_RECV状态。\n"},{type:b,tag:i,props:{alt:g,"data-src":"https:\u002F\u002Foracleamd1.dynv6.net\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20180318\u002Fwww.centos.bz-wp-content-uploads-2012-08-100327003054.png.1.png"},children:[]},{type:a,value:"\n3. 客户端收到服务端的确认，进入ESTABLISHED状态。然后发送seq=x+1（SNY消耗一个序号），ack=y+1，ACK=1的报文\n"},{type:b,tag:i,props:{alt:g,"data-src":"https:\u002F\u002Foracleamd1.dynv6.net\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20180318\u002Fwww.centos.bz-wp-content-uploads-2012-08-100327003214.png.1.png"},children:[]},{type:a,value:"\n4. 服务器收到之后，也进入ESTABLISHED状态，三次握手完成之后数据传输的报文ACK都为1。"}]},{type:a,value:c},{type:b,tag:j,props:{id:"tcp四次分手"},children:[{type:b,tag:h,props:{href:"#tcp%E5%9B%9B%E6%AC%A1%E5%88%86%E6%89%8B",ariaHidden:k,tabIndex:l},children:[{type:b,tag:m,props:{className:[n,o]},children:[]}]},{type:a,value:"TCP四次分手"}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:b,tag:i,props:{alt:g,"data-src":"https:\u002F\u002Foracleamd1.dynv6.net\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20180318\u002Fupload-images.jianshu.io-upload_images-1641067-5ed8bf6c24244b4c.png.1.png"},children:[]}]},{type:a,value:c},{type:b,tag:p,props:{},children:[{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"A方提出分手：发送seq=u，FIN=1的报文。A进入FIN_WAIT_1状态，FIN_WAIT_1状态等的是B确认自己发送的FIN报文"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"B收到FIN报文，立即回复A自己已经收到A的FIN报文，发送seq=v，ack=u+1，ACK=1，B进入CLOSE_WAIT状态。"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"A收到B的确定报文，A进入FIN_WAIT_2状态，FIN_WAIT_2状态是等待B把他还没传输完的数据传输完。"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"B在CLOSE_WAIT状态下垂死挣扎，把还没传输完的数据传输给A。"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"B的数据也传输完了，发送seq=w，ack=u+1（CLOSE_WAIT传输过数据），ACK=1，FIN=1的报文，B进入LAST_ACK状态，等待A确认自己的FIN报文。"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"A收到B的FIN报文，发送seq=u+1（FIN消耗一个序号），ack=w+1，ACK=1的确认报文，A进入TIME_WAIT状态。"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"B收到A的确认，B自己关闭，如果收不到A的确认，再次发送FIN报文"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"A在TIME_WAIT状态下会等待2个MSL时间，等待B的报文。按道理，如果B收到A的报文就关闭了，A在这2个MSL时间里是收不到B的报文的，证明B真的关闭了，如果B没关闭，A就会在这2个MSL时间里收到B的报文。"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:a,value:"参考文献："}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:b,tag:h,props:{href:"https:\u002F\u002Fgithub.com\u002Fjawil\u002Fblog\u002Fissues\u002F14",rel:[q,r,s],target:t,title:A},children:[{type:a,value:A}]}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:b,tag:h,props:{href:"https:\u002F\u002Fwww.cnblogs.com\u002Fzmlctt\u002Fp\u002F3690998.html",rel:[q,r,s],target:t,title:B},children:[{type:a,value:B}]}]},{type:a,value:c},{type:b,tag:e,props:{},children:[{type:b,tag:h,props:{href:"https:\u002F\u002Fwww.jianshu.com\u002Fp\u002F9968b16b607e",rel:[q,r,s],target:t,title:C},children:[{type:a,value:C}]}]}]},excerpt:{type:z,children:[]},dir:D,path:"\u002F协议\u002F20180318\u002FTCP三次握手与四次分手",extension:".md",title:x,url:"\u002Fblog-code\u002Fview\u002F协议\u002F20180318\u002FTCP三次握手与四次分手\u002F",createAt:new Date(1521331200000),updateAt:new Date(1521331200000),attributes:[{name:"createAt",value:E},{name:"updateAt",value:E},{name:"sort",value:D,url:"\u002Fblog-code\u002Fpage\u002F协议\u002F20180318\u002F1\u002F"}]}}],fetch:{},mutations:void 0}}("text","element","\n","li","p","wide","","a","img","h1","true",-1,"span","icon","icon-link","ol","nofollow","noopener","noreferrer","_blank","无名の窝",10000,"青春猪头-牧之原翔子-江之岛","TCP三次握手与四次分手","2018-03-18T00:00:00.000Z","root","通俗大白话来理解TCP协议的三次握手和四次分手","TCP三次握手四次挥手详解","图解TCP协议中的三次握手和四次挥手","\u002F协议\u002F20180318","2018-03-18")));