__NUXT_JSONP__("/view/$E4$B8$AD$E9$97$B4$E4$BB$B6/20200609/MySQL$E6$80$BB$E7$BB$93", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_,$,aa,ab,ac,ad,ae,af,ag,ah){return {data:[{siteConfig:{siteName:I,siteHost:"https:\u002F\u002Fcellargalaxy.github.io",basePath:"\u002Fblog-code\u002F",navs:[{text:"文章",url:"\u002Fblog-code\u002Fpage\u002F1\u002F"},{text:"归档",url:"\u002Fblog-code\u002Farchive\u002F0\u002F"},{text:"画画",url:"\u002Fblog-code\u002Fhtml\u002Fhua.html"},{text:"开源",url:"\u002Fblog-code\u002Fhttps:\u002Fgithub.com\u002Fcellargalaxy\u002Fblog-vue"}],pageSize:10,urlReplace:{"^/file/blog/code":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode"},backgroundImage:{duration:J,fade:1000,images:[{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F01\u002F25\u002FcofTzDQXitjeVZ6.jpg",description:K,type:u},{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F01\u002F25\u002FsfaRJ2lVeM3NDbE.jpg",description:K,type:u},{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F01\u002F26\u002FKybiTdftam5Su7x.jpg",description:"青春猪头-双葉理央",type:u},{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F09\u002F08\u002FxdX73nfs24qgOYk.jpg",description:"京吹-明日香,久美子",type:u},{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F02\u002F14\u002FMAiruNcEFW2HYtg.jpg",description:"终将成为你-七海灯子,小糸侑",type:u},{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F02\u002F05\u002FEojdAxTDJsFpbPw.jpg",description:"玉子市场-北白川玉子",type:u},{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F01\u002F31\u002FAXxwJDRS9fmN2uU.jpg",description:"fate_hf-弓道馆",type:u},{url:"https:\u002F\u002Fi.loli.net\u002F2020\u002F02\u002F01\u002FaHhVObpJus6dnM4.jpg",description:"fate_hf-樱花树",type:u}]}},homeConfig:{brandInterval:J,brands:[{imageUrl:"https:\u002F\u002Fi.loli.net\u002F2020\u002F01\u002F21\u002FmMEAnwY5XPC2pFb.jpg",title:"日常",texts:["我们所度过的每个平凡的日常，也许就是连续不断发生的奇迹。","日々、私たちが過ごしている日常は、実は奇跡の連続なのかもしれない。"]},{imageUrl:"https:\u002F\u002Fi.loli.net\u002F2020\u002F04\u002F19\u002FH1MmXb9xPcYEhT2.jpg",title:"昨日之歌",texts:["时间梭梭箭如飞，人道漫漫步蹒跚","人間そんな変わるもんじゃないのに、月日ばっかどんどん過ぎて"]}],navs:[{text:"Github",url:"https:\u002F\u002Fgithub.com\u002Fcellargalaxy\u002F"}]},pageFootConfig:{lines:[[{text:"Copyright © 2017-? ."},{text:"备案？不存在的"},{text:"Powered by Nuxt.js & Github"}]]},buildTime:new Date(1652873657702),siteName:I,file:{slug:L,description:M,createdAt:N,updatedAt:N,toc:[],body:{type:O,children:[{type:a,value:c},{type:b,tag:p,props:{id:P},children:[{type:b,tag:l,props:{href:"#mysql%E6%9E%B6%E6%9E%84",ariaHidden:q,tabIndex:r},children:[{type:b,tag:e,props:{className:[s,t]},children:[]}]},{type:a,value:P}]},{type:a,value:c},{type:b,tag:i,props:{},children:[{type:b,tag:v,props:{},children:[{type:a,value:"连接\u002F线程处理器-\u003E[查询缓存-\u003E解析器-\u003E优化器](服务器层)-\u003E储存引擎"}]}]},{type:a,value:c},{type:b,tag:i,props:{},children:[{type:a,value:"mysql有一个线程池，每个连接的查询只会在一个单独的线程里处理。\n对于select语句，在解析语句之前，会检查缓存，缓存有就直接返回。"}]},{type:a,value:c},{type:b,tag:p,props:{id:Q},children:[{type:b,tag:l,props:{href:"#%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6",ariaHidden:q,tabIndex:r},children:[{type:b,tag:e,props:{className:[s,t]},children:[]}]},{type:a,value:Q}]},{type:a,value:c},{type:b,tag:i,props:{},children:[{type:a,value:"mysql使用读写锁进行并发控制，读锁共享，写锁独占。\n并且将锁的颗粒度分为表锁和行锁，由储存引擎实现。\nInnodb会检测并回滚持有最少的行级排它锁的事务。"}]},{type:a,value:c},{type:b,tag:i,props:{},children:[{type:a,value:"在Innodb中，多版本并发控制(MVCC)只在读已提交和可重复读两个隔离级别下运行。\n原理通过增加两个隐藏列，分别表示创建的事务版本号和删除的事务版本号。\n每一个事务都有一个版本号，版本号自动递增，例如在可重复读中："}]},{type:a,value:c},{type:b,tag:k,props:{},children:[{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"select：创建版本号小于当前，删除版本号为空或者大于当前"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"insert：创建版本号设置为当前"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"delete：删除版本号设置为当前"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"update：插入一条新的记录和创建版本号，设置旧的记录的删除版本号"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:p,props:{id:"事务特性acid与隔离级别"},children:[{type:b,tag:l,props:{href:"#%E4%BA%8B%E5%8A%A1%E7%89%B9%E6%80%A7acid%E4%B8%8E%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB",ariaHidden:q,tabIndex:r},children:[{type:b,tag:e,props:{className:[s,t]},children:[]}]},{type:a,value:"事务特性(ACID)与隔离级别"}]},{type:a,value:c},{type:b,tag:k,props:{},children:[{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"原子性(atomicity)：事务内的操作要不全部成功，要不全部失败"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"一致性(consistency)：无论事务成功与否，前后的数据都要保持一致性，不能无端的多了少了"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"隔离性(isolation)：在事务完成之前，其他事务对此不可见"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"持久性(durability)：一旦事务成功，哪怕数据库奔溃，修改的数据也不会丢失"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:k,props:{},children:[{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"读未提交：脏读"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"读已提交：不可重复读"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"可重复读（Innodb默认）\n"},{type:b,tag:k,props:{},children:[{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"幻读：如果事务查询"},{type:b,tag:v,props:{},children:[{type:a,value:D}]},{type:a,value:"的数量，别的事务新增一行age=15，回头再查"},{type:b,tag:v,props:{},children:[{type:a,value:D}]},{type:a,value:"会发现数量+1"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Innodb会通过Next-Key Lock(间隙锁(GAP Lock)+行锁(Record Lock))来锁定"},{type:b,tag:v,props:{},children:[{type:a,value:D}]},{type:a,value:"这个范围，阻塞新增的age=15。所以在Innodb下的可重复读并不会出现幻读"}]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"串行化"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:p,props:{id:"b树"},children:[{type:b,tag:l,props:{href:"#b%E6%A0%91",ariaHidden:q,tabIndex:r},children:[{type:b,tag:e,props:{className:[s,t]},children:[]}]},{type:a,value:"B+树"}]},{type:a,value:c},{type:b,tag:i,props:{},children:[{type:b,tag:"img",props:{alt:M,"data-src":"http:\u002F\u002F123.207.79.108\u002Ffile\u002Ffile\u002Fblog\u002Fcode\u002F20200609\u002Fpic4.zhimg.com-v2-7d3ce97965d423662372d63858d9a04f_r.jpg.JPEG"},children:[]},{type:a,value:"\nB+树是多叉树，每一个节点对应一块磁盘块，包含着大量的子节点的磁盘块指针。\n每一次查找读取一块磁盘块，通过二分法查找子节点，直到叶子节点，查询到具体数据的指针。\n具体数据的指针都在叶子节点里，非叶子节点不保存具体数据的指针，增加非叶子节点的子节点数量。使得B+树能更加矮，减少IO次数。"}]},{type:a,value:c},{type:b,tag:k,props:{},children:[{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"索引字段尽量要小，增加非叶子节点的子节点数量"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"对于联合索引，B+树会按联合索引的字段顺序构建树"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"尽量选择辨识度高（包含虽然值少但偏差大的）的字段做索引并排在联合索引的前面"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"尽量拓展现有索引，而不是新建索引"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:p,props:{id:R},children:[{type:b,tag:l,props:{href:"#%E6%9C%80%E5%B7%A6%E5%8C%B9%E9%85%8D%E5%8E%9F%E5%88%99",ariaHidden:q,tabIndex:r},children:[{type:b,tag:e,props:{className:[s,t]},children:[]}]},{type:a,value:R}]},{type:a,value:c},{type:b,tag:k,props:{},children:[{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"联合索引的where必须从左到右连续。但=和in可以乱序，mysql会帮忙调整顺序"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"like的通配符%不出现在开头"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"范围查询(\u003E、\u003C、between、like)可以用到索引，但是范围列后面的列无法用到索引"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"查询条件中不得含有函数或表达式"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:p,props:{id:S},children:[{type:b,tag:l,props:{href:"#explain%E5%AD%97%E6%AE%B5%E5%90%AB%E4%B9%89",ariaHidden:q,tabIndex:r},children:[{type:b,tag:e,props:{className:[s,t]},children:[]}]},{type:a,value:S}]},{type:a,value:c},{type:b,tag:"div",props:{className:["nuxt-content-highlight"]},children:[{type:b,tag:"pre",props:{className:["language-sql","line-numbers"]},children:[{type:b,tag:v,props:{},children:[{type:a,value:"mysql"},{type:b,tag:e,props:{className:[f,g]},children:[{type:a,value:T}]},{type:a,value:j},{type:b,tag:e,props:{className:[f,n]},children:[{type:a,value:"explain"}]},{type:a,value:j},{type:b,tag:e,props:{className:[f,n]},children:[{type:a,value:"select"}]},{type:a,value:" countryCode"},{type:b,tag:e,props:{className:[f,C]},children:[{type:a,value:","}]},{type:b,tag:e,props:{className:[f,n]},children:[{type:a,value:"status"}]},{type:a,value:j},{type:b,tag:e,props:{className:[f,n]},children:[{type:a,value:"from"}]},{type:a,value:U},{type:b,tag:e,props:{className:[f,n]},children:[{type:a,value:"where"}]},{type:a,value:" updateDate "},{type:b,tag:e,props:{className:[f,g]},children:[{type:a,value:T}]},{type:a,value:j},{type:b,tag:e,props:{className:[f,"string"]},children:[{type:a,value:"'2020-06-09'"}]},{type:b,tag:e,props:{className:[f,C]},children:[{type:a,value:";"}]},{type:a,value:c},{type:b,tag:e,props:{className:[f,g]},children:[{type:a,value:E}]},{type:b,tag:e,props:{className:[f,F]},children:[{type:a,value:G}]},{type:a,value:c},{type:b,tag:e,props:{className:[f,g]},children:[{type:a,value:h}]},{type:a,value:" id "},{type:b,tag:e,props:{className:[f,g]},children:[{type:a,value:h}]},{type:a,value:" select_type "},{type:b,tag:e,props:{className:[f,g]},children:[{type:a,value:h}]},{type:a,value:j},{type:b,tag:e,props:{className:[f,n]},children:[{type:a,value:V}]},{type:a,value:"        "},{type:b,tag:e,props:{className:[f,g]},children:[{type:a,value:h}]},{type:a,value:j},{type:b,tag:e,props:{className:[f,n]},children:[{type:a,value:W}]},{type:a,value:X},{type:b,tag:e,props:{className:[f,g]},children:[{type:a,value:h}]},{type:a,value:" possible_keys "},{type:b,tag:e,props:{className:[f,g]},children:[{type:a,value:h}]},{type:a,value:j},{type:b,tag:e,props:{className:[f,n]},children:[{type:a,value:Y}]},{type:a,value:"     "},{type:b,tag:e,props:{className:[f,g]},children:[{type:a,value:h}]},{type:a,value:" key_len "},{type:b,tag:e,props:{className:[f,g]},children:[{type:a,value:h}]},{type:a,value:" ref  "},{type:b,tag:e,props:{className:[f,g]},children:[{type:a,value:h}]},{type:a,value:j},{type:b,tag:e,props:{className:[f,n]},children:[{type:a,value:Z}]},{type:a,value:"   "},{type:b,tag:e,props:{className:[f,g]},children:[{type:a,value:h}]},{type:a,value:" Extra                 "},{type:b,tag:e,props:{className:[f,g]},children:[{type:a,value:h}]},{type:a,value:c},{type:b,tag:e,props:{className:[f,g]},children:[{type:a,value:E}]},{type:b,tag:e,props:{className:[f,F]},children:[{type:a,value:G}]},{type:a,value:c},{type:b,tag:e,props:{className:[f,g]},children:[{type:a,value:h}]},{type:a,value:X},{type:b,tag:e,props:{className:[f,B]},children:[{type:a,value:_}]},{type:a,value:j},{type:b,tag:e,props:{className:[f,g]},children:[{type:a,value:h}]},{type:a,value:j},{type:b,tag:e,props:{className:[f,n]},children:[{type:a,value:"SIMPLE"}]},{type:a,value:"      "},{type:b,tag:e,props:{className:[f,g]},children:[{type:a,value:h}]},{type:a,value:U},{type:b,tag:e,props:{className:[f,g]},children:[{type:a,value:h}]},{type:a,value:" range "},{type:b,tag:e,props:{className:[f,g]},children:[{type:a,value:h}]},{type:a,value:" updtidx       "},{type:b,tag:e,props:{className:[f,g]},children:[{type:a,value:h}]},{type:a,value:" updtidx "},{type:b,tag:e,props:{className:[f,g]},children:[{type:a,value:h}]},{type:a,value:j},{type:b,tag:e,props:{className:[f,B]},children:[{type:a,value:"5"}]},{type:a,value:"       "},{type:b,tag:e,props:{className:[f,g]},children:[{type:a,value:h}]},{type:a,value:j},{type:b,tag:e,props:{className:[f,"boolean"]},children:[{type:a,value:"NULL"}]},{type:a,value:j},{type:b,tag:e,props:{className:[f,g]},children:[{type:a,value:h}]},{type:a,value:j},{type:b,tag:e,props:{className:[f,B]},children:[{type:a,value:"436018"}]},{type:a,value:j},{type:b,tag:e,props:{className:[f,g]},children:[{type:a,value:h}]},{type:a,value:j},{type:b,tag:e,props:{className:[f,n]},children:[{type:a,value:"Using"}]},{type:a,value:j},{type:b,tag:e,props:{className:[f,n]},children:[{type:a,value:$}]},{type:a,value:" condition "},{type:b,tag:e,props:{className:[f,g]},children:[{type:a,value:h}]},{type:a,value:c},{type:b,tag:e,props:{className:[f,g]},children:[{type:a,value:E}]},{type:b,tag:e,props:{className:[f,F]},children:[{type:a,value:G}]},{type:a,value:c},{type:b,tag:e,props:{className:[f,B]},children:[{type:a,value:_}]},{type:a,value:j},{type:b,tag:e,props:{className:[f,n]},children:[{type:a,value:"row"}]},{type:a,value:j},{type:b,tag:e,props:{className:[f,g]},children:[{type:a,value:"in"}]},{type:a,value:j},{type:b,tag:e,props:{className:[f,n]},children:[{type:a,value:"set"}]},{type:a,value:j},{type:b,tag:e,props:{className:[f,C]},children:[{type:a,value:"("}]},{type:b,tag:e,props:{className:[f,B]},children:[{type:a,value:"0.00"}]},{type:a,value:" sec"},{type:b,tag:e,props:{className:[f,C]},children:[{type:a,value:")"}]},{type:a,value:c}]}]}]},{type:a,value:c},{type:b,tag:k,props:{},children:[{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"id：查询序号，数字越大越先执行"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"select_type：查询类型\n"},{type:b,tag:k,props:{},children:[{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"SIMPLE：简单SELECT(不使用UNION或子查询)"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"PRIMARY：最外层的SELECT"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"UNION：UNION中第二个或之后的SELECT语句"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"DEPENDENT UNION：UNION中第二个或之后的SELECT语句，取决于外面的查询"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"UNION RESULT：UNION的结果"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"SUBQUERY：子查询中的第一个SELECT"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"DEPENDENT SUBQUERY：子查询中的第一个SELECT, 取决于外面的查询"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"DERIVED：衍生表(FROM子句中的子查询)"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"MATERIALIZED：物化子查询"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"UNCACHEABLE SUBQUERY：结果集无法缓存的子查询，必须重新评估外部查询的每一行"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"UNCACHEABLE UNION：UNION中第二个或之后的SELECT，属于无法缓存的子查询"}]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"table：表名"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"partitions：匹配的分区"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:b,tag:o,props:{},children:[{type:a,value:W}]},{type:a,value:"：查询方式，从好到坏\n"},{type:b,tag:k,props:{},children:[{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"system：只有一行数据或者是空表，且只能用于MyISAM和memory表，Innodb在这个情况通常都是all或者index"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:b,tag:o,props:{},children:[{type:a,value:"const"}]},{type:a,value:"：最多只有一行记录匹配，唯一索引等于常量值时"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:b,tag:o,props:{},children:[{type:a,value:"eq_ref"}]},{type:a,value:"：最多只有一行记录匹配，唯一索引等于非常量值时"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:b,tag:o,props:{},children:[{type:a,value:"ref"}]},{type:a,value:"：用到索引但不是唯一索引"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"fulltext：全文索引"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"ref_or_null：在ref基础上加了NULL的比较"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"index_merge：查询使用了两个或以上索引，常见and or使用了不同索引，最后取交并集"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"unique_subquery："},{type:b,tag:v,props:{},children:[{type:a,value:"where in (子查询)"}]},{type:a,value:"，子查询返回不重复值唯一值"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"index_subquery：类似于unique_subquery。适用于非唯一索引，可以返回重复值"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:b,tag:o,props:{},children:[{type:a,value:"range"}]},{type:a,value:"：索引范围查询"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:b,tag:o,props:{},children:[{type:a,value:$}]},{type:a,value:"：通过索引扫描全表。如果是索引覆盖，Extra会有Using index。否则回表的话没有Using index"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:b,tag:o,props:{},children:[{type:a,value:"all"}]},{type:a,value:"：全表扫描"}]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:b,tag:o,props:{},children:[{type:a,value:"prossible_keys"}]},{type:a,value:"：可能会选择的索引"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:b,tag:o,props:{},children:[{type:a,value:Y}]},{type:a,value:"：实际选择的索引"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"key_len：索引的长度。单索引则是索引长度，联合索引则是用到多少个字段算多长"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"ref：与索引作比较的列"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:b,tag:o,props:{},children:[{type:a,value:Z}]},{type:a,value:"：要检索的行数(估算值)"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"filtered：查询条件过滤的行数的百分比"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:b,tag:o,props:{},children:[{type:a,value:"Extra"}]},{type:a,value:"：额外信息\n"},{type:b,tag:k,props:{},children:[{type:a,value:c},{type:b,tag:d,props:{},children:[{type:b,tag:o,props:{},children:[{type:a,value:"distinct"}]},{type:a,value:"：select使用了distinct关键字"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:b,tag:o,props:{},children:[{type:a,value:"Using filesort"}]},{type:a,value:"：表示不能通过索引进行排序，需另外排序"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:b,tag:o,props:{},children:[{type:a,value:"Using index"}]},{type:a,value:"：索引覆盖"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Using temporary：使用了零时表，一般出现于排序, 分组和多表join"}]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:p,props:{id:aa},children:[{type:b,tag:l,props:{href:"#%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB",ariaHidden:q,tabIndex:r},children:[{type:b,tag:e,props:{className:[s,t]},children:[]}]},{type:a,value:aa}]},{type:a,value:c},{type:b,tag:k,props:{},children:[{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"主库将修改写入binlog文件"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"从库连接到主库，会起一个IO线程把binlog复制到自己的中继日志中"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"然后再起一个SQL线程从中继日志中读取执行binlog的的命令"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"一般延迟几十或几百毫秒，如果此时主库挂了，数据就丢失了\n"},{type:b,tag:k,props:{},children:[{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"半同步复制：主库写入binlog之后强制数据立即同步到从库，至少有一个从库确认同步了才算写入成功"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"并行复制：起多个SQL线程来执行中继日志"}]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:p,props:{id:ab},children:[{type:b,tag:l,props:{href:"#%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8",ariaHidden:q,tabIndex:r},children:[{type:b,tag:e,props:{className:[s,t]},children:[]}]},{type:a,value:ab}]},{type:a,value:c},{type:b,tag:i,props:{},children:[{type:a,value:"一个表控制在两百万以内，一个库最好一千QPS，最多两千QPS。"}]},{type:a,value:c},{type:b,tag:k,props:{},children:[{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"水平拆分：同样的表结构拆分到多个库里"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"垂直拆分：把字段拆分到多个表里，将高频字段与低频字段拆到不同表里"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:i,props:{},children:[{type:a,value:"分库分表路由："}]},{type:a,value:c},{type:b,tag:k,props:{},children:[{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"每个库都是连续的数据。但对于时间分段就可能都访问最新的热数据，负载不均匀"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"用某个字段来hash，不过扩容要做数据迁移"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:i,props:{},children:[{type:a,value:"分库分表过度："}]},{type:a,value:c},{type:b,tag:k,props:{},children:[{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"双写-\u003E导数据(检查版本号)"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:i,props:{},children:[{type:a,value:"分库分表主键："}]},{type:a,value:c},{type:b,tag:k,props:{},children:[{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"主键id自增步长"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"redis自增"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:p,props:{id:ac},children:[{type:b,tag:l,props:{href:"#%E4%BC%98%E5%8C%96",ariaHidden:q,tabIndex:r},children:[{type:b,tag:e,props:{className:[s,t]},children:[]}]},{type:a,value:ac}]},{type:a,value:c},{type:b,tag:k,props:{},children:[{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"表设计优化\n"},{type:b,tag:k,props:{},children:[{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"使用整型表示枚举字符串"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"尽量不使用null，索引里null被认为是最小值，会被放在最左边，如果有大量null会降低索引性能"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"尽量别"},{type:b,tag:v,props:{},children:[{type:a,value:"select *"}]},{type:a,value:"，尽量"},{type:b,tag:v,props:{},children:[{type:a,value:"count(*)"}]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"货币数据使用decimal"}]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"索引优化：如上"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"读写分离：如上"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"分库分表：如上"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:p,props:{id:"innodb与myisam"},children:[{type:b,tag:l,props:{href:"#innodb%E4%B8%8Emyisam",ariaHidden:q,tabIndex:r},children:[{type:b,tag:e,props:{className:[s,t]},children:[]}]},{type:a,value:"InnoDB与MyISAM"}]},{type:a,value:c},{type:b,tag:i,props:{},children:[{type:a,value:"InnoDB是聚集索引，即索引跟数据在一起。必须有主键(没有会自建一个隐藏的)，非主键-\u003E二级索引-\u003E主键-\u003E一级索引-\u003E数据。\n而MyISAM的索引则是保存数据文件的指针。"}]},{type:a,value:"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{type:b,tag:V,props:{},children:[{type:b,tag:"thead",props:{},children:[{type:b,tag:A,props:{},children:[{type:b,tag:H,props:{},children:[]},{type:b,tag:H,props:{},children:[{type:a,value:"InnoDB"}]},{type:b,tag:H,props:{},children:[{type:a,value:"MyISAM"}]}]}]},{type:b,tag:"tbody",props:{},children:[{type:b,tag:A,props:{},children:[{type:b,tag:m,props:{},children:[{type:a,value:"存储结构"}]},{type:b,tag:m,props:{},children:[{type:a,value:"索引和数据都保存在一个文件里"}]},{type:b,tag:m,props:{},children:[{type:a,value:"分为表结构、索引和数据三个文件"}]}]},{type:b,tag:A,props:{},children:[{type:b,tag:m,props:{},children:[{type:a,value:"事务"}]},{type:b,tag:m,props:{},children:[{type:a,value:ad}]},{type:b,tag:m,props:{},children:[{type:a,value:ae}]}]},{type:b,tag:A,props:{},children:[{type:b,tag:m,props:{},children:[{type:a,value:"全文索引"}]},{type:b,tag:m,props:{},children:[{type:a,value:ae}]},{type:b,tag:m,props:{},children:[{type:a,value:ad}]}]},{type:b,tag:A,props:{},children:[{type:b,tag:m,props:{},children:[{type:a,value:"锁"}]},{type:b,tag:m,props:{},children:[{type:a,value:"表锁和行锁"}]},{type:b,tag:m,props:{},children:[{type:a,value:"表锁"}]}]},{type:b,tag:A,props:{},children:[{type:b,tag:m,props:{},children:[{type:a,value:"CURD"}]},{type:b,tag:m,props:{},children:[{type:a,value:"偏向于写"}]},{type:b,tag:m,props:{},children:[{type:a,value:"偏向于读"}]}]},{type:b,tag:A,props:{},children:[{type:b,tag:m,props:{},children:[{type:a,value:af}]},{type:b,tag:m,props:{},children:[{type:a,value:"相对容易"}]},{type:b,tag:m,props:{},children:[{type:a,value:"相对困难"}]}]}]}]},{type:a,value:c},{type:b,tag:p,props:{id:"binlog"},children:[{type:b,tag:l,props:{href:"#binlog",ariaHidden:q,tabIndex:r},children:[{type:b,tag:e,props:{className:[s,t]},children:[]}]},{type:a,value:"Binlog"}]},{type:a,value:c},{type:b,tag:i,props:{},children:[{type:a,value:"Binlog会记录每一个更新操作，作为一个事件。在记录模式上分为三类："}]},{type:a,value:c},{type:b,tag:k,props:{},children:[{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"statement：记录所执行的SQL"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"row：记录每一行数据的变化字段的前后值"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"mixed：statement和row的混合模式"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:i,props:{},children:[{type:a,value:"使用场景："}]},{type:a,value:c},{type:b,tag:k,props:{},children:[{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"读写分离：主从同步"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:af}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"数据同步：binlog-\u003EMQ-其他服务(redis、ES)。使用binlog同步组件拉取。"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"异地多活：主键冲突、数据回环问题"}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:i,props:{},children:[{type:a,value:"参考文章："}]},{type:a,value:c},{type:b,tag:i,props:{},children:[{type:b,tag:l,props:{href:"https:\u002F\u002Ftech.meituan.com\u002F2014\u002F06\u002F30\u002Fmysql-index.html",rel:[w,x,y],target:z},children:[{type:a,value:"MySQL索引原理及慢查询优化"}]}]},{type:a,value:c},{type:b,tag:i,props:{},children:[{type:b,tag:l,props:{href:"https:\u002F\u002Fblog.csdn.net\u002Ftb3039450\u002Farticle\u002Fdetails\u002F66475638",rel:[w,x,y],target:z},children:[{type:a,value:"MySQL InnoDB中的行锁 Next-Key Lock消除幻读"}]}]},{type:a,value:c},{type:b,tag:i,props:{},children:[{type:b,tag:l,props:{href:"https:\u002F\u002Fwww.jianshu.com\u002Fp\u002F8fab76bbf448",rel:[w,x,y],target:z},children:[{type:a,value:"explain结果每个字段的含义说明"}]}]},{type:a,value:c},{type:b,tag:i,props:{},children:[{type:b,tag:l,props:{href:"http:\u002F\u002Fjimolonely.github.io\u002F2019\u002F09\u002F24\u002Fdb\u002F011-mysql-decimal\u002F",rel:[w,x,y],target:z},children:[{type:a,value:"mysql decimal用法与问题"}]}]},{type:a,value:c},{type:b,tag:i,props:{},children:[{type:b,tag:l,props:{href:"https:\u002F\u002Fjuejin.im\u002Fpost\u002F5d5defc2518825591523a1db",rel:[w,x,y],target:z},children:[{type:a,value:"MySQL中IS NULL、IS NOT NULL、!=不能用索引？胡扯！"}]}]},{type:a,value:c},{type:b,tag:i,props:{},children:[{type:b,tag:l,props:{href:"https:\u002F\u002Fwww.jianshu.com\u002Fp\u002Fa957b18ba40d",rel:[w,x,y],target:z},children:[{type:a,value:"MySQL存储引擎－－MyISAM与InnoDB区别"}]}]},{type:a,value:c},{type:b,tag:i,props:{},children:[{type:b,tag:l,props:{href:"https:\u002F\u002Fxushanxiang.com\u002F2019\u002F11\u002Fthe-difference-between-mysql-storage-engine-myisam-and-innodb.html",rel:[w,x,y],target:z},children:[{type:a,value:"MySQL存储引擎MyISAM和InnoDB有哪些区别？"}]}]},{type:a,value:c},{type:b,tag:i,props:{},children:[{type:b,tag:l,props:{href:"http:\u002F\u002Fwww.jiangxinlingdu.com\u002Fmysql\u002F2019\u002F06\u002F07\u002Fbinlog.html",rel:[w,x,y],target:z},children:[{type:a,value:"mysql binlog应用场景与原理深度剖析"}]}]}]},excerpt:{type:O,children:[]},dir:ag,path:"\u002F中间件\u002F20200609\u002FMySQL总结",extension:".md",title:L,url:"\u002Fblog-code\u002Fview\u002F$E4$B8$AD$E9$97$B4$E4$BB$B6\u002F20200609\u002FMySQL$E6$80$BB$E7$BB$93\u002F",createAt:new Date(1591660800000),updateAt:new Date(1591660800000),attributes:[{name:"createAt",value:ah},{name:"updateAt",value:ah},{name:"sort",value:ag,url:"\u002Fblog-code\u002Fpage\u002F$E4$B8$AD$E9$97$B4$E4$BB$B6\u002F20200609\u002F1\u002F"}]}}],fetch:{},mutations:void 0}}("text","element","\n","li","span","token","operator","|","p"," ","ul","a","td","keyword","strong","h1","true",-1,"icon","icon-link","wide","code","nofollow","noopener","noreferrer","_blank","tr","number","punctuation","10\u003Cage\u003C20","+","comment","----+-------------+--------------+-------+---------------+---------+---------+------+--------+-----------------------+","th","无名の窝",10000,"青春猪头-牧之原翔子-江之岛","MySQL总结","","2020-06-09T00:00:00.000Z","root","mysql架构","并发控制","最左匹配原则","explain字段含义","\u003E"," tb_devicemap ","table","type","  ","key","rows","1","index","读写分离","分库分表","优化","支持","不支持","数据恢复","\u002F中间件\u002F20200609","2020-06-09")));